(function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var l=typeof require=="function"&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var f=r[a]={exports:{}};t[a][0].call(f.exports,function(e){var r=t[a][1][e];return i(r?r:e)},f,f.exports,e,t,r,n)}return r[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<n.length;a++)i(n[a]);return i})({1:[function(e,t,r){var n=e("gl-now")();var i=e("gl-shader");var o=e("gl-texture2d");var a=e("a-big-triangle");var s=e("webcam-grabber");var l=e("exdat");var u="#define GLSLIFY 1\nprecision mediump float;\n\nattribute vec2 position;\n// varying vec2 texCoord;\nvoid main() {\n  gl_Position = vec4(position, 1, 1);\n  // texCoord = vec2(0.0,1.0)+vec2(0.5,-0.5) * (position + 1.0);\n}";var f="#define GLSLIFY 1\nprecision highp float;\nuniform sampler2D texture;\nuniform sampler2D lookup;\nuniform float uMix;\nuniform bool uBlur;\nuniform vec2 uResolution;\n// varying vec2 texCoord;\n\nvec4 lookup_0(in vec4 textureColor, in sampler2D lookupTable) {\n    #ifndef LUT_NO_CLAMP\n        textureColor = clamp(textureColor, 0.0, 1.0);\n    #endif\n\n    mediump float blueColor = textureColor.b * 63.0;\n\n    mediump vec2 quad1;\n    quad1.y = floor(floor(blueColor) / 8.0);\n    quad1.x = floor(blueColor) - (quad1.y * 8.0);\n\n    mediump vec2 quad2;\n    quad2.y = floor(ceil(blueColor) / 8.0);\n    quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n\n    highp vec2 texPos1;\n    texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.r);\n    texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.g);\n\n    #ifdef LUT_FLIP_Y\n        texPos1.y = 1.0-texPos1.y;\n    #endif\n\n    highp vec2 texPos2;\n    texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.r);\n    texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.g);\n\n    #ifdef LUT_FLIP_Y\n        texPos2.y = 1.0-texPos2.y;\n    #endif\n\n    lowp vec4 newColor1 = texture2D(lookupTable, texPos1);\n    lowp vec4 newColor2 = texture2D(lookupTable, texPos2);\n\n    lowp vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n    return newColor;\n}\n\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n	vec2 uv = vec2(gl_FragCoord.xy / uResolution.xy);\n\n	// flip\n	uv.y = 1.0 - uv.y;\n\n	vec4 color = texture2D(texture, uv);\n	vec4 filterSrc = color;\n	// vec4 color = blur(texture, uv, uResolution.xy, vec2(1.0, 0.0));\n\n	if(uBlur) {\n		// vec4 b1a = blur3(texture, uv, uResolution.xy, vec2(1.0, 0.0)) / 6.0;\n		// vec4 b2a = blur2(texture, uv, uResolution.xy, vec2(1.0, 0.0)) / 6.0;\n		// vec4 b3a = blur1(texture, uv, uResolution.xy, vec2(1.0, 0.0)) / 6.0;\n\n		// vec4 b1b = blur3(texture, uv, uResolution.xy, vec2(0.0, 1.0)) / 6.0;\n		// vec4 b2b = blur2(texture, uv, uResolution.xy, vec2(0.0, 1.0)) / 6.0;\n		// vec4 b3b = blur1(texture, uv, uResolution.xy, vec2(0.0, 1.0)) / 6.0;\n\n		filterSrc = blur9(texture, uv, uResolution.xy, vec2(1.0, 0.0));\n	}\n\n	vec4 filter = lookup_0(filterSrc, lookup);\n  gl_FragColor = mix(color, filter, uMix);\n  // gl_FragColor = color;\n}";var c=s(600,400);var d,h;var p={lut:"luts/lookup.png",mix:1,blur:true};var g,_;function m(e,t){var r={image:new Image,texture:null};r.image.onload=function(){r.texture=o(e,r.image);r.texture.minFilter=r.texture.magFilter=e.LINEAR};r.image.src=t;return r}function v(e){h=m(n.gl,"luts/"+e);_.src=h.image.src}n.on("gl-init",function(){var e=n.gl;shader=i(e,u,f);g=new l.GUI;g.add(p,"mix",0,1);g.add(p,"blur",true);g.add(p,"lut",{Default:"lookup.png","2x2 Grey":"lookup-2x2grey.png",Stripes:"lookup-stripes.png","Stripes (90deg)":"lookup-stripes90deg.png","Stripe Mask":"lookup-stripe-mask.png","Stripe Mask + Mezzotint":"lookup-stripe-mask-mezzotint.png",Streaks:"lookup-streaks.png",Bubbles:"lookup-bubbles.png",Grass:"lookup-grass.png",Invert:"lookup-invert.png","90deg Rotation":"lookup-90deg.png","180deg Rotation":"lookup-180deg.png","Rectangular to Polar":"lookup-rect-to-polar.png",Pointellize:"lookup-pointellize.png",Mezzotint:"lookup-mezzotint.png","Mezzotint + Blur":"lookup-mezzotintblur.png",Crystallize:"lookup-crystallize.png","Halftone Pattern":"lookup-halftone.png","Halftone (B&W, dots)":"lookup-halftone-bw-dot.png","Halftone (B&W, circle)":"lookup-halftone-bw-circle.png","Halftone (B&W, lines)":"lookup-halftone-bw-lines.png","Mezzotint / Halftone":"lookup-mezzotint-halftone.png","Find Edges":"lookup-findedges.png","Difference Clouds":"lookup-diff-clouds.png","Noise (Gaussian)":"lookup-noise.png",Solarize:"lookup-solarize.png","Wind (Stagger)":"lookup-wind-stagger.png",Waterpaper:"lookup-waterpaper.png",Reticulation:"lookup-reticulation.png","Sumi-e":"lookup-sumi-e.png",Sponge:"lookup-sponge.png","Neon Glow":"lookup-neonglow.png",Chrome:"lookup-chrome.png","Torn Edges":"lookup-tornedges.png","Note Paper":"lookup-notepaper.png",Fibers:"lookup-fibers.png",Mondrian:"lookup-mondrian.png",Albers:"lookup-albers.png","Van Gogh":"lookup-vangogh.png",Molnar:"lookup-molnar.png",Riley:"lookup-riley.png",Parmagianino:"lookup-parmagianino.png",Emoji:"lookup-emoji.png"}).onChange(v);_=new Image;_.id="lut-img";document.body.appendChild(_);var t="lookup.png";if(window.location.hash){t=window.location.hash.replace("#","")+".png"}console.log("initLookup",t);v(t)});n.on("tick",function(){var e=n.gl;if(c.readyState===c.HAVE_ENOUGH_DATA){if(d){d.setPixels(c)}else{d=o(e,c)}}});n.on("gl-render",function(e){var t=n.gl;shader.bind();if(d&&h.texture){shader.uniforms.texture=d.bind(0);shader.uniforms.lookup=h.texture.bind(1)}shader.uniforms.uMix=p.mix;shader.uniforms.uBlur=p.blur;shader.uniforms.uResolution=[n.width,n.height];a(t)});n.on("gl-error",function(e){throw new Error("WebGL not supported :(")})},{"a-big-triangle":19,exdat:50,"gl-now":51,"gl-shader":64,"gl-texture2d":98,"webcam-grabber":99}],2:[function(e,t,r){"use strict";var n=e("typedarray-pool");var i=e("ndarray-ops");var o=e("ndarray");var a=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function s(e,t,r,n,i){this.gl=e;this.type=t;this.handle=r;this.length=n;this.usage=i}var l=s.prototype;l.bind=function(){this.gl.bindBuffer(this.type,this.handle)};l.unbind=function(){this.gl.bindBuffer(this.type,null)};l.dispose=function(){this.gl.deleteBuffer(this.handle)};function u(e,t,r,n,i,o){var a=i.length*i.BYTES_PER_ELEMENT;if(o<0){e.bufferData(t,i,n);return a}if(a+o>r){throw new Error("gl-buffer: If resizing buffer, must not specify offset")}e.bufferSubData(t,o,i);return r}function f(e,t){var r=n.malloc(e.length,t);var i=e.length;for(var o=0;o<i;++o){r[o]=e[o]}return r}function c(e,t){var r=1;for(var n=t.length-1;n>=0;--n){if(t[n]!==r){return false}r*=e[n]}return true}l.update=function(e,t){if(typeof t!=="number"){t=-1}this.bind();if(typeof e==="object"&&typeof e.shape!=="undefined"){var r=e.dtype;if(a.indexOf(r)<0){r="float32"}if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){var s=gl.getExtension("OES_element_index_uint");if(s&&r!=="uint16"){r="uint32"}else{r="uint16"}}if(r===e.dtype&&c(e.shape,e.stride)){if(e.offset===0&&e.data.length===e.shape[0]){this.length=u(this.gl,this.type,this.length,this.usage,e.data,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,e.data.subarray(e.offset,e.shape[0]),t)}}else{var l=n.malloc(e.size,r);var d=o(l,e.shape);i.assign(d,e);if(t<0){this.length=u(this.gl,this.type,this.length,this.usage,l,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,l.subarray(0,e.size),t)}n.free(l)}}else if(Array.isArray(e)){var h;if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){h=f(e,"uint16")}else{h=f(e,"float32")}if(t<0){this.length=u(this.gl,this.type,this.length,this.usage,h,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,h.subarray(0,e.length),t)}n.free(h)}else if(typeof e==="object"&&typeof e.length==="number"){this.length=u(this.gl,this.type,this.length,this.usage,e,t)}else if(typeof e==="number"||e===undefined){if(t>=0){throw new Error("gl-buffer: Cannot specify offset when resizing buffer")}e=e|0;if(e<=0){e=1}this.gl.bufferData(this.type,e|0,this.usage);this.length=e}else{throw new Error("gl-buffer: Invalid data type")}};function d(e,t,r,n){r=r||e.ARRAY_BUFFER;n=n||e.DYNAMIC_DRAW;if(r!==e.ARRAY_BUFFER&&r!==e.ELEMENT_ARRAY_BUFFER){throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER")}if(n!==e.DYNAMIC_DRAW&&n!==e.STATIC_DRAW&&n!==e.STREAM_DRAW){throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW")}var i=e.createBuffer();var o=new s(e,r,i,0,n);o.update(t);return o}t.exports=d},{ndarray:8,"ndarray-ops":3,"typedarray-pool":13}],3:[function(e,t,r){"use strict";var n=e("cwise-compiler");var i={body:"",args:[],thisVars:[],localVars:[]};function o(e){if(!e){return i}for(var t=0;t<e.args.length;++t){var r=e.args[t];if(t===0){e.args[t]={name:r,lvalue:true,rvalue:!!e.rvalue,count:e.count||1}}else{e.args[t]={name:r,lvalue:false,rvalue:true,count:1}}}if(!e.thisVars){e.thisVars=[]}if(!e.localVars){e.localVars=[]}return e}function a(e){return n({args:e.args,pre:o(e.pre),body:o(e.body),post:o(e.proc),funcName:e.funcName})}function s(e){var t=[];for(var r=0;r<e.args.length;++r){t.push("a"+r)}var n=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return n(a(e))}var l={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var e in l){var t=l[e];r[e]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e});r[e+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:true,funcName:e+"eq"});r[e+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"});r[e+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:true,funcName:e+"seq"})}})();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var e in u){var t=u[e];r[e]=s({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e});r[e+"eq"]=s({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:true,count:2,funcName:e+"eq"})}})();var f={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var e in f){var t=f[e];r[e]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e});r[e+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"});r[e+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:true,count:2,funcName:e+"eq"});r[e+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:true,count:2,funcName:e+"seq"})}})();var c=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var e=0;e<c.length;++e){var t=c[e];r[t]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t});r[t+"eq"]=s({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"eq"})}})();var d=["max","min","atan2","pow"];(function(){for(var e=0;e<d.length;++e){var t=d[e];r[t]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t});r[t+"s"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"});r[t+"eq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"eq"});r[t+"seq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"seq"})}})();var h=["atan2","pow"];(function(){for(var e=0;e<h.length;++e){var t=h[e];r[t+"op"]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"});r[t+"ops"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"});r[t+"opeq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"opeq"});r[t+"opseq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"opseq"})}})();r.any=n({args:["array"],pre:i,body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"});r.all=n({args:["array"],pre:i,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});r.sum=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"});r.prod=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});r.norm2squared=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});r.norm2=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});r.norminf=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});r.norm1=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"});r.sup=n({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});r.inf=n({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});r.argmin=n({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});r.argmax=n({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});r.random=s({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});r.assign=s({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});r.assigns=s({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});r.equals=n({args:["array","array"],pre:i,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1},{name:"y",lvalue:false,rvalue:true,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":4}],4:[function(e,t,r){"use strict";var n=e("./lib/thunk.js");function i(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.pre=null;this.body=null;this.post=null;this.debug=false}function o(e){var t=new i;t.pre=e.pre;t.body=e.body;t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var o=0;o<r.length;++o){var a=r[o];if(a==="array"||typeof a==="object"&&a.blockIndices){t.argTypes[o]="array";t.arrayArgs.push(o);t.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0);t.shimArgs.push("array"+o);if(o<t.pre.args.length&&t.pre.args[o].count>0){throw new Error("cwise: pre() block may not reference array args")}if(o<t.post.args.length&&t.post.args[o].count>0){throw new Error("cwise: post() block may not reference array args")}}else if(a==="scalar"){t.scalarArgs.push(o);t.shimArgs.push("scalar"+o)}else if(a==="index"){t.indexArgs.push(o);if(o<t.pre.args.length&&t.pre.args[o].count>0){throw new Error("cwise: pre() block may not reference array index")}if(o<t.body.args.length&&t.body.args[o].lvalue){throw new Error("cwise: body() block may not write to array index")}if(o<t.post.args.length&&t.post.args[o].count>0){throw new Error("cwise: post() block may not reference array index")}}else if(a==="shape"){t.shapeArgs.push(o);if(o<t.pre.args.length&&t.pre.args[o].lvalue){throw new Error("cwise: pre() block may not write to array shape")}if(o<t.body.args.length&&t.body.args[o].lvalue){throw new Error("cwise: body() block may not write to array shape")}if(o<t.post.args.length&&t.post.args[o].lvalue){throw new Error("cwise: post() block may not write to array shape")}}else if(typeof a==="object"&&a.offset){t.argTypes[o]="offset";t.offsetArgs.push({array:a.array,offset:a.offset});t.offsetArgIndex.push(o)}else{throw new Error("cwise: Unknown argument type "+r[o])}}if(t.arrayArgs.length<=0){throw new Error("cwise: No array arguments specified")}if(t.pre.args.length>r.length){throw new Error("cwise: Too many arguments in pre() block")}if(t.body.args.length>r.length){throw new Error("cwise: Too many arguments in body() block")}if(t.post.args.length>r.length){throw new Error("cwise: Too many arguments in post() block")}t.debug=!!e.printCode||!!e.debug;t.funcName=e.funcName||"cwise";t.blockSize=e.blockSize||64;return n(t)}t.exports=o},{"./lib/thunk.js":6}],5:[function(e,t,r){"use strict";var n=e("uniq");function i(e,t,r){var n=e.length,i=t.arrayArgs.length,o=t.indexArgs.length>0,a=[],s=[],l=0,u=0,f,c;for(f=0;f<n;++f){s.push(["i",f,"=0"].join(""))}for(c=0;c<i;++c){for(f=0;f<n;++f){u=l;l=e[f];if(f===0){s.push(["d",c,"s",f,"=t",c,"p",l].join(""))}else{s.push(["d",c,"s",f,"=(t",c,"p",l,"-s",u,"*t",c,"p",u,")"].join(""))}}}a.push("var "+s.join(","));for(f=n-1;f>=0;--f){l=e[f];a.push(["for(i",f,"=0;i",f,"<s",l,";++i",f,"){"].join(""))}a.push(r);for(f=0;f<n;++f){u=l;l=e[f];for(c=0;c<i;++c){a.push(["p",c,"+=d",c,"s",f].join(""))}if(o){if(f>0){a.push(["index[",u,"]-=s",u].join(""))}a.push(["++index[",l,"]"].join(""))}a.push("}")}return a.join("\n")}function o(e,t,r,n){var o=t.length,a=r.arrayArgs.length,s=r.blockSize,l=r.indexArgs.length>0,u=[];for(var f=0;f<a;++f){u.push(["var offset",f,"=p",f].join(""))}for(var f=e;f<o;++f){u.push(["for(var j"+f+"=SS[",t[f],"]|0;j",f,">0;){"].join(""));u.push(["if(j",f,"<",s,"){"].join(""));u.push(["s",t[f],"=j",f].join(""));u.push(["j",f,"=0"].join(""));u.push(["}else{s",t[f],"=",s].join(""));u.push(["j",f,"-=",s,"}"].join(""));if(l){u.push(["index[",t[f],"]=j",f].join(""))}}for(var f=0;f<a;++f){var c=["offset"+f];for(var d=e;d<o;++d){c.push(["j",d,"*t",f,"p",t[d]].join(""))}u.push(["p",f,"=(",c.join("+"),")"].join(""))}u.push(i(t,r,n));for(var f=e;f<o;++f){u.push("}")}return u.join("\n")}function a(e){var t=0,r=e[0].length;while(t<r){for(var n=1;n<e.length;++n){if(e[n][t]!==e[0][t]){return t}}++t}return t}function s(e,t,r){var n=e.body;var i=[];var o=[];for(var a=0;a<e.args.length;++a){var s=e.args[a];if(s.count<=0){continue}var l=new RegExp(s.name,"g");var u="";var f=t.arrayArgs.indexOf(a);switch(t.argTypes[a]){case"offset":var c=t.offsetArgIndex.indexOf(a);var d=t.offsetArgs[c];f=d.array;u="+q"+c;case"array":u="p"+f+u;var h="l"+a;var p="a"+f;if(t.arrayBlockIndices[f]===0){if(s.count===1){if(r[f]==="generic"){if(s.lvalue){i.push(["var ",h,"=",p,".get(",u,")"].join(""));n=n.replace(l,h);o.push([p,".set(",u,",",h,")"].join(""))}else{n=n.replace(l,[p,".get(",u,")"].join(""))}}else{n=n.replace(l,[p,"[",u,"]"].join(""))}}else if(r[f]==="generic"){i.push(["var ",h,"=",p,".get(",u,")"].join(""));n=n.replace(l,h);if(s.lvalue){o.push([p,".set(",u,",",h,")"].join(""))}}else{i.push(["var ",h,"=",p,"[",u,"]"].join(""));n=n.replace(l,h);if(s.lvalue){o.push([p,"[",u,"]=",h].join(""))}}}else{var g=[s.name],_=[u];for(var m=0;m<Math.abs(t.arrayBlockIndices[f]);m++){g.push("\\s*\\[([^\\]]+)\\]");_.push("$"+(m+1)+"*t"+f+"b"+m)}l=new RegExp(g.join(""),"g");u=_.join("+");if(r[f]==="generic"){throw new Error("cwise: Generic arrays not supported in combination with blocks!")}else{n=n.replace(l,[p,"[",u,"]"].join(""))}}break;case"scalar":n=n.replace(l,"Y"+t.scalarArgs.indexOf(a));break;case"index":n=n.replace(l,"index");break;case"shape":n=n.replace(l,"shape");break}}return[i.join("\n"),n,o.join("\n")].join("\n").trim()}function l(e){var t=new Array(e.length);var r=true;for(var n=0;n<e.length;++n){var i=e[n];var o=i.match(/\d+/);if(!o){o=""}else{o=o[0]}if(i.charAt(0)===0){t[n]="u"+i.charAt(1)+o}else{t[n]=i.charAt(0)+o}if(n>0){r=r&&t[n]===t[n-1]}}if(r){return t[0]}return t.join("")}function u(e,t){var r=t[1].length-Math.abs(e.arrayBlockIndices[0])|0;var u=new Array(e.arrayArgs.length);var f=new Array(e.arrayArgs.length);for(var c=0;c<e.arrayArgs.length;++c){f[c]=t[2*c];u[c]=t[2*c+1]}var d=[],h=[];var p=[],g=[];var _=[];for(var c=0;c<e.arrayArgs.length;++c){if(e.arrayBlockIndices[c]<0){p.push(0);g.push(r);d.push(r);h.push(r+e.arrayBlockIndices[c])}else{p.push(e.arrayBlockIndices[c]);g.push(e.arrayBlockIndices[c]+r);d.push(0);h.push(e.arrayBlockIndices[c])}var m=[];for(var v=0;v<u[c].length;v++){if(p[c]<=u[c][v]&&u[c][v]<g[c]){m.push(u[c][v]-p[c])}}_.push(m)}var b=["SS"];var y=["'use strict'"];var E=[];for(var v=0;v<r;++v){E.push(["s",v,"=SS[",v,"]"].join(""))}for(var c=0;c<e.arrayArgs.length;++c){b.push("a"+c);b.push("t"+c);b.push("p"+c);for(var v=0;v<r;++v){E.push(["t",c,"p",v,"=t",c,"[",p[c]+v,"]"].join(""))}for(var v=0;v<Math.abs(e.arrayBlockIndices[c]);++v){E.push(["t",c,"b",v,"=t",c,"[",d[c]+v,"]"].join(""))}}for(var c=0;c<e.scalarArgs.length;++c){b.push("Y"+c)}if(e.shapeArgs.length>0){E.push("shape=SS.slice(0)")}if(e.indexArgs.length>0){var w=new Array(r);for(var c=0;c<r;++c){w[c]="0"}E.push(["index=[",w.join(","),"]"].join(""))}for(var c=0;c<e.offsetArgs.length;++c){var T=e.offsetArgs[c];var A=[];for(var v=0;v<T.offset.length;++v){if(T.offset[v]===0){continue}else if(T.offset[v]===1){A.push(["t",T.array,"p",v].join(""))}else{A.push([T.offset[v],"*t",T.array,"p",v].join(""))}}if(A.length===0){E.push("q"+c+"=0")}else{E.push(["q",c,"=",A.join("+")].join(""))}}var x=n([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));E=E.concat(x);y.push("var "+E.join(","));for(var c=0;c<e.arrayArgs.length;++c){y.push("p"+c+"|=0")}if(e.pre.body.length>3){y.push(s(e.pre,e,f))}var R=s(e.body,e,f);var C=a(_);if(C<r){y.push(o(C,_[0],e,R))}else{y.push(i(_[0],e,R))}if(e.post.body.length>3){y.push(s(e.post,e,f))}if(e.debug){console.log("-----Generated cwise routine for ",t,":\n"+y.join("\n")+"\n----------")}var S=[e.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",C,l(f)].join("");var k=new Function(["function ",S,"(",b.join(","),"){",y.join("\n"),"} return ",S].join(""));return k()}t.exports=u},{uniq:7}],6:[function(e,t,r){"use strict";var n=e("./compile.js");function i(e){var t=["'use strict'","var CACHED={}"];var r=[];var i=e.funcName+"_cwise_thunk";t.push(["return function ",i,"(",e.shimArgs.join(","),"){"].join(""));var o=[];var a=[];var s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")];var l=[],u=[];for(var f=0;f<e.arrayArgs.length;++f){var c=e.arrayArgs[f];r.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join(""));o.push("t"+c);o.push("r"+c);a.push("t"+c);a.push("r"+c+".join()");s.push("array"+c+".data");s.push("array"+c+".stride");s.push("array"+c+".offset|0");if(f>0){l.push("array"+e.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[f])));u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[f])+"]")}}if(e.arrayArgs.length>1){t.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')");t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex-->0;) {");t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')");t.push("}")}for(var f=0;f<e.scalarArgs.length;++f){s.push("scalar"+e.scalarArgs[f])}r.push(["type=[",a.join(","),"].join()"].join(""));r.push("proc=CACHED[type]");t.push("var "+r.join(","));t.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join(""));if(e.debug){console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------")}var d=new Function("compile",t.join("\n"));return d(n.bind(undefined,e))}t.exports=i},{"./compile.js":5}],7:[function(e,t,r){"use strict";function n(e,t){var r=1,n=e.length,i=e[0],o=e[0];for(var a=1;a<n;++a){o=i;i=e[a];if(t(i,o)){if(a===r){r++;continue}e[r++]=i}}e.length=r;return e}function i(e){var t=1,r=e.length,n=e[0],i=e[0];for(var o=1;o<r;++o,i=n){i=n;n=e[o];if(n!==i){if(o===t){t++;continue}e[t++]=n}}e.length=t;return e}function o(e,t,r){if(e.length===0){return e}if(t){if(!r){e.sort(t)}return n(e,t)}if(!r){e.sort()}return i(e)}t.exports=o},{}],8:[function(e,t,r){var n=e("iota-array");var i=e("is-buffer");var o=typeof Float64Array!=="undefined";function a(e,t){return e[0]-t[0]}function s(){var e=this.stride;var t=new Array(e.length);var r;for(r=0;r<t.length;++r){t[r]=[Math.abs(e[r]),r]}t.sort(a);var n=new Array(t.length);for(r=0;r<n.length;++r){n[r]=t[r][1]}return n}function l(e,t){var r=["View",t,"d",e].join("");if(t<0){r="View_Nil"+e}var i=e==="generic";if(t===-1){var o="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}";var a=new Function(o);return a()}else if(t===0){var o="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}";var a=new Function("TrivialArray",o);return a(f[e][0])}var o=["'use strict'"];var l=n(t);var u=l.map(function(e){return"i"+e});var c="this.offset+"+l.map(function(e){return"this.stride["+e+"]*i"+e}).join("+");var d=l.map(function(e){return"b"+e}).join(",");var h=l.map(function(e){return"c"+e}).join(",");o.push("function "+r+"(a,"+d+","+h+",d){this.data=a","this.shape=["+d+"]","this.stride=["+h+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+e+"'","proto.dimension="+t);o.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+l.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})");if(t===1){o.push("proto.order=[0]")}else{o.push("Object.defineProperty(proto,'order',{get:");if(t<4){o.push("function "+r+"_order(){");if(t===2){o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})")}else if(t===3){o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")}}else{o.push("ORDER})")}}o.push("proto.set=function "+r+"_set("+u.join(",")+",v){");if(i){o.push("return this.data.set("+c+",v)}")}else{o.push("return this.data["+c+"]=v}")}o.push("proto.get=function "+r+"_get("+u.join(",")+"){");if(i){o.push("return this.data.get("+c+")}")}else{o.push("return this.data["+c+"]}")}o.push("proto.index=function "+r+"_index(",u.join(),"){return "+c+"}");o.push("proto.hi=function "+r+"_hi("+u.join(",")+"){return new "+r+"(this.data,"+l.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+l.map(function(e){
return"this.stride["+e+"]"}).join(",")+",this.offset)}");var p=l.map(function(e){return"a"+e+"=this.shape["+e+"]"});var g=l.map(function(e){return"c"+e+"=this.stride["+e+"]"});o.push("proto.lo=function "+r+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+g.join(","));for(var _=0;_<t;++_){o.push("if(typeof i"+_+"==='number'&&i"+_+">=0){d=i"+_+"|0;b+=c"+_+"*d;a"+_+"-=d}")}o.push("return new "+r+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"c"+e}).join(",")+",b)}");o.push("proto.step=function "+r+"_step("+u.join(",")+"){var "+l.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+l.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var _=0;_<t;++_){o.push("if(typeof i"+_+"==='number'){d=i"+_+"|0;if(d<0){c+=b"+_+"*(a"+_+"-1);a"+_+"=ceil(-a"+_+"/d)}else{a"+_+"=ceil(a"+_+"/d)}b"+_+"*=d}")}o.push("return new "+r+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"b"+e}).join(",")+",c)}");var m=new Array(t);var v=new Array(t);for(var _=0;_<t;++_){m[_]="a[i"+_+"]";v[_]="b[i"+_+"]"}o.push("proto.transpose=function "+r+"_transpose("+u+"){"+u.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+m.join(",")+","+v.join(",")+",this.offset)}");o.push("proto.pick=function "+r+"_pick("+u+"){var a=[],b=[],c=this.offset");for(var _=0;_<t;++_){o.push("if(typeof i"+_+"==='number'&&i"+_+">=0){c=(c+this.stride["+_+"]*i"+_+")|0}else{a.push(this.shape["+_+"]);b.push(this.stride["+_+"])}")}o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");o.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+l.map(function(e){return"shape["+e+"]"}).join(",")+","+l.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var a=new Function("CTOR_LIST","ORDER",o.join("\n"));return a(f[e],s)}function u(e){if(i(e)){return"buffer"}if(o){switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}}if(Array.isArray(e)){return"array"}return"generic"}var f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var e in f){f[e].push(l(e,-1))}});function c(e,t,r,n){if(e===undefined){var i=f.array[0];return i([])}else if(typeof e==="number"){e=[e]}if(t===undefined){t=[e.length]}var o=t.length;if(r===undefined){r=new Array(o);for(var a=o-1,s=1;a>=0;--a){r[a]=s;s*=t[a]}}if(n===undefined){n=0;for(var a=0;a<o;++a){if(r[a]<0){n-=(t[a]-1)*r[a]}}}var c=u(e);var d=f[c];while(d.length<=o+1){d.push(l(c,d.length-1))}var i=d[o+1];return i(e,t,r,n)}t.exports=c},{"iota-array":9,"is-buffer":10}],9:[function(e,t,r){"use strict";function n(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=r}return t}t.exports=n},{}],10:[function(e,t,r){t.exports=function(e){return!!(e!=null&&(e._isBuffer||e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)))}},{}],11:[function(e,t,r){"use strict";"use restrict";var n=32;r.INT_BITS=n;r.INT_MAX=2147483647;r.INT_MIN=-1<<n-1;r.sign=function(e){return(e>0)-(e<0)};r.abs=function(e){var t=e>>n-1;return(e^t)-t};r.min=function(e,t){return t^(e^t)&-(e<t)};r.max=function(e,t){return e^(e^t)&-(e<t)};r.isPow2=function(e){return!(e&e-1)&&!!e};r.log2=function(e){var t,r;t=(e>65535)<<4;e>>>=t;r=(e>255)<<3;e>>>=r;t|=r;r=(e>15)<<2;e>>>=r;t|=r;r=(e>3)<<1;e>>>=r;t|=r;return t|e>>1};r.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0};r.popCount=function(e){e=e-(e>>>1&1431655765);e=(e&858993459)+(e>>>2&858993459);return(e+(e>>>4)&252645135)*16843009>>>24};function i(e){var t=32;e&=-e;if(e)t--;if(e&65535)t-=16;if(e&16711935)t-=8;if(e&252645135)t-=4;if(e&858993459)t-=2;if(e&1431655765)t-=1;return t}r.countTrailingZeros=i;r.nextPow2=function(e){e+=e===0;--e;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e+1};r.prevPow2=function(e){e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e-(e>>>1)};r.parity=function(e){e^=e>>>16;e^=e>>>8;e^=e>>>4;e&=15;return 27030>>>e&1};var o=new Array(256);(function(e){for(var t=0;t<256;++t){var r=t,n=t,i=7;for(r>>>=1;r;r>>>=1){n<<=1;n|=r&1;--i}e[t]=n<<i&255}})(o);r.reverse=function(e){return o[e&255]<<24|o[e>>>8&255]<<16|o[e>>>16&255]<<8|o[e>>>24&255]};r.interleave2=function(e,t){e&=65535;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t&=65535;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1};r.deinterleave2=function(e,t){e=e>>>t&1431655765;e=(e|e>>>1)&858993459;e=(e|e>>>2)&252645135;e=(e|e>>>4)&16711935;e=(e|e>>>16)&65535;return e<<16>>16};r.interleave3=function(e,t,r){e&=1023;e=(e|e<<16)&4278190335;e=(e|e<<8)&251719695;e=(e|e<<4)&3272356035;e=(e|e<<2)&1227133513;t&=1023;t=(t|t<<16)&4278190335;t=(t|t<<8)&251719695;t=(t|t<<4)&3272356035;t=(t|t<<2)&1227133513;e|=t<<1;r&=1023;r=(r|r<<16)&4278190335;r=(r|r<<8)&251719695;r=(r|r<<4)&3272356035;r=(r|r<<2)&1227133513;return e|r<<2};r.deinterleave3=function(e,t){e=e>>>t&1227133513;e=(e|e>>>2)&3272356035;e=(e|e>>>4)&251719695;e=(e|e>>>8)&4278190335;e=(e|e>>>16)&1023;return e<<22>>22};r.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>i(e)+1}},{}],12:[function(e,t,r){"use strict";function n(e,t,r){var i=e[r]|0;if(i<=0){return[]}var o=new Array(i),a;if(r===e.length-1){for(a=0;a<i;++a){o[a]=t}}else{for(a=0;a<i;++a){o[a]=n(e,t,r+1)}}return o}function i(e,t){var r,n;r=new Array(e);for(n=0;n<e;++n){r[n]=t}return r}function o(e,t){if(typeof t==="undefined"){t=0}switch(typeof e){case"number":if(e>0){return i(e|0,t)}break;case"object":if(typeof e.length==="number"){return n(e,t,0)}break}return[]}t.exports=o},{}],13:[function(e,t,r){(function(t,n){"use strict";var i=e("bit-twiddle");var o=e("dup");if(!t.__TYPEDARRAY_POOL){t.__TYPEDARRAY_POOL={UINT8:o([32,0]),UINT16:o([32,0]),UINT32:o([32,0]),INT8:o([32,0]),INT16:o([32,0]),INT32:o([32,0]),FLOAT:o([32,0]),DOUBLE:o([32,0]),DATA:o([32,0]),UINT8C:o([32,0]),BUFFER:o([32,0])}}var a=typeof Uint8ClampedArray!=="undefined";var s=t.__TYPEDARRAY_POOL;if(!s.UINT8C){s.UINT8C=o([32,0])}if(!s.BUFFER){s.BUFFER=o([32,0])}var l=s.DATA,u=s.BUFFER;r.free=function A(e){if(n.isBuffer(e)){u[i.log2(e.length)].push(e)}else{if(Object.prototype.toString.call(e)!=="[object ArrayBuffer]"){e=e.buffer}if(!e){return}var t=e.length||e.byteLength;var r=i.log2(t)|0;l[r].push(e)}};function f(e){if(!e){return}var t=e.length||e.byteLength;var r=i.log2(t);l[r].push(e)}function c(e){f(e.buffer)}r.freeUint8=r.freeUint16=r.freeUint32=r.freeInt8=r.freeInt16=r.freeInt32=r.freeFloat32=r.freeFloat=r.freeFloat64=r.freeDouble=r.freeUint8Clamped=r.freeDataView=c;r.freeArrayBuffer=f;r.freeBuffer=function x(e){u[i.log2(e.length)].push(e)};r.malloc=function R(e,t){if(t===undefined||t==="arraybuffer"){return d(e)}else{switch(t){case"uint8":return h(e);case"uint16":return p(e);case"uint32":return g(e);case"int8":return _(e);case"int16":return m(e);case"int32":return v(e);case"float":case"float32":return b(e);case"double":case"float64":return y(e);case"uint8_clamped":return E(e);case"buffer":return T(e);case"data":case"dataview":return w(e);default:return null}}return null};function d(e){var e=i.nextPow2(e);var t=i.log2(e);var r=l[t];if(r.length>0){return r.pop()}return new ArrayBuffer(e)}r.mallocArrayBuffer=d;function h(e){return new Uint8Array(d(e),0,e)}r.mallocUint8=h;function p(e){return new Uint16Array(d(2*e),0,e)}r.mallocUint16=p;function g(e){return new Uint32Array(d(4*e),0,e)}r.mallocUint32=g;function _(e){return new Int8Array(d(e),0,e)}r.mallocInt8=_;function m(e){return new Int16Array(d(2*e),0,e)}r.mallocInt16=m;function v(e){return new Int32Array(d(4*e),0,e)}r.mallocInt32=v;function b(e){return new Float32Array(d(4*e),0,e)}r.mallocFloat32=r.mallocFloat=b;function y(e){return new Float64Array(d(8*e),0,e)}r.mallocFloat64=r.mallocDouble=y;function E(e){if(a){return new Uint8ClampedArray(d(e),0,e)}else{return h(e)}}r.mallocUint8Clamped=E;function w(e){return new DataView(d(e),0,e)}r.mallocDataView=w;function T(e){e=i.nextPow2(e);var t=i.log2(e);var r=u[t];if(r.length>0){return r.pop()}return new n(e)}r.mallocBuffer=T;r.clearCache=function C(){for(var e=0;e<32;++e){s.UINT8[e].length=0;s.UINT16[e].length=0;s.UINT32[e].length=0;s.INT8[e].length=0;s.INT16[e].length=0;s.INT32[e].length=0;s.FLOAT[e].length=0;s.DOUBLE[e].length=0;s.UINT8C[e].length=0;l[e].length=0;u[e].length=0}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer)},{"bit-twiddle":11,buffer:20,dup:12}],14:[function(e,t,r){"use strict";function n(e,t,r){if(t){t.bind()}else{e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}var n=e.getParameter(e.MAX_VERTEX_ATTRIBS)|0;if(r){if(r.length>n){throw new Error("gl-vao: Too many vertex attributes")}for(var i=0;i<r.length;++i){var o=r[i];if(o.buffer){var a=o.buffer;var s=o.size||4;var l=o.type||e.FLOAT;var u=!!o.normalized;var f=o.stride||0;var c=o.offset||0;a.bind();e.enableVertexAttribArray(i);e.vertexAttribPointer(i,s,l,u,f,c)}else{if(typeof o==="number"){e.vertexAttrib1f(i,o)}else if(o.length===1){e.vertexAttrib1f(i,o[0])}else if(o.length===2){e.vertexAttrib2f(i,o[0],o[1])}else if(o.length===3){e.vertexAttrib3f(i,o[0],o[1],o[2])}else if(o.length===4){e.vertexAttrib4f(i,o[0],o[1],o[2],o[3])}else{throw new Error("gl-vao: Invalid vertex attribute")}e.disableVertexAttribArray(i)}}for(;i<n;++i){e.disableVertexAttribArray(i)}}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var i=0;i<n;++i){e.disableVertexAttribArray(i)}}}t.exports=n},{}],15:[function(e,t,r){"use strict";var n=e("./do-bind.js");function i(e){this.gl=e;this._elements=null;this._attributes=null;this._elementsType=e.UNSIGNED_SHORT}i.prototype.bind=function(){n(this.gl,this._elements,this._attributes)};i.prototype.update=function(e,t,r){this._elements=t;this._attributes=e;this._elementsType=r||this.gl.UNSIGNED_SHORT};i.prototype.dispose=function(){};i.prototype.unbind=function(){};i.prototype.draw=function(e,t,r){r=r||0;var n=this.gl;if(this._elements){n.drawElements(e,t,this._elementsType,r)}else{n.drawArrays(e,r,t)}};function o(e){return new i(e)}t.exports=o},{"./do-bind.js":14}],16:[function(e,t,r){"use strict";var n=e("./do-bind.js");function i(e,t,r,n,i,o){this.location=e;this.dimension=t;this.a=r;this.b=n;this.c=i;this.d=o}i.prototype.bind=function(e){switch(this.dimension){case 1:e.vertexAttrib1f(this.location,this.a);break;case 2:e.vertexAttrib2f(this.location,this.a,this.b);break;case 3:e.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:e.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function o(e,t,r){this.gl=e;this._ext=t;this.handle=r;this._attribs=[];this._useElements=false;this._elementsType=e.UNSIGNED_SHORT}o.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var e=0;e<this._attribs.length;++e){this._attribs[e].bind(this.gl)}};o.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)};o.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)};o.prototype.update=function(e,t,r){this.bind();n(this.gl,t,e);this.unbind();this._attribs.length=0;if(e)for(var o=0;o<e.length;++o){var a=e[o];if(typeof a==="number"){this._attribs.push(new i(o,1,a))}else if(Array.isArray(a)){this._attribs.push(new i(o,a.length,a[0],a[1],a[2],a[3]))}}this._useElements=!!t;this._elementsType=r||this.gl.UNSIGNED_SHORT};o.prototype.draw=function(e,t,r){r=r||0;var n=this.gl;if(this._useElements){n.drawElements(e,t,this._elementsType,r)}else{n.drawArrays(e,r,t)}};function a(e,t){return new o(e,t,t.createVertexArrayOES())}t.exports=a},{"./do-bind.js":14}],17:[function(e,t,r){"use strict";var n=e("./lib/vao-native.js");var i=e("./lib/vao-emulated.js");function o(e,t,r,o){var a=e.getExtension("OES_vertex_array_object");var s;if(a){s=n(e,a)}else{s=i(e)}s.update(t,r,o);return s}t.exports=o},{"./lib/vao-emulated.js":15,"./lib/vao-native.js":16}],18:[function(e,t,r){(function n(){"use strict";if(typeof ses!=="undefined"&&ses.ok&&!ses.ok()){return}function e(t){if(t.permitHostObjects___){t.permitHostObjects___(e)}}if(typeof ses!=="undefined"){ses.weakMapPermitHostObjects=e}var r=false;if(typeof WeakMap==="function"){var n=WeakMap;if(typeof navigator!=="undefined"&&/Firefox/.test(navigator.userAgent)){}else{var i=new n;var o=Object.freeze({});i.set(o,1);if(i.get(o)!==1){r=true}else{t.exports=WeakMap;return}}}var a=Object.prototype.hasOwnProperty;var s=Object.getOwnPropertyNames;var l=Object.defineProperty;var u=Object.isExtensible;var f="weakmap:";var c=f+"ident:"+Math.random()+"___";if(typeof crypto!=="undefined"&&typeof crypto.getRandomValues==="function"&&typeof ArrayBuffer==="function"&&typeof Uint8Array==="function"){var d=new ArrayBuffer(25);var h=new Uint8Array(d);crypto.getRandomValues(h);c=f+"rand:"+Array.prototype.map.call(h,function(e){return(e%36).toString(36)}).join("")+"___"}function p(e){return!(e.substr(0,f.length)==f&&e.substr(e.length-3)==="___")}l(Object,"getOwnPropertyNames",{value:function w(e){return s(e).filter(p)}});if("getPropertyNames"in Object){var g=Object.getPropertyNames;l(Object,"getPropertyNames",{value:function T(e){return g(e).filter(p)}})}function _(e){if(e!==Object(e)){throw new TypeError("Not an object: "+e)}var t=e[c];if(t&&t.key===e){return t}if(!u(e)){return void 0}t={key:e};try{l(e,c,{value:t,writable:false,enumerable:false,configurable:false});return t}catch(r){return void 0}}(function(){var e=Object.freeze;l(Object,"freeze",{value:function n(t){_(t);return e(t)}});var t=Object.seal;l(Object,"seal",{value:function i(e){_(e);return t(e)}});var r=Object.preventExtensions;l(Object,"preventExtensions",{value:function o(e){_(e);return r(e)}})})();function m(e){e.prototype=null;return Object.freeze(e)}var v=false;function b(){if(!v&&typeof console!=="undefined"){v=true;console.warn("WeakMap should be invoked as new WeakMap(), not "+"WeakMap(). This will be an error in the future.")}}var y=0;var E=function(){if(!(this instanceof E)){b()}var e=[];var t=[];var r=y++;function n(n,i){var o;var a=_(n);if(a){return r in a?a[r]:i}else{o=e.indexOf(n);return o>=0?t[o]:i}}function i(t){var n=_(t);if(n){return r in n}else{return e.indexOf(t)>=0}}function o(n,i){var o;var a=_(n);if(a){a[r]=i}else{o=e.indexOf(n);if(o>=0){t[o]=i}else{o=e.length;t[o]=i;e[o]=n}}return this}function a(n){var i=_(n);var o,a;if(i){return r in i&&delete i[r]}else{o=e.indexOf(n);if(o<0){return false}a=e.length-1;e[o]=void 0;t[o]=t[a];e[o]=e[a];e.length=a;t.length=a;return true}}return Object.create(E.prototype,{get___:{value:m(n)},has___:{value:m(i)},set___:{value:m(o)},delete___:{value:m(a)}})};E.prototype=Object.create(Object.prototype,{get:{value:function A(e,t){return this.get___(e,t)},writable:true,configurable:true},has:{value:function x(e){return this.has___(e)},writable:true,configurable:true},set:{value:function R(e,t){return this.set___(e,t)},writable:true,configurable:true},"delete":{value:function C(e){return this.delete___(e)},writable:true,configurable:true}});if(typeof n==="function"){(function(){if(r&&typeof Proxy!=="undefined"){Proxy=undefined}function i(){if(!(this instanceof E)){b()}var t=new n;var i=undefined;var o=false;function a(e,r){if(i){return t.has(e)?t.get(e):i.get___(e,r)}else{return t.get(e,r)}}function s(e){return t.has(e)||(i?i.has___(e):false)}var l;if(r){l=function(e,r){t.set(e,r);if(!t.has(e)){if(!i){i=new E}i.set(e,r)}return this}}else{l=function(e,r){if(o){try{t.set(e,r)}catch(n){if(!i){i=new E}i.set___(e,r)}}else{t.set(e,r)}return this}}function u(e){var r=!!t["delete"](e);if(i){return i.delete___(e)||r}return r}return Object.create(E.prototype,{get___:{value:m(a)},has___:{value:m(s)},set___:{value:m(l)},delete___:{value:m(u)},permitHostObjects___:{value:m(function(t){if(t===e){o=true}else{throw new Error("bogus call to permitHostObjects___")}})}})}i.prototype=E.prototype;t.exports=i;Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:false,configurable:true,writable:true})})()}else{if(typeof Proxy!=="undefined"){Proxy=undefined}t.exports=E}})()},{}],19:[function(e,t,r){"use strict";var n=typeof WeakMap==="undefined"?e("weak-map"):WeakMap;var i=e("gl-buffer");var o=e("gl-vao");var a=new n;function s(e){var t=a.get(e);if(!t||!e.isBuffer(t._triangleBuffer.buffer)){var r=i(e,new Float32Array([-1,-1,-1,4,4,-1]));t=o(e,[{buffer:r,type:e.FLOAT,size:2}]);t._triangleBuffer=r;a.set(e,t)}t.bind();e.drawArrays(e.TRIANGLES,0,3);t.unbind()}t.exports=s},{"gl-buffer":2,"gl-vao":17,"weak-map":18}],20:[function(e,t,r){(function(t){"use strict";var n=e("base64-js");var i=e("ieee754");var o=e("isarray");r.Buffer=u;r.SlowBuffer=E;r.INSPECT_MAX_BYTES=50;u.poolSize=8192;var a={};u.TYPED_ARRAY_SUPPORT=t.TYPED_ARRAY_SUPPORT!==undefined?t.TYPED_ARRAY_SUPPORT:s();function s(){try{var e=new Uint8Array(1);e.foo=function(){return 42};return e.foo()===42&&typeof e.subarray==="function"&&e.subarray(1,1).byteLength===0}catch(t){return false}}function l(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e){if(!(this instanceof u)){if(arguments.length>1)return new u(e,arguments[1]);return new u(e)}if(!u.TYPED_ARRAY_SUPPORT){this.length=0;this.parent=undefined}if(typeof e==="number"){return f(this,e)}if(typeof e==="string"){return c(this,e,arguments.length>1?arguments[1]:"utf8")}return d(this,e)}function f(e,t){e=b(e,t<0?0:y(t)|0);if(!u.TYPED_ARRAY_SUPPORT){for(var r=0;r<t;r++){e[r]=0}}return e}function c(e,t,r){if(typeof r!=="string"||r==="")r="utf8";var n=w(t,r)|0;e=b(e,n);e.write(t,r);return e}function d(e,t){if(u.isBuffer(t))return h(e,t);if(o(t))return p(e,t);if(t==null){throw new TypeError("must start with number, buffer, array or string")}if(typeof ArrayBuffer!=="undefined"){if(t.buffer instanceof ArrayBuffer){return g(e,t)}if(t instanceof ArrayBuffer){return _(e,t)}}if(t.length)return m(e,t);return v(e,t)}function h(e,t){var r=y(t.length)|0;e=b(e,r);t.copy(e,0,0,r);return e}function p(e,t){var r=y(t.length)|0;e=b(e,r);for(var n=0;n<r;n+=1){e[n]=t[n]&255}return e}function g(e,t){var r=y(t.length)|0;e=b(e,r);for(var n=0;n<r;n+=1){e[n]=t[n]&255}return e}function _(e,t){t.byteLength;if(u.TYPED_ARRAY_SUPPORT){e=new Uint8Array(t);e.__proto__=u.prototype}else{e=g(e,new Uint8Array(t))}return e}function m(e,t){var r=y(t.length)|0;e=b(e,r);for(var n=0;n<r;n+=1){e[n]=t[n]&255}return e}function v(e,t){var r;var n=0;if(t.type==="Buffer"&&o(t.data)){r=t.data;n=y(r.length)|0}e=b(e,n);for(var i=0;i<n;i+=1){e[i]=r[i]&255}return e}if(u.TYPED_ARRAY_SUPPORT){u.prototype.__proto__=Uint8Array.prototype;u.__proto__=Uint8Array}else{u.prototype.length=undefined;u.prototype.parent=undefined}function b(e,t){if(u.TYPED_ARRAY_SUPPORT){e=new Uint8Array(t);e.__proto__=u.prototype}else{e.length=t}var r=t!==0&&t<=u.poolSize>>>1;if(r)e.parent=a;return e}function y(e){if(e>=l()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+l().toString(16)+" bytes")}return e|0}function E(e,t){if(!(this instanceof E))return new E(e,t);var r=new u(e,t);delete r.parent;return r}u.isBuffer=function ee(e){return!!(e!=null&&e._isBuffer)};u.compare=function te(e,t){if(!u.isBuffer(e)||!u.isBuffer(t)){throw new TypeError("Arguments must be Buffers")}if(e===t)return 0;var r=e.length;var n=t.length;var i=0;var o=Math.min(r,n);while(i<o){if(e[i]!==t[i])break;++i}if(i!==o){r=e[i];n=t[i]}if(r<n)return-1;if(n<r)return 1;return 0};u.isEncoding=function re(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};u.concat=function ne(e,t){if(!o(e))throw new TypeError("list argument must be an Array of Buffers.");if(e.length===0){return new u(0)}var r;if(t===undefined){t=0;for(r=0;r<e.length;r++){t+=e[r].length}}var n=new u(t);var i=0;for(r=0;r<e.length;r++){var a=e[r];a.copy(n,i);i+=a.length}return n};function w(e,t){if(typeof e!=="string")e=""+e;var r=e.length;if(r===0)return 0;var n=false;for(;;){switch(t){case"ascii":case"binary":case"raw":case"raws":return r;case"utf8":case"utf-8":return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Q(e).length;default:if(n)return K(e).length;t=(""+t).toLowerCase();n=true}}}u.byteLength=w;function T(e,t,r){var n=false;t=t|0;r=r===undefined||r===Infinity?this.length:r|0;if(!e)e="utf8";if(t<0)t=0;if(r>this.length)r=this.length;if(r<=t)return"";while(true){switch(e){case"hex":return M(this,t,r);case"utf8":case"utf-8":return L(this,t,r);case"ascii":return O(this,t,r);case"binary":return j(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}u.prototype._isBuffer=true;u.prototype.toString=function ie(){var e=this.length|0;if(e===0)return"";if(arguments.length===0)return L(this,0,e);return T.apply(this,arguments)};u.prototype.equals=function oe(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(this===e)return true;return u.compare(this,e)===0};u.prototype.inspect=function ae(){var e="";var t=r.INSPECT_MAX_BYTES;if(this.length>0){e=this.toString("hex",0,t).match(/.{2}/g).join(" ");if(this.length>t)e+=" ... "}return"<Buffer "+e+">"};u.prototype.compare=function se(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(this===e)return 0;return u.compare(this,e)};u.prototype.indexOf=function le(e,t){if(t>2147483647)t=2147483647;else if(t<-2147483648)t=-2147483648;t>>=0;if(this.length===0)return-1;if(t>=this.length)return-1;if(t<0)t=Math.max(this.length+t,0);if(typeof e==="string"){if(e.length===0)return-1;return String.prototype.indexOf.call(this,e,t)}if(u.isBuffer(e)){return r(this,e,t)}if(typeof e==="number"){if(u.TYPED_ARRAY_SUPPORT&&Uint8Array.prototype.indexOf==="function"){return Uint8Array.prototype.indexOf.call(this,e,t)}return r(this,[e],t)}function r(e,t,r){var n=-1;for(var i=0;r+i<e.length;i++){if(e[r+i]===t[n===-1?0:i-n]){if(n===-1)n=i;if(i-n+1===t.length)return r+n}else{n=-1}}return-1}throw new TypeError("val must be string, number or Buffer")};function A(e,t,r,n){r=Number(r)||0;var i=e.length-r;if(!n){n=i}else{n=Number(n);if(n>i){n=i}}var o=t.length;if(o%2!==0)throw new Error("Invalid hex string");if(n>o/2){n=o/2}for(var a=0;a<n;a++){var s=parseInt(t.substr(a*2,2),16);if(isNaN(s))throw new Error("Invalid hex string");e[r+a]=s}return a}function x(e,t,r,n){return $(K(t,e.length-r),e,r,n)}function R(e,t,r,n){return $(J(t),e,r,n)}function C(e,t,r,n){return R(e,t,r,n)}function S(e,t,r,n){return $(Q(t),e,r,n)}function k(e,t,r,n){return $(Z(t,e.length-r),e,r,n)}u.prototype.write=function ue(e,t,r,n){if(t===undefined){n="utf8";r=this.length;t=0}else if(r===undefined&&typeof t==="string"){n=t;r=this.length;t=0}else if(isFinite(t)){t=t|0;if(isFinite(r)){r=r|0;if(n===undefined)n="utf8"}else{n=r;r=undefined}}else{var i=n;n=t;t=r|0;r=i}var o=this.length-t;if(r===undefined||r>o)r=o;if(e.length>0&&(r<0||t<0)||t>this.length){throw new RangeError("attempt to write outside buffer bounds")}if(!n)n="utf8";var a=false;for(;;){switch(n){case"hex":return A(this,e,t,r);case"utf8":case"utf-8":return x(this,e,t,r);case"ascii":return R(this,e,t,r);case"binary":return C(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase();a=true}}};u.prototype.toJSON=function fe(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(e,t,r){if(t===0&&r===e.length){return n.fromByteArray(e)}else{return n.fromByteArray(e.slice(t,r))}}function L(e,t,r){r=Math.min(e.length,r);var n=[];var i=t;while(i<r){var o=e[i];var a=null;var s=o>239?4:o>223?3:o>191?2:1;if(i+s<=r){var l,u,f,c;switch(s){case 1:if(o<128){a=o}break;case 2:l=e[i+1];if((l&192)===128){c=(o&31)<<6|l&63;if(c>127){a=c}}break;case 3:l=e[i+1];u=e[i+2];if((l&192)===128&&(u&192)===128){c=(o&15)<<12|(l&63)<<6|u&63;if(c>2047&&(c<55296||c>57343)){a=c}}break;case 4:l=e[i+1];u=e[i+2];f=e[i+3];if((l&192)===128&&(u&192)===128&&(f&192)===128){c=(o&15)<<18|(l&63)<<12|(u&63)<<6|f&63;if(c>65535&&c<1114112){a=c}}}}if(a===null){a=65533;s=1}else if(a>65535){a-=65536;n.push(a>>>10&1023|55296);a=56320|a&1023}n.push(a);i+=s}return P(n)}var N=4096;function P(e){var t=e.length;if(t<=N){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=N))}return r}function O(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;i++){n+=String.fromCharCode(e[i]&127)}return n}function j(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;i++){n+=String.fromCharCode(e[i])}return n}function M(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var i="";for(var o=t;o<r;o++){i+=W(e[o])}return i}function U(e,t,r){var n=e.slice(t,r);var i="";for(var o=0;o<n.length;o+=2){i+=String.fromCharCode(n[o]+n[o+1]*256)}return i}u.prototype.slice=function ce(e,t){var r=this.length;e=~~e;t=t===undefined?r:~~t;if(e<0){e+=r;if(e<0)e=0}else if(e>r){e=r}if(t<0){t+=r;if(t<0)t=0}else if(t>r){t=r}if(t<e)t=e;var n;if(u.TYPED_ARRAY_SUPPORT){n=this.subarray(e,t);n.__proto__=u.prototype}else{var i=t-e;n=new u(i,undefined);for(var o=0;o<i;o++){n[o]=this[o+e]}}if(n.length)n.parent=this.parent||this;return n};function D(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUIntLE=function de(e,t,r){e=e|0;t=t|0;if(!r)D(e,t,this.length);var n=this[e];var i=1;var o=0;while(++o<t&&(i*=256)){n+=this[e+o]*i}return n};u.prototype.readUIntBE=function he(e,t,r){e=e|0;t=t|0;if(!r){D(e,t,this.length)}var n=this[e+--t];var i=1;while(t>0&&(i*=256)){n+=this[e+--t]*i}return n};u.prototype.readUInt8=function pe(e,t){if(!t)D(e,1,this.length);return this[e]};u.prototype.readUInt16LE=function ge(e,t){if(!t)D(e,2,this.length);return this[e]|this[e+1]<<8};u.prototype.readUInt16BE=function _e(e,t){if(!t)D(e,2,this.length);return this[e]<<8|this[e+1]};u.prototype.readUInt32LE=function me(e,t){if(!t)D(e,4,this.length);return(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};u.prototype.readUInt32BE=function ve(e,t){if(!t)D(e,4,this.length);return this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};u.prototype.readIntLE=function be(e,t,r){e=e|0;t=t|0;if(!r)D(e,t,this.length);var n=this[e];var i=1;var o=0;while(++o<t&&(i*=256)){n+=this[e+o]*i}i*=128;if(n>=i)n-=Math.pow(2,8*t);return n};u.prototype.readIntBE=function ye(e,t,r){e=e|0;t=t|0;if(!r)D(e,t,this.length);var n=t;var i=1;var o=this[e+--n];while(n>0&&(i*=256)){o+=this[e+--n]*i}i*=128;if(o>=i)o-=Math.pow(2,8*t);return o};u.prototype.readInt8=function Ee(e,t){if(!t)D(e,1,this.length);if(!(this[e]&128))return this[e];return(255-this[e]+1)*-1};u.prototype.readInt16LE=function we(e,t){if(!t)D(e,2,this.length);var r=this[e]|this[e+1]<<8;return r&32768?r|4294901760:r};u.prototype.readInt16BE=function Te(e,t){if(!t)D(e,2,this.length);var r=this[e+1]|this[e]<<8;return r&32768?r|4294901760:r};u.prototype.readInt32LE=function Ae(e,t){if(!t)D(e,4,this.length);return this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};u.prototype.readInt32BE=function xe(e,t){if(!t)D(e,4,this.length);return this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};u.prototype.readFloatLE=function Re(e,t){if(!t)D(e,4,this.length);return i.read(this,e,true,23,4)};u.prototype.readFloatBE=function Ce(e,t){if(!t)D(e,4,this.length);return i.read(this,e,false,23,4)};u.prototype.readDoubleLE=function Se(e,t){if(!t)D(e,8,this.length);return i.read(this,e,true,52,8)};u.prototype.readDoubleBE=function ke(e,t){if(!t)D(e,8,this.length);return i.read(this,e,false,52,8)};function F(e,t,r,n,i,o){if(!u.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(t>i||t<o)throw new RangeError("value is out of bounds");if(r+n>e.length)throw new RangeError("index out of range")}u.prototype.writeUIntLE=function Ie(e,t,r,n){e=+e;t=t|0;r=r|0;if(!n)F(this,e,t,r,Math.pow(2,8*r),0);var i=1;var o=0;this[t]=e&255;while(++o<r&&(i*=256)){this[t+o]=e/i&255}return t+r};u.prototype.writeUIntBE=function Le(e,t,r,n){e=+e;t=t|0;r=r|0;if(!n)F(this,e,t,r,Math.pow(2,8*r),0);var i=r-1;var o=1;this[t+i]=e&255;while(--i>=0&&(o*=256)){this[t+i]=e/o&255}return t+r};u.prototype.writeUInt8=function Ne(e,t,r){e=+e;t=t|0;if(!r)F(this,e,t,1,255,0);if(!u.TYPED_ARRAY_SUPPORT)e=Math.floor(e);this[t]=e&255;return t+1};function B(e,t,r,n){if(t<0)t=65535+t+1;for(var i=0,o=Math.min(e.length-r,2);i<o;i++){e[r+i]=(t&255<<8*(n?i:1-i))>>>(n?i:1-i)*8}}u.prototype.writeUInt16LE=function Pe(e,t,r){e=+e;t=t|0;if(!r)F(this,e,t,2,65535,0);if(u.TYPED_ARRAY_SUPPORT){this[t]=e&255;this[t+1]=e>>>8}else{B(this,e,t,true)}return t+2};u.prototype.writeUInt16BE=function Oe(e,t,r){e=+e;t=t|0;if(!r)F(this,e,t,2,65535,0);if(u.TYPED_ARRAY_SUPPORT){this[t]=e>>>8;this[t+1]=e&255}else{B(this,e,t,false)}return t+2};function V(e,t,r,n){if(t<0)t=4294967295+t+1;for(var i=0,o=Math.min(e.length-r,4);i<o;i++){e[r+i]=t>>>(n?i:3-i)*8&255}}u.prototype.writeUInt32LE=function je(e,t,r){e=+e;t=t|0;if(!r)F(this,e,t,4,4294967295,0);if(u.TYPED_ARRAY_SUPPORT){this[t+3]=e>>>24;this[t+2]=e>>>16;this[t+1]=e>>>8;this[t]=e&255}else{V(this,e,t,true)}return t+4};u.prototype.writeUInt32BE=function Me(e,t,r){e=+e;t=t|0;if(!r)F(this,e,t,4,4294967295,0);if(u.TYPED_ARRAY_SUPPORT){this[t]=e>>>24;this[t+1]=e>>>16;this[t+2]=e>>>8;this[t+3]=e&255}else{V(this,e,t,false)}return t+4};u.prototype.writeIntLE=function Ue(e,t,r,n){e=+e;t=t|0;if(!n){var i=Math.pow(2,8*r-1);F(this,e,t,r,i-1,-i)}var o=0;var a=1;var s=e<0?1:0;this[t]=e&255;while(++o<r&&(a*=256)){this[t+o]=(e/a>>0)-s&255}return t+r};u.prototype.writeIntBE=function De(e,t,r,n){e=+e;t=t|0;if(!n){var i=Math.pow(2,8*r-1);F(this,e,t,r,i-1,-i)}var o=r-1;var a=1;var s=e<0?1:0;this[t+o]=e&255;while(--o>=0&&(a*=256)){this[t+o]=(e/a>>0)-s&255}return t+r};u.prototype.writeInt8=function Fe(e,t,r){e=+e;t=t|0;if(!r)F(this,e,t,1,127,-128);if(!u.TYPED_ARRAY_SUPPORT)e=Math.floor(e);if(e<0)e=255+e+1;this[t]=e&255;return t+1};u.prototype.writeInt16LE=function Be(e,t,r){e=+e;t=t|0;if(!r)F(this,e,t,2,32767,-32768);if(u.TYPED_ARRAY_SUPPORT){this[t]=e&255;this[t+1]=e>>>8}else{B(this,e,t,true)}return t+2};u.prototype.writeInt16BE=function Ve(e,t,r){e=+e;t=t|0;if(!r)F(this,e,t,2,32767,-32768);if(u.TYPED_ARRAY_SUPPORT){this[t]=e>>>8;this[t+1]=e&255}else{B(this,e,t,false)}return t+2};u.prototype.writeInt32LE=function Xe(e,t,r){e=+e;t=t|0;if(!r)F(this,e,t,4,2147483647,-2147483648);if(u.TYPED_ARRAY_SUPPORT){this[t]=e&255;this[t+1]=e>>>8;this[t+2]=e>>>16;this[t+3]=e>>>24}else{V(this,e,t,true)}return t+4};u.prototype.writeInt32BE=function He(e,t,r){e=+e;t=t|0;if(!r)F(this,e,t,4,2147483647,-2147483648);if(e<0)e=4294967295+e+1;if(u.TYPED_ARRAY_SUPPORT){this[t]=e>>>24;this[t+1]=e>>>16;this[t+2]=e>>>8;this[t+3]=e&255}else{V(this,e,t,false)}return t+4};function X(e,t,r,n,i,o){if(t>i||t<o)throw new RangeError("value is out of bounds");if(r+n>e.length)throw new RangeError("index out of range");if(r<0)throw new RangeError("index out of range")}function H(e,t,r,n,o){if(!o){X(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38)}i.write(e,t,r,n,23,4);return r+4}u.prototype.writeFloatLE=function Ge(e,t,r){return H(this,e,t,true,r)};u.prototype.writeFloatBE=function ze(e,t,r){return H(this,e,t,false,r)};function G(e,t,r,n,o){if(!o){X(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308)}i.write(e,t,r,n,52,8);return r+8;
}u.prototype.writeDoubleLE=function Ye(e,t,r){return G(this,e,t,true,r)};u.prototype.writeDoubleBE=function qe(e,t,r){return G(this,e,t,false,r)};u.prototype.copy=function We(e,t,r,n){if(!r)r=0;if(!n&&n!==0)n=this.length;if(t>=e.length)t=e.length;if(!t)t=0;if(n>0&&n<r)n=r;if(n===r)return 0;if(e.length===0||this.length===0)return 0;if(t<0){throw new RangeError("targetStart out of bounds")}if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");if(n>this.length)n=this.length;if(e.length-t<n-r){n=e.length-t+r}var i=n-r;var o;if(this===e&&r<t&&t<n){for(o=i-1;o>=0;o--){e[o+t]=this[o+r]}}else if(i<1e3||!u.TYPED_ARRAY_SUPPORT){for(o=0;o<i;o++){e[o+t]=this[o+r]}}else{Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t)}return i};u.prototype.fill=function Ke(e,t,r){if(!e)e=0;if(!t)t=0;if(!r)r=this.length;if(r<t)throw new RangeError("end < start");if(r===t)return;if(this.length===0)return;if(t<0||t>=this.length)throw new RangeError("start out of bounds");if(r<0||r>this.length)throw new RangeError("end out of bounds");var n;if(typeof e==="number"){for(n=t;n<r;n++){this[n]=e}}else{var i=K(e.toString());var o=i.length;for(n=t;n<r;n++){this[n]=i[n%o]}}return this};var z=/[^+\/0-9A-Za-z-_]/g;function Y(e){e=q(e).replace(z,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function q(e){if(e.trim)return e.trim();return e.replace(/^\s+|\s+$/g,"")}function W(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function K(e,t){t=t||Infinity;var r;var n=e.length;var i=null;var o=[];for(var a=0;a<n;a++){r=e.charCodeAt(a);if(r>55295&&r<57344){if(!i){if(r>56319){if((t-=3)>-1)o.push(239,191,189);continue}else if(a+1===n){if((t-=3)>-1)o.push(239,191,189);continue}i=r;continue}if(r<56320){if((t-=3)>-1)o.push(239,191,189);i=r;continue}r=(i-55296<<10|r-56320)+65536}else if(i){if((t-=3)>-1)o.push(239,191,189)}i=null;if(r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return o}function J(e){var t=[];for(var r=0;r<e.length;r++){t.push(e.charCodeAt(r)&255)}return t}function Z(e,t){var r,n,i;var o=[];for(var a=0;a<e.length;a++){if((t-=2)<0)break;r=e.charCodeAt(a);n=r>>8;i=r%256;o.push(i);o.push(n)}return o}function Q(e){return n.toByteArray(Y(e))}function $(e,t,r,n){for(var i=0;i<n;i++){if(i+r>=t.length||i>=e.length)break;t[i+r]=e[i]}return i}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"base64-js":21,ieee754:22,isarray:23}],21:[function(e,t,r){(function(e){"use strict";var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r=typeof Uint8Array!=="undefined"?Uint8Array:Array;var n="+".charCodeAt(0);var i="/".charCodeAt(0);var o="0".charCodeAt(0);var a="a".charCodeAt(0);var s="A".charCodeAt(0);var l="-".charCodeAt(0);var u="_".charCodeAt(0);function f(e){var t=e.charCodeAt(0);if(t===n||t===l)return 62;if(t===i||t===u)return 63;if(t<o)return-1;if(t<o+10)return t-o+26+26;if(t<s+26)return t-s;if(t<a+26)return t-a+26}function c(e){var t,n,i,o,a,s;if(e.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var l=e.length;a=e.charAt(l-2)==="="?2:e.charAt(l-1)==="="?1:0;s=new r(e.length*3/4-a);i=a>0?e.length-4:e.length;var u=0;function c(e){s[u++]=e}for(t=0,n=0;t<i;t+=4,n+=3){o=f(e.charAt(t))<<18|f(e.charAt(t+1))<<12|f(e.charAt(t+2))<<6|f(e.charAt(t+3));c((o&16711680)>>16);c((o&65280)>>8);c(o&255)}if(a===2){o=f(e.charAt(t))<<2|f(e.charAt(t+1))>>4;c(o&255)}else if(a===1){o=f(e.charAt(t))<<10|f(e.charAt(t+1))<<4|f(e.charAt(t+2))>>2;c(o>>8&255);c(o&255)}return s}function d(e){var r;var n=e.length%3;var i="";var o,a;function s(e){return t.charAt(e)}function l(e){return s(e>>18&63)+s(e>>12&63)+s(e>>6&63)+s(e&63)}for(r=0,a=e.length-n;r<a;r+=3){o=(e[r]<<16)+(e[r+1]<<8)+e[r+2];i+=l(o)}switch(n){case 1:o=e[e.length-1];i+=s(o>>2);i+=s(o<<4&63);i+="==";break;case 2:o=(e[e.length-2]<<8)+e[e.length-1];i+=s(o>>10);i+=s(o>>4&63);i+=s(o<<2&63);i+="=";break;default:break}return i}e.toByteArray=c;e.fromByteArray=d})(typeof r==="undefined"?this.base64js={}:r)},{}],22:[function(e,t,r){r.read=function(e,t,r,n,i){var o,a;var s=i*8-n-1;var l=(1<<s)-1;var u=l>>1;var f=-7;var c=r?i-1:0;var d=r?-1:1;var h=e[t+c];c+=d;o=h&(1<<-f)-1;h>>=-f;f+=s;for(;f>0;o=o*256+e[t+c],c+=d,f-=8){}a=o&(1<<-f)-1;o>>=-f;f+=n;for(;f>0;a=a*256+e[t+c],c+=d,f-=8){}if(o===0){o=1-u}else if(o===l){return a?NaN:(h?-1:1)*Infinity}else{a=a+Math.pow(2,n);o=o-u}return(h?-1:1)*a*Math.pow(2,o-n)};r.write=function(e,t,r,n,i,o){var a,s,l;var u=o*8-i-1;var f=(1<<u)-1;var c=f>>1;var d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0;var h=n?0:o-1;var p=n?1:-1;var g=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){s=isNaN(t)?1:0;a=f}else{a=Math.floor(Math.log(t)/Math.LN2);if(t*(l=Math.pow(2,-a))<1){a--;l*=2}if(a+c>=1){t+=d/l}else{t+=d*Math.pow(2,1-c)}if(t*l>=2){a++;l/=2}if(a+c>=f){s=0;a=f}else if(a+c>=1){s=(t*l-1)*Math.pow(2,i);a=a+c}else{s=t*Math.pow(2,c-1)*Math.pow(2,i);a=0}}for(;i>=8;e[r+h]=s&255,h+=p,s/=256,i-=8){}a=a<<i|s;u+=i;for(;u>0;e[r+h]=a&255,h+=p,a/=256,u-=8){}e[r+h-p]|=g*128}},{}],23:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return n.call(e)=="[object Array]"}},{}],24:[function(e,t,r){function n(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}t.exports=n;n.EventEmitter=n;n.prototype._events=undefined;n.prototype._maxListeners=undefined;n.defaultMaxListeners=10;n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};n.prototype.emit=function(e){var t,r,n,o,l,u;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||a(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}throw TypeError('Uncaught, unspecified "error" event.')}}r=this._events[e];if(s(r))return false;if(i(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1);r.apply(this,o)}}else if(a(r)){o=Array.prototype.slice.call(arguments,1);u=r.slice();n=u.length;for(l=0;l<n;l++)u[l].apply(this,o)}return true};n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,i(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(a(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(a(this._events[e])&&!this._events[e].warned){if(!s(this._maxListeners)){r=this._maxListeners}else{r=n.defaultMaxListeners}if(r&&r>0&&this._events[e].length>r){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};n.prototype.on=n.prototype.addListener;n.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=false;function n(){this.removeListener(e,n);if(!r){r=true;t.apply(this,arguments)}}n.listener=t;this.on(e,n);return this};n.prototype.removeListener=function(e,t){var r,n,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];o=r.length;n=-1;if(r===t||i(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(a(r)){for(s=o;s-- >0;){if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}}if(n<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(n,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(i(r)){this.removeListener(e,r)}else if(r){while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};n.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(i(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;else if(t)return t.length}return 0};n.listenerCount=function(e,t){return e.listenerCount(t)};function i(e){return typeof e==="function"}function o(e){return typeof e==="number"}function a(e){return typeof e==="object"&&e!==null}function s(e){return e===void 0}},{}],25:[function(e,t,r){if(typeof Object.create==="function"){t.exports=function n(e,t){e.super_=t;e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}else{t.exports=function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype;e.prototype=new r;e.prototype.constructor=e}}},{}],26:[function(e,t,r){var n=t.exports={};var i=[];var o=false;var a;var s=-1;function l(){o=false;if(a.length){i=a.concat(i)}else{s=-1}if(i.length){u()}}function u(){if(o){return}var e=setTimeout(l);o=true;var t=i.length;while(t){a=i;i=[];while(++s<t){if(a){a[s].run()}}s=-1;t=i.length}a=null;o=false;clearTimeout(e)}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}i.push(new f(e,t));if(i.length===1&&!o){setTimeout(u,0)}};function f(e,t){this.fun=e;this.array=t}f.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=true;n.env={};n.argv=[];n.version="";n.versions={};function c(){}n.on=c;n.addListener=c;n.once=c;n.off=c;n.removeListener=c;n.removeAllListeners=c;n.emit=c;n.binding=function(e){throw new Error("process.binding is not supported")};n.cwd=function(){return"/"};n.chdir=function(e){throw new Error("process.chdir is not supported")};n.umask=function(){return 0}},{}],27:[function(e,t,r){t.exports=function n(e){return e&&typeof e==="object"&&typeof e.copy==="function"&&typeof e.fill==="function"&&typeof e.readUInt8==="function"}},{}],28:[function(e,t,r){(function(t,n){var i=/%[sdj%]/g;r.format=function(e){if(!w(e)){var t=[];for(var r=0;r<arguments.length;r++){t.push(s(arguments[r]))}return t.join(" ")}var r=1;var n=arguments;var o=n.length;var a=String(e).replace(i,function(e){if(e==="%%")return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return e}});for(var l=n[r];r<o;l=n[++r]){if(b(l)||!R(l)){a+=" "+l}else{a+=" "+s(l)}}return a};r.deprecate=function(e,i){if(A(n.process)){return function(){return r.deprecate(e,i).apply(this,arguments)}}if(t.noDeprecation===true){return e}var o=false;function a(){if(!o){if(t.throwDeprecation){throw new Error(i)}else if(t.traceDeprecation){console.trace(i)}else{console.error(i)}o=true}return e.apply(this,arguments)}return a};var o={};var a;r.debuglog=function(e){if(A(a))a=t.env.NODE_DEBUG||"";e=e.toUpperCase();if(!o[e]){if(new RegExp("\\b"+e+"\\b","i").test(a)){var n=t.pid;o[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else{o[e]=function(){}}}return o[e]};function s(e,t){var n={seen:[],stylize:u};if(arguments.length>=3)n.depth=arguments[2];if(arguments.length>=4)n.colors=arguments[3];if(v(t)){n.showHidden=t}else if(t){r._extend(n,t)}if(A(n.showHidden))n.showHidden=false;if(A(n.depth))n.depth=2;if(A(n.colors))n.colors=false;if(A(n.customInspect))n.customInspect=true;if(n.colors)n.stylize=l;return c(n,e,n.depth)}r.inspect=s;s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};s.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};function l(e,t){var r=s.styles[t];if(r){return"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m"}else{return e}}function u(e,t){return e}function f(e){var t={};e.forEach(function(e,r){t[e]=true});return t}function c(e,t,n){if(e.customInspect&&t&&k(t.inspect)&&t.inspect!==r.inspect&&!(t.constructor&&t.constructor.prototype===t)){var i=t.inspect(n,e);if(!w(i)){i=c(e,i,n)}return i}var o=d(e,t);if(o){return o}var a=Object.keys(t);var s=f(a);if(e.showHidden){a=Object.getOwnPropertyNames(t)}if(S(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0)){return h(t)}if(a.length===0){if(k(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(x(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}if(C(t)){return e.stylize(Date.prototype.toString.call(t),"date")}if(S(t)){return h(t)}}var u="",v=false,b=["{","}"];if(m(t)){v=true;b=["[","]"]}if(k(t)){var y=t.name?": "+t.name:"";u=" [Function"+y+"]"}if(x(t)){u=" "+RegExp.prototype.toString.call(t)}if(C(t)){u=" "+Date.prototype.toUTCString.call(t)}if(S(t)){u=" "+h(t)}if(a.length===0&&(!v||t.length==0)){return b[0]+u+b[1]}if(n<0){if(x(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}else{return e.stylize("[Object]","special")}}e.seen.push(t);var E;if(v){E=p(e,t,n,s,a)}else{E=a.map(function(r){return g(e,t,n,s,r,v)})}e.seen.pop();return _(E,u,b)}function d(e,t){if(A(t))return e.stylize("undefined","undefined");if(w(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(E(t))return e.stylize(""+t,"number");if(v(t))return e.stylize(""+t,"boolean");if(b(t))return e.stylize("null","null")}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,i){var o=[];for(var a=0,s=t.length;a<s;++a){if(j(t,String(a))){o.push(g(e,t,r,n,String(a),true))}else{o.push("")}}i.forEach(function(i){if(!i.match(/^\d+$/)){o.push(g(e,t,r,n,i,true))}});return o}function g(e,t,r,n,i,o){var a,s,l;l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]};if(l.get){if(l.set){s=e.stylize("[Getter/Setter]","special")}else{s=e.stylize("[Getter]","special")}}else{if(l.set){s=e.stylize("[Setter]","special")}}if(!j(n,i)){a="["+i+"]"}if(!s){if(e.seen.indexOf(l.value)<0){if(b(r)){s=c(e,l.value,null)}else{s=c(e,l.value,r-1)}if(s.indexOf("\n")>-1){if(o){s=s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2)}else{s="\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")}}}else{s=e.stylize("[Circular]","special")}}if(A(a)){if(o&&i.match(/^\d+$/)){return s}a=JSON.stringify(""+i);if(a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){a=a.substr(1,a.length-2);a=e.stylize(a,"name")}else{a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");a=e.stylize(a,"string")}}return a+": "+s}function _(e,t,r){var n=0;var i=e.reduce(function(e,t){n++;if(t.indexOf("\n")>=0)n++;return e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(i>60){return r[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]}return r[0]+t+" "+e.join(", ")+" "+r[1]}function m(e){return Array.isArray(e)}r.isArray=m;function v(e){return typeof e==="boolean"}r.isBoolean=v;function b(e){return e===null}r.isNull=b;function y(e){return e==null}r.isNullOrUndefined=y;function E(e){return typeof e==="number"}r.isNumber=E;function w(e){return typeof e==="string"}r.isString=w;function T(e){return typeof e==="symbol"}r.isSymbol=T;function A(e){return e===void 0}r.isUndefined=A;function x(e){return R(e)&&L(e)==="[object RegExp]"}r.isRegExp=x;function R(e){return typeof e==="object"&&e!==null}r.isObject=R;function C(e){return R(e)&&L(e)==="[object Date]"}r.isDate=C;function S(e){return R(e)&&(L(e)==="[object Error]"||e instanceof Error)}r.isError=S;function k(e){return typeof e==="function"}r.isFunction=k;function I(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}r.isPrimitive=I;r.isBuffer=e("./support/isBuffer");function L(e){return Object.prototype.toString.call(e)}function N(e){return e<10?"0"+e.toString(10):e.toString(10)}var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(){var e=new Date;var t=[N(e.getHours()),N(e.getMinutes()),N(e.getSeconds())].join(":");return[e.getDate(),P[e.getMonth()],t].join(" ")}r.log=function(){console.log("%s - %s",O(),r.format.apply(r,arguments))};r.inherits=e("inherits");r._extend=function(e,t){if(!t||!R(t))return e;var r=Object.keys(t);var n=r.length;while(n--){e[r[n]]=t[r[n]]}return e};function j(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}).call(this,e("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":27,_process:26,inherits:25}],29:[function(e,t,r){var n=e("../utils/common.js");var i=e("./toString.js");var o=e("./math.js");var a=e("./interpret.js");t.exports=s;function s(){this.__state=a.apply(this,arguments);if(this.__state===false){throw"Failed to interpret color arguments"}this.__state.a=this.__state.a||1}s.COMPONENTS=["r","g","b","h","s","v","hex","a"];n.extend(s.prototype,{toString:function(){return i(this)},toOriginal:function(){return this.__state.conversion.write(this)}});l(s.prototype,"r",2);l(s.prototype,"g",1);l(s.prototype,"b",0);u(s.prototype,"h");u(s.prototype,"s");u(s.prototype,"v");Object.defineProperty(s.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(s.prototype,"hex",{get:function(){if(!this.__state.space!=="HEX"){this.__state.hex=o.rgb_to_hex(this.r,this.g,this.b)}return this.__state.hex},set:function(e){this.__state.space="HEX";this.__state.hex=e}});function l(e,t,r){Object.defineProperty(e,t,{get:function(){if(this.__state.space==="RGB"){return this.__state[t]}f(this,t,r);return this.__state[t]},set:function(e){if(this.__state.space!=="RGB"){f(this,t,r);this.__state.space="RGB"}this.__state[t]=e}})}function u(e,t){Object.defineProperty(e,t,{get:function(){if(this.__state.space==="HSV")return this.__state[t];c(this);return this.__state[t]},set:function(e){if(this.__state.space!=="HSV"){c(this);this.__state.space="HSV"}this.__state[t]=e}})}function f(e,t,r){if(e.__state.space==="HEX"){e.__state[t]=o.component_from_hex(e.__state.hex,r)}else if(e.__state.space==="HSV"){n.extend(e.__state,o.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}else{throw"Corrupted color state"}}function c(e){var t=o.rgb_to_hsv(e.r,e.g,e.b);n.extend(e.__state,{s:t.s,v:t.v});if(!n.isNaN(t.h)){e.__state.h=t.h}else if(n.isUndefined(e.__state.h)){e.__state.h=0}}},{"../utils/common.js":46,"./interpret.js":30,"./math.js":31,"./toString.js":32}],30:[function(e,t,r){t.exports=n();function n(){var t=e("../utils/common.js");var r=e("./toString.js");var n,i;var o=function(){i=false;var e=arguments.length>1?t.toArray(arguments):arguments[0];t.each(a,function(r){if(r.litmus(e)){t.each(r.conversions,function(r,o){n=r.read(e);if(i===false&&n!==false){i=n;n.conversionName=o;n.conversion=r;return t.BREAK}});return t.BREAK}});return i};var a=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);if(t===null)return false;return{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString())}},write:r},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);if(t===null)return false;return{space:"HEX",hex:parseInt("0x"+t[1].toString())}},write:r},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);if(t===null)return false;return{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:r},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);if(t===null)return false;return{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:r}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){if(e.length!=3)return false;return{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){if(e.length!=4)return false;return{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){if(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a)){return{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}}return false},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){if(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)){return{space:"RGB",r:e.r,g:e.g,b:e.b}}return false},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){if(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a)){return{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}}return false},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){if(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)){return{space:"HSV",h:e.h,s:e.s,v:e.v}}return false},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return o}},{"../utils/common.js":46,"./toString.js":32}],31:[function(e,t,r){t.exports=n();function n(){var e;return{hsv_to_rgb:function(e,t,r){var n=Math.floor(e/60)%6;var i=e/60-Math.floor(e/60);var o=r*(1-t);var a=r*(1-i*t);var s=r*(1-(1-i)*t);var l=[[r,s,o],[a,r,o],[o,r,s],[o,a,r],[s,o,r],[r,o,a]][n];return{r:l[0]*255,g:l[1]*255,b:l[2]*255}},rgb_to_hsv:function(e,t,r){var n=Math.min(e,t,r),i=Math.max(e,t,r),o=i-n,a,s;if(i!=0){s=o/i}else{return{h:NaN,s:0,v:0}}if(e==i){a=(t-r)/o}else if(t==i){a=2+(r-e)/o}else{a=4+(e-t)/o}a/=6;if(a<0){a+=1}return{h:a*360,s:s,v:i/255}},rgb_to_hex:function(e,t,r){var n=this.hex_with_component(0,2,e);n=this.hex_with_component(n,1,t);n=this.hex_with_component(n,0,r);return n},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(t,r,n){return n<<(e=r*8)|t&~(255<<e)}}}},{}],32:[function(e,t,r){var n=e("../utils/common.js");t.exports=i;function i(e){if(e.a==1||n.isUndefined(e.a)){var t=e.hex.toString(16);while(t.length<6){t="0"+t}return"#"+t}else{return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}},{"../utils/common.js":46}],33:[function(e,t,r){var n=e("./Controller.js");var i=e("../utils/common.js");var o=e("../dom/dom.js");t.exports=a;function a(e,t){a.superclass.call(this,e,t);var r=this;this.__prev=this.getValue();this.__checkbox=document.createElement("input");this.__checkbox.setAttribute("type","checkbox");o.bind(this.__checkbox,"change",n,false);this.domElement.appendChild(this.__checkbox);this.updateDisplay();function n(){r.setValue(!r.__prev)}}a.superclass=n;i.extend(a.prototype,n.prototype,{setValue:function(e){var t=a.superclass.prototype.setValue.call(this,e);if(this.__onFinishChange){this.__onFinishChange.call(this,this.getValue())}this.__prev=this.getValue();return t},updateDisplay:function(){if(this.getValue()===true){this.__checkbox.setAttribute("checked","checked");this.__checkbox.checked=true}else{this.__checkbox.checked=false}return a.superclass.prototype.updateDisplay.call(this)}})},{"../dom/dom.js":44,"../utils/common.js":46,"./Controller.js":35}],34:[function(e,t,r){var n=e("./Controller.js");var i=e("../utils/common.js");var o=e("../dom/dom.js");var a=e("../color/Color.js");var s=e("../color/interpret.js");t.exports=l;function l(e,t){l.superclass.call(this,e,t);this.__color=new a(this.getValue());this.__temp=new a(0);var r=this;this.domElement=document.createElement("div");o.makeSelectable(this.domElement,false);this.__selector=document.createElement("div");this.__selector.className="selector";this.__saturation_field=document.createElement("div");this.__saturation_field.className="saturation-field";this.__field_knob=document.createElement("div");this.__field_knob.className="field-knob";this.__field_knob_border="2px solid ";this.__hue_knob=document.createElement("div");this.__hue_knob.className="hue-knob";this.__hue_field=document.createElement("div");this.__hue_field.className="hue-field";this.__input=document.createElement("input");this.__input.type="text";this.__input_textShadow="0 1px 1px ";o.bind(this.__input,"keydown",function(e){if(e.keyCode===13){h.call(this)}});o.bind(this.__input,"blur",h);o.bind(this.__selector,"mousedown",function(e){o.addClass(this,"drag").bind(window,"mouseup",function(e){o.removeClass(r.__selector,"drag")})});var n=document.createElement("div");i.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"});i.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1});i.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1});i.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"});i.extend(n.style,{width:"100%",height:"100%",background:"none"});f(n,"top","rgba(0,0,0,0)","#000");i.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"});c(this.__hue_field);i.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"});o.bind(this.__saturation_field,"mousedown",u);o.bind(this.__field_knob,"mousedown",u);o.bind(this.__hue_field,"mousedown",function(e){_(e);o.bind(window,"mousemove",_);o.bind(window,"mouseup",p)});function u(e){g(e);o.bind(window,"mousemove",g);o.bind(window,"mouseup",d)}function d(){o.unbind(window,"mousemove",g);o.unbind(window,"mouseup",d)}function h(){var e=s(this.value);if(e!==false){r.__color.__state=e;r.setValue(r.__color.toOriginal())}else{this.value=r.__color.toString()}}function p(){o.unbind(window,"mousemove",_);o.unbind(window,"mouseup",p)}this.__saturation_field.appendChild(n);this.__selector.appendChild(this.__field_knob);this.__selector.appendChild(this.__saturation_field);this.__selector.appendChild(this.__hue_field);this.__hue_field.appendChild(this.__hue_knob);this.domElement.appendChild(this.__input);this.domElement.appendChild(this.__selector);this.updateDisplay();function g(e){e.preventDefault();var t=o.getWidth(r.__saturation_field);var n=o.getOffset(r.__saturation_field);var i=(e.clientX-n.left+document.body.scrollLeft)/t;var a=1-(e.clientY-n.top+document.body.scrollTop)/t;if(a>1)a=1;else if(a<0)a=0;if(i>1)i=1;else if(i<0)i=0;r.__color.v=a;r.__color.s=i;r.setValue(r.__color.toOriginal());return false}function _(e){e.preventDefault();var t=o.getHeight(r.__hue_field);var n=o.getOffset(r.__hue_field);var i=1-(e.clientY-n.top+document.body.scrollTop)/t;if(i>1)i=1;else if(i<0)i=0;r.__color.h=i*360;r.setValue(r.__color.toOriginal());return false}}l.superclass=n;i.extend(l.prototype,n.prototype,{updateDisplay:function(){var e=s(this.getValue());if(e!==false){var t=false;i.each(a.COMPONENTS,function(r){if(!i.isUndefined(e[r])&&!i.isUndefined(this.__color.__state[r])&&e[r]!==this.__color.__state[r]){t=true;return{}}},this);if(t){i.extend(this.__color.__state,e)}}i.extend(this.__temp.__state,this.__color.__state);this.__temp.a=1;var r=this.__color.v<.5||this.__color.s>.5?255:0;var n=255-r;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+r+","+r+","+r+")"});this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px";this.__temp.s=1;this.__temp.v=1;f(this.__saturation_field,"left","#fff",this.__temp.toString());i.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+r+","+r+","+r+")",textShadow:this.__input_textShadow+"rgba("+n+","+n+","+n+",.7)"})}});var u=["-moz-","-o-","-webkit-","-ms-",""];function f(e,t,r,n){e.style.background="";i.each(u,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+r+" 0%, "+n+" 100%); "})}function c(e){e.style.background="";e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);";e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}},{"../color/Color.js":29,"../color/interpret.js":30,"../dom/dom.js":44,"../utils/common.js":46,"./Controller.js":35}],35:[function(e,t,r){var n=e("../utils/common.js");var i=e("../utils/escapeHtml.js");t.exports=o;function o(e,t){this.initialValue=e[t];this.domElement=document.createElement("div");this.object=e;this.property=t;this.__onChange=undefined;this.__onFinishChange=undefined}n.extend(o.prototype,{onChange:function(e){this.__onChange=e;return this},onFinishChange:function(e){this.__onFinishChange=e;return this},setValue:function(e){this.object[this.property]=e;if(this.__onChange){this.__onChange.call(this,e)}this.updateDisplay();return this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}})},{"../utils/common.js":46,"../utils/escapeHtml.js":48}],36:[function(e,t,r){var n=e("./Controller.js");var i=e("../utils/common.js");var o=e("../dom/dom.js");t.exports=a;function a(e,t,r){a.superclass.call(this,e,t);var n=this;this.__button=document.createElement("div");this.__button.innerHTML=r===undefined?"Fire":r;o.bind(this.__button,"click",function(e){e.preventDefault();n.fire();return false});o.addClass(this.__button,"button");this.domElement.appendChild(this.__button)}a.superclass=n;i.extend(a.prototype,n.prototype,{fire:function(){if(this.__onChange){this.__onChange.call(this)}this.getValue().call(this.object);if(this.__onFinishChange){this.__onFinishChange.call(this,this.getValue())}}})},{"../dom/dom.js":44,"../utils/common.js":46,"./Controller.js":35}],37:[function(e,t,r){var n=e("./Controller.js");var i=e("../utils/common.js");t.exports=o;function o(e,t,r){o.superclass.call(this,e,t);r=r||{};this.__min=r.min;this.__max=r.max;this.__step=r.step;if(i.isUndefined(this.__step)){if(this.initialValue==0){this.__impliedStep=1}else{this.__impliedStep=Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10}}else{this.__impliedStep=this.__step}this.__precision=a(this.__impliedStep)}o.superclass=n;i.extend(o.prototype,n.prototype,{setValue:function(e){if(this.__min!==undefined&&e<this.__min){e=this.__min}else if(this.__max!==undefined&&e>this.__max){e=this.__max}if(this.__step!==undefined&&e%this.__step!=0){e=Math.round(e/this.__step)*this.__step}return o.superclass.prototype.setValue.call(this,e)},min:function(e){this.__min=e;return this},max:function(e){this.__max=e;return this},step:function(e){
this.__step=e;this.__impliedStep=e;this.__precision=a(e);return this}});function a(e){e=e.toString();if(e.indexOf(".")>-1){return e.length-e.indexOf(".")-1}else{return 0}}},{"../utils/common.js":46,"./Controller.js":35}],38:[function(e,t,r){var n=e("./NumberController.js");var i=e("../utils/common.js");var o=e("../dom/dom.js");t.exports=a;function a(e,t,r){this.__truncationSuspended=false;a.superclass.call(this,e,t,r);var n=this;var s;this.__input=document.createElement("input");this.__input.setAttribute("type","text");o.bind(this.__input,"change",l);o.bind(this.__input,"blur",u);o.bind(this.__input,"mousedown",f);o.bind(this.__input,"keydown",function(e){if(e.keyCode===13){n.__truncationSuspended=true;this.blur();n.__truncationSuspended=false}});function l(){var e=parseFloat(n.__input.value);if(!i.isNaN(e))n.setValue(e)}function u(){l();if(n.__onFinishChange){n.__onFinishChange.call(n,n.getValue())}}function f(e){o.bind(window,"mousemove",c);o.bind(window,"mouseup",d);s=e.clientY}function c(e){var t=s-e.clientY;n.setValue(n.getValue()+t*n.__impliedStep);s=e.clientY}function d(){o.unbind(window,"mousemove",c);o.unbind(window,"mouseup",d)}this.updateDisplay();this.domElement.appendChild(this.__input)}a.superclass=n;i.extend(a.prototype,n.prototype,{updateDisplay:function(){this.__input.value=this.__truncationSuspended?this.getValue():s(this.getValue(),this.__precision);return a.superclass.prototype.updateDisplay.call(this)}});function s(e,t){var r=Math.pow(10,t);return Math.round(e*r)/r}},{"../dom/dom.js":44,"../utils/common.js":46,"./NumberController.js":37}],39:[function(e,t,r){var n=e("./NumberController.js");var i=e("../utils/common.js");var o=e("../dom/dom.js");var a=e("../utils/css.js");var s="/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n.slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}";t.exports=l;function l(e,t,r,n,i){l.superclass.call(this,e,t,{min:r,max:n,step:i});var a=this;this.__background=document.createElement("div");this.__foreground=document.createElement("div");o.bind(this.__background,"mousedown",s);o.addClass(this.__background,"slider");o.addClass(this.__foreground,"slider-fg");function s(e){o.bind(window,"mousemove",f);o.bind(window,"mouseup",c);f(e)}function f(e){e.preventDefault();var t=o.getOffset(a.__background);var r=o.getWidth(a.__background);a.setValue(u(e.clientX,t.left,t.left+r,a.__min,a.__max));return false}function c(){o.unbind(window,"mousemove",f);o.unbind(window,"mouseup",c);if(a.__onFinishChange){a.__onFinishChange.call(a,a.getValue())}}this.updateDisplay();this.__background.appendChild(this.__foreground);this.domElement.appendChild(this.__background)}l.superclass=n;l.useDefaultStyles=function(){a.inject(s)};i.extend(l.prototype,n.prototype,{updateDisplay:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);this.__foreground.style.width=e*100+"%";return l.superclass.prototype.updateDisplay.call(this)}});function u(e,t,r,n,i){return n+(i-n)*((e-t)/(r-t))}},{"../dom/dom.js":44,"../utils/common.js":46,"../utils/css.js":47,"./NumberController.js":37}],40:[function(e,t,r){var n=e("./Controller.js");var i=e("../dom/dom.js");var o=e("../utils/common.js");t.exports=a;function a(e,t,r){a.superclass.call(this,e,t);var n=this;this.__select=document.createElement("select");if(o.isArray(r)){var s={};o.each(r,function(e){s[e]=e});r=s}o.each(r,function(e,t){var r=document.createElement("option");r.innerHTML=t;r.setAttribute("value",e);n.__select.appendChild(r)});this.updateDisplay();i.bind(this.__select,"change",function(){var e=this.options[this.selectedIndex].value;n.setValue(e)});this.domElement.appendChild(this.__select)}a.superclass=n;o.extend(a.prototype,n.prototype,{setValue:function(e){var t=a.superclass.prototype.setValue.call(this,e);if(this.__onFinishChange){this.__onFinishChange.call(this,this.getValue())}return t},updateDisplay:function(){this.__select.value=this.getValue();return a.superclass.prototype.updateDisplay.call(this)}})},{"../dom/dom.js":44,"../utils/common.js":46,"./Controller.js":35}],41:[function(e,t,r){var n=e("./Controller.js");var i=e("../dom/dom.js");var o=e("../utils/common.js");t.exports=a;function a(e,t){a.superclass.call(this,e,t);var r=this;this.__input=document.createElement("input");this.__input.setAttribute("type","text");i.bind(this.__input,"keyup",n);i.bind(this.__input,"change",n);i.bind(this.__input,"blur",o);i.bind(this.__input,"keydown",function(e){if(e.keyCode===13){this.blur()}});function n(){r.setValue(r.__input.value)}function o(){if(r.__onFinishChange){r.__onFinishChange.call(r,r.getValue())}}this.updateDisplay();this.domElement.appendChild(this.__input)}a.superclass=n;o.extend(a.prototype,n.prototype,{updateDisplay:function(){if(!i.isActive(this.__input)){this.__input.value=this.getValue()}return a.superclass.prototype.updateDisplay.call(this)}})},{"../dom/dom.js":44,"../utils/common.js":46,"./Controller.js":35}],42:[function(e,t,r){var n=e("./OptionController.js");var i=e("./NumberControllerBox.js");var o=e("./NumberControllerSlider.js");var a=e("./StringController.js");var s=e("./FunctionController.js");var l=e("./BooleanController.js");var u=e("../utils/common.js");t.exports=f;function f(e,t){var r=e[t];if(u.isArray(arguments[2])||u.isObject(arguments[2])){return new n(e,t,arguments[2])}if(u.isNumber(r)){if(u.isNumber(arguments[2])&&u.isNumber(arguments[3])){return new o(e,t,arguments[2],arguments[3])}else{return new i(e,t,{min:arguments[2],max:arguments[3]})}}if(u.isString(r)){return new a(e,t)}if(u.isFunction(r)){return new s(e,t,"")}if(u.isBoolean(r)){return new l(e,t)}}},{"../utils/common.js":46,"./BooleanController.js":33,"./FunctionController.js":36,"./NumberControllerBox.js":38,"./NumberControllerSlider.js":39,"./OptionController.js":40,"./StringController.js":41}],43:[function(e,t,r){var n=e("../utils/common.js");var i=e("./dom.js");t.exports=o;function o(){this.backgroundElement=document.createElement("div");n.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"});i.makeFullscreen(this.backgroundElement);this.backgroundElement.style.position="fixed";this.domElement=document.createElement("div");n.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"});document.body.appendChild(this.backgroundElement);document.body.appendChild(this.domElement);var e=this;i.bind(this.backgroundElement,"click",function(){e.hide()})}o.prototype.show=function(){var e=this;this.backgroundElement.style.display="block";this.domElement.style.display="block";this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)";this.layout();n.defer(function(){e.backgroundElement.style.opacity=1;e.domElement.style.opacity=1;e.domElement.style.webkitTransform="scale(1)"})};o.prototype.hide=function(){var e=this;var t=function(){e.domElement.style.display="none";e.backgroundElement.style.display="none";i.unbind(e.domElement,"webkitTransitionEnd",t);i.unbind(e.domElement,"transitionend",t);i.unbind(e.domElement,"oTransitionEnd",t)};i.bind(this.domElement,"webkitTransitionEnd",t);i.bind(this.domElement,"transitionend",t);i.bind(this.domElement,"oTransitionEnd",t);this.backgroundElement.style.opacity=0;this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)"};o.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-i.getWidth(this.domElement)/2+"px";this.domElement.style.top=window.innerHeight/2-i.getHeight(this.domElement)/2+"px"};function a(e){console.log(e)}},{"../utils/common.js":46,"./dom.js":44}],44:[function(e,t,r){var n=e("../utils/common.js");var i={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]};var o={};n.each(i,function(e,t){n.each(e,function(e){o[e]=t})});var a=/(\d+(\.\d+)?)px/;function s(e){if(e==="0"||n.isUndefined(e))return 0;var t=e.match(a);if(!n.isNull(t)){return parseFloat(t[1])}return 0}var l={makeSelectable:function(e,t){if(e===undefined||e.style===undefined)return;e.onselectstart=t?function(){return false}:function(){};e.style.MozUserSelect=t?"auto":"none";e.style.KhtmlUserSelect=t?"auto":"none";e.unselectable=t?"on":"off"},makeFullscreen:function(e,t,r){if(n.isUndefined(t))t=true;if(n.isUndefined(r))r=true;e.style.position="absolute";if(t){e.style.left=0;e.style.right=0}if(r){e.style.top=0;e.style.bottom=0}},fakeEvent:function(e,t,r,i){r=r||{};var a=o[t];if(!a){throw new Error("Event type "+t+" not supported.")}var s=document.createEvent(a);switch(a){case"MouseEvents":var l=r.x||r.clientX||0;var u=r.y||r.clientY||0;s.initMouseEvent(t,r.bubbles||false,r.cancelable||true,window,r.clickCount||1,0,0,l,u,false,false,false,false,0,null);break;case"KeyboardEvents":var f=s.initKeyboardEvent||s.initKeyEvent;n.defaults(r,{cancelable:true,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:undefined,charCode:undefined});f(t,r.bubbles||false,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:s.initEvent(t,r.bubbles||false,r.cancelable||true);break}n.defaults(s,i);e.dispatchEvent(s)},bind:function(e,t,r,n){n=n||false;if(e.addEventListener)e.addEventListener(t,r,n);else if(e.attachEvent)e.attachEvent("on"+t,r);return l},unbind:function(e,t,r,n){n=n||false;if(e.removeEventListener)e.removeEventListener(t,r,n);else if(e.detachEvent)e.detachEvent("on"+t,r);return l},addClass:function(e,t){if(e.className===undefined){e.className=t}else if(e.className!==t){var r=e.className.split(/ +/);if(r.indexOf(t)==-1){r.push(t);e.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")}}return l},removeClass:function(e,t){if(t){if(e.className===undefined){}else if(e.className===t){e.removeAttribute("class")}else{var r=e.className.split(/ +/);var n=r.indexOf(t);if(n!=-1){r.splice(n,1);e.className=r.join(" ")}}}else{e.className=undefined}return l},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||false},getWidth:function(e){var t=getComputedStyle(e);return s(t["border-left-width"])+s(t["border-right-width"])+s(t["padding-left"])+s(t["padding-right"])+s(t["width"])},getHeight:function(e){var t=getComputedStyle(e);return s(t["border-top-width"])+s(t["border-bottom-width"])+s(t["padding-top"])+s(t["padding-bottom"])+s(t["height"])},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent){do{t.left+=e.offsetLeft;t.top+=e.offsetTop}while(e=e.offsetParent)}return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};t.exports=l},{"../utils/common.js":46}],45:[function(e,t,r){var n=e("../utils/css.js");var i='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>';var o=".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid rgba(0, 0, 0, 0); }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name,\n  .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: black url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2fa1d6; }\n    .dg .cr.number input[type=text] {\n      color: #2fa1d6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.function:hover, .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2fa1d6; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n";var a=e("../controllers/factory.js");var s=e("../controllers/Controller.js");var l=e("../controllers/BooleanController.js");var u=e("../controllers/FunctionController.js");var f=e("../controllers/NumberControllerBox.js");var c=e("../controllers/NumberControllerSlider.js");var d=e("../controllers/ColorController.js");var h=e("../utils/requestAnimationFrame.js");var p=e("../dom/CenteredDiv.js");var g=e("../dom/dom.js");var _=e("../utils/common.js");t.exports=m();function m(){n.inject(o);var e="dg";var t=72;var r=20;var m="Default";var v=function(){try{return"localStorage"in window&&window["localStorage"]!==null}catch(e){return false}}();var b;var y=true;var E;var w=false;var T=[];var A=function(t){var r=this;this.domElement=document.createElement("div");this.__ul=document.createElement("ul");this.domElement.appendChild(this.__ul);g.addClass(this.domElement,e);this.__folders={};this.__controllers=[];this.__rememberedObjects=[];this.__rememberedObjectIndecesToControllers=[];this.__listening=[];t=t||{};t=_.defaults(t,{autoPlace:true,width:A.DEFAULT_WIDTH});t=_.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace});if(!_.isUndefined(t.load)){if(t.preset)t.load.preset=t.preset}else{t.load={preset:m}}if(_.isUndefined(t.parent)&&t.hideable){T.push(this)}t.resizable=_.isUndefined(t.parent)&&t.resizable;if(t.autoPlace&&_.isUndefined(t.scrollable)){t.scrollable=true}var n=v&&localStorage.getItem(k(this,"isLocal"))==="true";var i;Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){if(r.parent){return r.getRoot().preset}else{return t.load.preset}},set:function(e){if(r.parent){r.getRoot().preset=e}else{t.load.preset=e}j(this);r.revert()}},width:{get:function(){return t.width},set:function(e){t.width=e;N(r,e)}},name:{get:function(){return t.name},set:function(e){t.name=e;if(a){a.innerHTML=t.name}}},closed:{get:function(){return t.closed},set:function(e){t.closed=e;if(t.closed){g.addClass(r.__ul,A.CLASS_CLOSED)}else{g.removeClass(r.__ul,A.CLASS_CLOSED)}this.onResize();if(r.__closeButton){r.__closeButton.innerHTML=e?A.TEXT_OPEN:A.TEXT_CLOSED}}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return n},set:function(e){if(v){n=e;if(e){g.bind(window,"unload",i)}else{g.unbind(window,"unload",i)}localStorage.setItem(k(r,"isLocal"),e)}}}});if(_.isUndefined(t.parent)){t.closed=false;g.addClass(this.domElement,A.CLASS_MAIN);g.makeSelectable(this.domElement,false);if(v){if(n){r.useLocalStorage=true;var o=localStorage.getItem(k(this,"gui"));if(o){t.load=JSON.parse(o)}}}this.__closeButton=document.createElement("div");this.__closeButton.innerHTML=A.TEXT_CLOSED;g.addClass(this.__closeButton,A.CLASS_CLOSE_BUTTON);this.domElement.appendChild(this.__closeButton);g.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{if(t.closed===undefined){t.closed=true}var a=document.createTextNode(t.name);g.addClass(a,"controller-name");var s=R(r,a);var l=function(e){e.preventDefault();r.closed=!r.closed;return false};g.addClass(this.__ul,A.CLASS_CLOSED);g.addClass(s,"title");g.bind(s,"click",l);if(!t.closed){this.closed=false}}if(t.autoPlace){if(_.isUndefined(t.parent)){if(y){E=document.createElement("div");g.addClass(E,e);g.addClass(E,A.CLASS_AUTO_PLACE_CONTAINER);document.body.appendChild(E);y=false}E.appendChild(this.domElement);g.addClass(this.domElement,A.CLASS_AUTO_PLACE)}if(!this.parent)N(r,t.width)}g.bind(window,"resize",function(){r.onResize()});g.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()});g.bind(this.__ul,"transitionend",function(){r.onResize()});g.bind(this.__ul,"oTransitionEnd",function(){r.onResize()});this.onResize();if(t.resizable){L(this)}i=function(){if(v&&localStorage.getItem(k(r,"isLocal"))==="true"){localStorage.setItem(k(r,"gui"),JSON.stringify(r.getSaveObject()))}};this.saveToLocalStorageIfPossible=i;var u=r.getRoot();function f(){var e=r.getRoot();e.width+=1;_.defer(function(){e.width-=1})}if(!t.parent){f()}};A.toggleHide=function(){w=!w;_.each(T,function(e){e.domElement.style.zIndex=w?-999:999;e.domElement.style.opacity=w?0:1})};A.CLASS_AUTO_PLACE="a";A.CLASS_AUTO_PLACE_CONTAINER="ac";A.CLASS_MAIN="main";A.CLASS_CONTROLLER_ROW="cr";A.CLASS_TOO_TALL="taller-than-window";A.CLASS_CLOSED="closed";A.CLASS_CLOSE_BUTTON="close-button";A.CLASS_DRAG="drag";A.DEFAULT_WIDTH=245;A.TEXT_CLOSED="Close Controls";A.TEXT_OPEN="Open Controls";g.bind(window,"keydown",function(e){if(document.activeElement.type!=="text"&&(e.which===t||e.keyCode==t)){A.toggleHide()}},false);_.extend(A.prototype,{add:function(e,t){return x(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return x(this,e,t,{color:true})},remove:function(e){this.__ul.removeChild(e.__li);this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;_.defer(function(){t.onResize()})},destroy:function(){if(this.autoPlace){E.removeChild(this.domElement)}},addFolder:function(e){if(this.__folders[e]!==undefined){throw new Error("You already have a folder in this GUI by the"+' name "'+e+'"')}var t={name:e,parent:this};t.autoPlace=this.autoPlace;if(this.load&&this.load.folders&&this.load.folders[e]){t.closed=this.load.folders[e].closed;t.load=this.load.folders[e]}var r=new A(t);this.__folders[e]=r;var n=R(this,r.domElement);g.addClass(n,"folder");return r},removeFolder:function(e){var t=this.__folders[e];if(!t){return}delete this.__folders[e];var r=t.__controllers;for(var n=0;n<r.length;++n){r[n].remove()}var i=Object.keys(t.__folders||{});for(n=0;n<i.length;++n){var o=i[n];t.removeFolder(o)}var a=t.domElement.parentNode;a.parentNode.removeChild(a)},open:function(){this.closed=false},update:function(){D(this)},close:function(){this.closed=true},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=g.getOffset(e.__ul).top;var n=0;_.each(e.__ul.childNodes,function(t){if(!(e.autoPlace&&t===e.__save_row))n+=g.getHeight(t)});if(window.innerHeight-t-r<n){g.addClass(e.domElement,A.CLASS_TOO_TALL);e.__ul.style.height=window.innerHeight-t-r+"px"}else{g.removeClass(e.domElement,A.CLASS_TOO_TALL);e.__ul.style.height="auto"}}if(e.__resize_handle){_.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"})}if(e.__closeButton){e.__closeButton.style.width=e.width+"px"}},remember:function(){if(_.isUndefined(b)){b=new p;b.domElement.innerHTML=i}if(this.parent){throw new Error("You can only call remember on a top level GUI.")}var e=this;_.each(Array.prototype.slice.call(arguments),function(t){if(e.__rememberedObjects.length==0){I(e)}if(e.__rememberedObjects.indexOf(t)==-1){e.__rememberedObjects.push(t)}});if(this.autoPlace){N(this,this.width)}},getRoot:function(){var e=this;while(e.parent){e=e.parent}return e},getSaveObject:function(){var e=this.load;e.closed=this.closed;if(this.__rememberedObjects.length>0){e.preset=this.preset;if(!e.remembered){e.remembered={}}e.remembered[this.preset]=P(this)}e.folders={};_.each(this.__folders,function(t,r){e.folders[r]=t.getSaveObject()});return e},save:function(){if(!this.load.remembered){this.load.remembered={}}this.load.remembered[this.preset]=P(this);M(this,false);this.saveToLocalStorageIfPossible()},saveAs:function(e){if(!this.load.remembered){this.load.remembered={};this.load.remembered[m]=P(this,true)}this.load.remembered[e]=P(this);this.preset=e;O(this,e,true);this.saveToLocalStorageIfPossible()},revert:function(e){_.each(this.__controllers,function(t){if(!this.getRoot().load.remembered){t.setValue(t.initialValue)}else{S(e||this.getRoot(),t)}},this);_.each(this.__folders,function(e){e.revert(e)});if(!e){M(this.getRoot(),false)}},listen:function(e){var t=this.__listening.length==0;this.__listening.push(e);if(t)U(this.__listening)}});function x(e,t,r,n){if(t[r]===undefined){throw new Error("Object "+t+' has no property "'+r+'"')}var i;if(n.color){i=new d(t,r)}else{var o=[t,r].concat(n.factoryArgs);i=a.apply(e,o)}if(n.before instanceof s){n.before=n.before.__li}S(e,i);g.addClass(i.domElement,"c");var l=document.createElement("span");g.addClass(l,"property-name");l.innerHTML=i.property;var u=document.createElement("div");u.appendChild(l);u.appendChild(i.domElement);var f=R(e,u,n.before);g.addClass(f,A.CLASS_CONTROLLER_ROW);g.addClass(f,typeof i.getValue());C(e,f,i);e.__controllers.push(i);return i}function R(e,t,r){var n=document.createElement("li");if(t)n.appendChild(t);if(r){e.__ul.insertBefore(n,params.before)}else{e.__ul.appendChild(n)}e.onResize();return n}function C(e,t,r){r.__li=t;r.__gui=e;_.extend(r,{options:function(t){if(arguments.length>1){r.remove();return x(e,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[_.toArray(arguments)]})}if(_.isArray(t)||_.isObject(t)){r.remove();return x(e,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[t]})}},name:function(e){r.__li.firstElementChild.firstElementChild.innerHTML=e;return r},listen:function(){r.__gui.listen(r);return r},remove:function(){r.__gui.remove(r);return r}});if(r instanceof c){var n=new f(r.object,r.property,{min:r.__min,max:r.__max,step:r.__step});_.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=r[e];var i=n[e];r[e]=n[e]=function(){var e=Array.prototype.slice.call(arguments);t.apply(r,e);return i.apply(n,e)}});g.addClass(t,"has-slider");r.domElement.insertBefore(n.domElement,r.domElement.firstElementChild)}else if(r instanceof f){var i=function(t){if(_.isNumber(r.__min)&&_.isNumber(r.__max)){r.remove();return x(e,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[r.__min,r.__max,r.__step]})}return t};r.min=_.compose(i,r.min);r.max=_.compose(i,r.max)}else if(r instanceof l){g.bind(t,"click",function(){g.fakeEvent(r.__checkbox,"click")});g.bind(r.__checkbox,"click",function(e){e.stopPropagation()})}else if(r instanceof u){g.bind(t,"click",function(){g.fakeEvent(r.__button,"click")});g.bind(t,"mouseover",function(){g.addClass(r.__button,"hover")});g.bind(t,"mouseout",function(){g.removeClass(r.__button,"hover")})}else if(r instanceof d){g.addClass(t,"color");r.updateDisplay=_.compose(function(e){t.style.borderLeftColor=r.__color.toString();return e},r.updateDisplay);r.updateDisplay()}r.setValue=_.compose(function(t){if(e.getRoot().__preset_select&&r.isModified()){M(e.getRoot(),true)}return t},r.setValue)}function S(e,t){var r=e.getRoot();var n=r.__rememberedObjects.indexOf(t.object);if(n!=-1){var i=r.__rememberedObjectIndecesToControllers[n];if(i===undefined){i={};r.__rememberedObjectIndecesToControllers[n]=i}i[t.property]=t;if(r.load&&r.load.remembered){var o=r.load.remembered;var a;if(o[e.preset]){a=o[e.preset]}else if(o[m]){a=o[m]}else{return}if(a[n]&&a[n][t.property]!==undefined){var s=a[n][t.property];t.initialValue=s;t.setValue(s)}}}}function k(e,t){return document.location.href+"."+t}function I(e){var t=e.__save_row=document.createElement("li");g.addClass(e.domElement,"has-save");e.__ul.insertBefore(t,e.__ul.firstChild);g.addClass(t,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;";g.addClass(r,"button gears");var n=document.createElement("span");n.innerHTML="Save";g.addClass(n,"button");g.addClass(n,"save");var i=document.createElement("span");i.innerHTML="New";g.addClass(i,"button");g.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert";g.addClass(o,"button");g.addClass(o,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered){_.each(e.load.remembered,function(t,r){O(e,r,r==e.preset)})}else{O(e,m,false)}g.bind(a,"change",function(){
for(var t=0;t<e.__preset_select.length;t++){e.__preset_select[t].innerHTML=e.__preset_select[t].value}e.preset=this.value});t.appendChild(a);t.appendChild(r);t.appendChild(n);t.appendChild(i);t.appendChild(o);if(v){var s=document.getElementById("dg-save-locally");var l=document.getElementById("dg-local-explain");s.style.display="block";var u=document.getElementById("dg-local-storage");if(localStorage.getItem(k(e,"isLocal"))==="true"){u.setAttribute("checked","checked")}function f(){l.style.display=e.useLocalStorage?"block":"none"}f();g.bind(u,"change",function(){e.useLocalStorage=!e.useLocalStorage;f()})}var c=document.getElementById("dg-new-constructor");g.bind(c,"keydown",function(e){if(e.metaKey&&(e.which===67||e.keyCode==67)){b.hide()}});g.bind(r,"click",function(){c.innerHTML=JSON.stringify(e.getSaveObject(),undefined,2);b.show();c.focus();c.select()});g.bind(n,"click",function(){e.save()});g.bind(i,"click",function(){var t=prompt("Enter a new preset name.");if(t)e.saveAs(t)});g.bind(o,"click",function(){e.revert()})}function L(e){e.__resize_handle=document.createElement("div");_.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var t;g.bind(e.__resize_handle,"mousedown",r);g.bind(e.__closeButton,"mousedown",r);e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild);function r(r){r.preventDefault();t=r.clientX;g.addClass(e.__closeButton,A.CLASS_DRAG);g.bind(window,"mousemove",n);g.bind(window,"mouseup",i);return false}function n(r){r.preventDefault();e.width+=t-r.clientX;e.onResize();t=r.clientX;return false}function i(){g.removeClass(e.__closeButton,A.CLASS_DRAG);g.unbind(window,"mousemove",n);g.unbind(window,"mouseup",i)}}function N(e,t){e.domElement.style.width=t+"px";if(e.__save_row&&e.autoPlace){e.__save_row.style.width=t+"px"}if(e.__closeButton){e.__closeButton.style.width=t+"px"}}function P(e,t){var r={};_.each(e.__rememberedObjects,function(n,i){var o={};var a=e.__rememberedObjectIndecesToControllers[i];_.each(a,function(e,r){o[r]=t?e.initialValue:e.getValue()});r[i]=o});return r}function O(e,t,r){var n=document.createElement("option");n.innerHTML=t;n.value=t;e.__preset_select.appendChild(n);if(r){e.__preset_select.selectedIndex=e.__preset_select.length-1}}function j(e){for(var t=0;t<e.__preset_select.length;t++){if(e.__preset_select[t].value==e.preset){e.__preset_select.selectedIndex=t}}}function M(e,t){var r=e.__preset_select[e.__preset_select.selectedIndex];if(t){r.innerHTML=r.value+"*"}else{r.innerHTML=r.value}}function U(e){if(e.length!=0){h(function(){U(e)})}_.each(e,function(e){e.updateDisplay()})}function D(e){F(e.__controllers);Object.keys(e.__folders).forEach(function(t){D(e.__folders[t])})}function F(e){for(var t in e){e[t].updateDisplay()}}return A}},{"../controllers/BooleanController.js":33,"../controllers/ColorController.js":34,"../controllers/Controller.js":35,"../controllers/FunctionController.js":36,"../controllers/NumberControllerBox.js":38,"../controllers/NumberControllerSlider.js":39,"../controllers/factory.js":42,"../dom/CenteredDiv.js":43,"../dom/dom.js":44,"../utils/common.js":46,"../utils/css.js":47,"../utils/requestAnimationFrame.js":49}],46:[function(e,t,r){t.exports=n();function n(){var e=Array.prototype.forEach;var t=Array.prototype.slice;return{BREAK:{},extend:function(e){this.each(t.call(arguments,1),function(t){for(var r in t)if(!this.isUndefined(t[r]))e[r]=t[r]},this);return e},defaults:function(e){this.each(t.call(arguments,1),function(t){for(var r in t)if(this.isUndefined(e[r]))e[r]=t[r]},this);return e},compose:function(){var e=t.call(arguments);return function(){var r=t.call(arguments);for(var n=e.length-1;n>=0;n--){r=[e[n].apply(this,r)]}return r[0]}},each:function(t,r,n){if(!t)return;if(e&&t.forEach&&t.forEach===e){t.forEach(r,n)}else if(t.length===t.length+0){for(var i=0,o=t.length;i<o;i++)if(i in t&&r.call(n,t[i],i)===this.BREAK)return}else{for(var i in t)if(r.call(n,t[i],i)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},toArray:function(e){if(e.toArray)return e.toArray();return t.call(e)},isUndefined:function(e){return e===undefined},isNull:function(e){return e===null},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===false||e===true},isFunction:function(e){return Object.prototype.toString.call(e)==="[object Function]"}}}},{}],47:[function(e,t,r){t.exports=n();function n(){return{load:function(e,t){t=t||document;var r=t.createElement("link");r.type="text/css";r.rel="stylesheet";r.href=e;t.getElementsByTagName("head")[0].appendChild(r)},inject:function(e,t){t=t||document;var r=document.createElement("style");r.type="text/css";r.innerHTML=e;t.getElementsByTagName("head")[0].appendChild(r)}}}},{}],48:[function(e,t,r){t.exports=i;var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function i(e){return String(e).replace(/[&<>"'\/]/g,function(e){return n[e]})}},{}],49:[function(e,t,r){t.exports=n();function n(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}},{}],50:[function(e,t,r){t.exports={color:{math:e("./dat/color/math.js"),interpret:e("./dat/color/interpret.js"),Color:e("./dat/color/Color.js")},dom:{dom:e("./dat/dom/dom.js")},controllers:{Controller:e("./dat/controllers/Controller.js"),BooleanController:e("./dat/controllers/BooleanController.js"),OptionController:e("./dat/controllers/OptionController.js"),StringController:e("./dat/controllers/StringController.js"),NumberController:e("./dat/controllers/NumberController.js"),NumberControllerBox:e("./dat/controllers/NumberControllerBox.js"),NumberControllerSlider:e("./dat/controllers/NumberControllerSlider.js"),FunctionController:e("./dat/controllers/FunctionController.js"),ColorController:e("./dat/controllers/ColorController.js")},gui:{GUI:e("./dat/gui/GUI.js")},GUI:e("./dat/gui/GUI.js")}},{"./dat/color/Color.js":29,"./dat/color/interpret.js":30,"./dat/color/math.js":31,"./dat/controllers/BooleanController.js":33,"./dat/controllers/ColorController.js":34,"./dat/controllers/Controller.js":35,"./dat/controllers/FunctionController.js":36,"./dat/controllers/NumberController.js":37,"./dat/controllers/NumberControllerBox.js":38,"./dat/controllers/NumberControllerSlider.js":39,"./dat/controllers/OptionController.js":40,"./dat/controllers/StringController.js":41,"./dat/dom/dom.js":44,"./dat/gui/GUI.js":45}],51:[function(e,t,r){"use strict";var n=e("game-shell");var i=e("webglew");function o(e){e=e||{};var t=e.extensions||[];var r=n(e);var o=r.scale||1;var a=e.glOptions;r.on("init",function l(){var n=document.createElement("canvas");var l=n.getContext("webgl",a)||n.getContext("experimental-webgl",a);if(!l){r.emit("gl-error",new Error("Unable to initialize WebGL"));return}var u=i(l);for(var f=0;f<t.length;++f){if(!(t[f]in u)){r.emit("gl-error",new Error("Missing extension: "+t[f]));return}}n.style.position="absolute";n.style.left="0px";n.style.top="0px";r.element.appendChild(n);r.canvas=n;r.gl=l;s();r.clearFlags=e.clearFlags===undefined?l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT:e.clearFlags;r.clearColor=e.clearColor||[0,0,0,0];r.clearDepth=e.clearDepth||1;r.clearStencil=e.clearStencil||0;r.on("resize",s);r.on("render",function c(e){l.bindFramebuffer(l.FRAMEBUFFER,null);l.viewport(0,0,r._width/o|0,r._height/o|0);if(r.clearFlags&l.STENCIL_BUFFER_BIT){l.clearStencil(r.clearStencil)}if(r.clearFlags&l.COLOR_BUFFER_BIT){l.clearColor(r.clearColor[0],r.clearColor[1],r.clearColor[2],r.clearColor[3])}if(r.clearFlags&l.DEPTH_BUFFER_BIT){l.clearDepth(r.clearDepth)}if(r.clearFlags){l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT|l.STENCIL_BUFFER_BIT)}r.emit("gl-render",e)});r.emit("gl-init")});function s(){var e=r._width/o|0;var t=r._height/o|0;r.canvas.width=e;r.canvas.height=t;r.canvas.style.width=r._width+"px";r.canvas.style.height=r._height+"px";r.emit("gl-resize",e,t)}Object.defineProperty(r,"scale",{get:function(){return o},set:function(e){e=+e;if(e<=0||isNaN(e)||o===e){return o}o=e;s();return o}});Object.defineProperty(r,"width",{get:function(){return r._width/o|0}});Object.defineProperty(r,"height",{get:function(){return r._height/o|0}});Object.defineProperty(r,"mouse",{get:function(){return[r.mouseX/o,r.mouseY/o]}});Object.defineProperty(r,"prevMouse",{get:function(){return[r.prevMouseX/o,r.prevMouseY/o]}});return r}t.exports=o},{"game-shell":61,webglew:63}],52:[function(e,t,r){if(typeof window.performance==="object"){if(window.performance.now){t.exports=function(){return window.performance.now()}}else if(window.performance.webkitNow){t.exports=function(){return window.performance.webkitNow()}}}else if(Date.now){t.exports=Date.now}else{t.exports=function(){return(new Date).getTime()}}},{}],53:[function(e,t,r){var n="",i,o,a;if(window.addEventListener){i="addEventListener"}else{i="attachEvent";n="on"}a="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";function s(e,t,r,o){e[i](n+t,a=="wheel"?r:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:e.type=="MozMousePixelScroll"?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=false}};if(a=="mousewheel"){t.deltaY=-1/40*e.wheelDelta;e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)}else{t.deltaY=e.detail}return r(t)},o||false)}t.exports=function(e,t,r){s(e,a,t,r);if(a=="DOMMouseScroll"){s(e,"MozMousePixelScroll",t,r)}}},{}],54:[function(e,t,r){var n=0;var i=["ms","moz","webkit","o"];for(var o=0;o<i.length&&!window.requestAnimationFrame;++o){window.requestAnimationFrame=window[i[o]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[i[o]+"CancelAnimationFrame"]||window[i[o]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(e,t){var r=(new Date).getTime();var i=Math.max(0,16-(r-n));var o=window.setTimeout(function(){e(r+i)},i);n=r+i;return o};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(e){clearTimeout(e)}},{}],55:[function(e,t,r){"use strict";function n(e,t,r,n,i,o){var a=["function ",e,"(a,l,h,",n.join(","),"){",o?"":"var i=",r?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",i?".get(m)":"[m]"];if(o){if(t.indexOf("c")<0){a.push(";if(x===y){return m}else if(x<=y){")}else{a.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){")}}else{a.push(";if(",t,"){i=m;")}if(r){a.push("l=m+1}else{h=m-1}")}else{a.push("h=m-1}else{l=m+1}")}a.push("}");if(o){a.push("return -1};")}else{a.push("return i};")}return a.join("")}function i(e,t,r,i){var o=new Function([n("A","x"+e+"y",t,["y"],false,i),n("B","x"+e+"y",t,["y"],true,i),n("P","c(x,y)"+e+"0",t,["y","c"],false,i),n("Q","c(x,y)"+e+"0",t,["y","c"],true,i),"function dispatchBsearch",r,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",r].join(""));return o()}t.exports={ge:i(">=",false,"GE"),gt:i(">",false,"GT"),lt:i("<",true,"LT"),le:i("<=",true,"LE"),eq:i("-",true,"EQ",true)}},{}],56:[function(e,t,r){!function(e,r){if(typeof t!="undefined")t.exports=r();else if(typeof define=="function"&&typeof define.amd=="object")define(r);else this[e]=r()}("domready",function(){var e=[],t,r=document,n=r.documentElement.doScroll,i="DOMContentLoaded",o=(n?/^loaded|^c/:/^loaded|^i|^c/).test(r.readyState);if(!o)r.addEventListener(i,t=function(){r.removeEventListener(i,t);o=1;while(t=e.shift())t()});return function(t){o?setTimeout(t,0):e.push(t)}})},{}],57:[function(e,t,r){"use strict";function n(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){t[e[r]]=r}}return t}t.exports=n},{}],58:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{dup:9}],59:[function(e,t,r){arguments[4][7][0].apply(r,arguments)},{dup:7}],60:[function(e,t,r){var n=typeof window!=="undefined"?window.navigator.userAgent:"",i=/OS X/.test(n),o=/Opera/.test(n),a=!/like Gecko/.test(n)&&!o;var s,l=t.exports={0:i?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:i?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num-->",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:i&&a?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:o?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(s=58;s<65;++s){l[s]=String.fromCharCode(s)}for(s=48;s<58;++s){l[s]=s-48+""}for(s=65;s<91;++s){l[s]=String.fromCharCode(s)}for(s=96;s<106;++s){l[s]="<num-"+(s-96)+">"}for(s=112;s<136;++s){l[s]="F"+(s-111)}},{}],61:[function(e,t,r){"use strict";var n=e("events").EventEmitter,i=e("util"),o=e("domready"),a=e("vkey"),s=e("invert-hash"),l=e("uniq"),u=e("binary-search-bounds"),f=e("iota-array"),c=Math.min;e("./lib/raf-polyfill.js");var d=e("./lib/mousewheel-polyfill.js");var h=e("./lib/hrtime-polyfill.js");var p=function(){var e=new Array(256),t,r,n;for(t=0;t<256;++t){e[t]="UNK"}for(t in a){n=a[t];if(n.charAt(0)==="<"&&n.charAt(n.length-1)===">"){n=n.substring(1,n.length-1)}n=n.replace(/\s/g,"-");e[parseInt(t)]=n}return e}();var g=l(Object.keys(s(p)));function _(e){return u.eq(g,e)}function m(e){return _(p[e])}function v(){n.call(this);this._curKeyState=new Array(g.length);this._pressCount=new Array(g.length);this._releaseCount=new Array(g.length);this._tickInterval=null;this._rafHandle=null;this._tickRate=0;this._lastTick=h();this._frameTime=0;this._paused=true;this._width=0;this._height=0;this._wantFullscreen=false;this._wantPointerLock=false;this._fullscreenActive=false;this._pointerLockActive=false;this._render=k.bind(undefined,this);this.preventDefaults=true;this.stopPropagation=false;for(var e=0;e<g.length;++e){this._curKeyState[e]=false;this._pressCount[e]=this._releaseCount[e]=0}this.element=null;this.bindings={};this.frameSkip=100;this.tickCount=0;this.frameCount=0;this.startTime=h();this.tickTime=this._tickRate;this.frameTime=10;this.stickyFullscreen=false;this.stickyPointerLock=false;this.scroll=[0,0,0];this.mouseX=0;this.mouseY=0;this.prevMouseX=0;this.prevMouseY=0}i.inherits(v,n);var b=v.prototype;b.keyNames=g;b.bind=function(e){var t;if(e in this.bindings){t=this.bindings[e]}else{t=[]}var r;for(var n=1,i=arguments.length;n<i;++n){r=arguments[n];if(_(r)>=0){t.push(r)}else if(r in this.bindings){var o=this.bindings[r];for(var a=0;a<o.length;++a){t.push(o[a])}}}t=l(t);if(t.length>0){this.bindings[e]=t}this.emit("bind",e,t)};b.unbind=function(e){if(e in this.bindings){delete this.bindings[e]}this.emit("unbind",e)};function y(e,t,r){if(r in t){var n=t[r];for(var i=0,o=n.length;i<o;++i){if(e[_(n[i])]){return true}}return false}var a=_(r);if(a>=0){return e[a]}return false}function E(e,t,r){if(r in t){var n=t[r],i=0;for(var o=0,a=n.length;o<a;++o){i+=e[_(n[o])]}return i}var s=_(r);if(s>=0){return e[s]}return 0}b.down=function(e){return y(this._curKeyState,this.bindings,e)};b.wasDown=function(e){return this.down(e)||!!this.press(e)};b.up=function(e){return!this.down(e)};b.wasUp=function(e){return this.up(e)||!!this.release(e)};b.press=function(e){return E(this._pressCount,this.bindings,e)};b.release=function(e){return E(this._releaseCount,this.bindings,e)};Object.defineProperty(b,"paused",{get:function(){return this._paused},set:function(e){var t=!!e;if(t!==this._paused){if(!this._paused){this._paused=true;this._frameTime=c(1,(h()-this._lastTick)/this._tickRate);clearInterval(this._tickInterval)}else{this._paused=false;this._lastTick=h()-Math.floor(this._frameTime*this._tickRate);this._tickInterval=setInterval(S,this._tickRate,this);this._rafHandle=requestAnimationFrame(this._render)}}}});function w(e){var t=e.element;if(e._wantFullscreen&&!e._fullscreenActive){var r=t.requestFullscreen||t.requestFullScreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullscreen||t.mozRequestFullScreen||function(){};r.call(t)}if(e._wantPointerLock&&!e._pointerLockActive){var n=t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock||t.msRequestPointerLock||t.oRequestPointerLock||function(){};n.call(t)}}var T=document.exitFullscreen||document.cancelFullscreen||document.cancelFullScreen||document.webkitCancelFullscreen||document.webkitCancelFullScreen||document.mozCancelFullscreen||document.mozCancelFullScreen||function(){};Object.defineProperty(b,"fullscreen",{get:function(){return this._fullscreenActive},set:function(e){var t=!!e;if(!t){this._wantFullscreen=false;T.call(document)}else{this._wantFullscreen=true;w(this)}return this._fullscreenActive}});function A(e){e._fullscreenActive=document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||false;if(!e.stickyFullscreen&&e._fullscreenActive){e._wantFullscreen=false}}var x=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock||function(){};Object.defineProperty(b,"pointerLock",{get:function(){return this._pointerLockActive},set:function(e){var t=!!e;if(!t){this._wantPointerLock=false;x.call(document)}else{this._wantPointerLock=true;w(this)}return this._pointerLockActive}});function R(e,t){e._pointerLockActive=e.element===(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement||null);if(!e.stickyPointerLock&&e._pointerLockActive){e._wantPointerLock=false}}Object.defineProperty(b,"width",{get:function(){return this.element.clientWidth}});Object.defineProperty(b,"height",{get:function(){return this.element.clientHeight}});function C(e,t,r){var n=e._curKeyState[t];if(n!==r){if(r){e._pressCount[t]++}else{e._releaseCount[t]++}e._curKeyState[t]=r}}function S(e){var t=h()+e.frameSkip,r=e._pressCount,n=e._releaseCount,i,o,a,s=e._tickRate,l=g.length;while(!e._paused&&h()>=e._lastTick+s){if(h()>t){e._lastTick=h()+s;return}o=h();e.emit("tick");a=h();e.tickTime=a-o;++e.tickCount;e._lastTick+=s;for(i=0;i<l;++i){r[i]=n[i]=0}if(e._pointerLockActive){e.prevMouseX=e.mouseX=e.width>>1;e.prevMouseY=e.mouseY=e.height>>1}else{e.prevMouseX=e.mouseX;e.prevMouseY=e.mouseY}e.scroll[0]=e.scroll[1]=e.scroll[2]=0}}function k(e){e._rafHandle=requestAnimationFrame(e._render);S(e);var t;if(e._paused){t=e._frameTime}else{t=c(1,(h()-e._lastTick)/e._tickRate)}++e.frameCount;var r=h();e.emit("render",t);var n=h();e.frameTime=n-r}function I(e){return document.activeElement===document.body||document.activeElement===e.element}function L(e,t){if(e.preventDefaults){t.preventDefault()}if(e.stopPropagation){t.stopPropagation()}}function N(e,t){L(e,t);var r=m(t.keyCode||t.char||t.which||t.charCode);if(r>=0){C(e,r,false)}}function P(e,t){if(!I(e)){return}L(e,t);if(t.metaKey){H(e,t)}else{var r=m(t.keyCode||t.char||t.which||t.charCode);if(r>=0){C(e,r,true)}}}var O=f(32).map(function(e){return _("mouse-"+(e+1))});function j(e,t){for(var r=0;r<32;++r){C(e,O[r],!!(t&1<<r))}}function M(e,t){L(e,t);if(e._pointerLockActive){var r=t.movementX||t.mozMovementX||t.webkitMovementX||0,n=t.movementY||t.mozMovementY||t.webkitMovementY||0;e.mouseX+=r;e.mouseY+=n}else{e.mouseX=t.clientX-e.element.offsetLeft;e.mouseY=t.clientY-e.element.offsetTop}return false}function U(e,t){L(e,t);C(e,O[t.button],true);return false}function D(e,t){L(e,t);C(e,O[t.button],false);return false}function F(e,t){L(e,t);if(e._pointerLockActive){e.prevMouseX=e.mouseX=e.width>>1;e.prevMouseY=e.mouseY=e.height>>1}else{e.prevMouseX=e.mouseX=t.clientX-e.element.offsetLeft;e.prevMouseY=e.mouseY=t.clientY-e.element.offsetTop}return false}function B(e,t){L(e,t);j(e,0);return false}function V(e,t){L(e,t);var r=1;switch(t.deltaMode){case 0:r=1;break;case 1:r=12;break;case 2:r=e.height;break}e.scroll[0]+=t.deltaX*r;e.scroll[1]+=t.deltaY*r;e.scroll[2]+=t.deltaZ*r||0;return false}function X(e,t){L(e,t);return false}function H(e,t){var r=g.length,n=e._curKeyState,i=e._releaseCount,o;for(o=0;o<r;++o){if(n[o]){++i[o]}n[o]=false}return false}function G(e,t){var r=e.element.clientWidth|0;var n=e.element.clientHeight|0;if(r!==e._width||n!==e._height){e._width=r;e._height=n;e.emit("resize",r,n)}}function z(){var e=document.createElement("div");e.tabindex=1;e.style.position="absolute";e.style.left="0px";e.style.right="0px";e.style.top="0px";e.style.bottom="0px";e.style.height="100%";e.style.overflow="hidden";document.body.appendChild(e);document.body.style.overflow="hidden";document.body.style.height="100%";return e}function Y(e){e=e||{};var t=!!e.fullscreen;var r=t;if(typeof e.pointerLock!==undefined){r=!!e.pointerLock}var n=new v;n._tickRate=e.tickRate||30;n.frameSkip=e.frameSkip||(n._tickRate+5)*5;n.stickyFullscreen=!!e.stickyFullscreen||!!e.sticky;n.stickyPointerLock=!!e.stickyPointerLock||!!e.sticky;if(e.bindings){n.bindings=e.bindings}setTimeout(function(){o(function i(){var i=e.element;if(typeof i==="string"){var o=document.querySelector(i);if(!o){o=document.getElementById(i)}if(!o){o=document.getElementByClass(i)[0]}if(!o){o=z()}n.element=o}else if(typeof i==="object"&&!!i){n.element=i}else if(typeof i==="function"){n.element=i()}else{n.element=z()}if(n.element.style){n.element.style["-webkit-touch-callout"]="none";n.element.style["-webkit-user-select"]="none";n.element.style["-khtml-user-select"]="none";n.element.style["-moz-user-select"]="none";n.element.style["-ms-user-select"]="none";n.element.style["user-select"]="none"}n._width=n.element.clientWidth;n._height=n.element.clientHeight;var a=G.bind(undefined,n);if(typeof MutationObserver!=="undefined"){var s=new MutationObserver(a);s.observe(n.element,{attributes:true,subtree:true})}else{n.element.addEventListener("DOMSubtreeModified",a,false)}window.addEventListener("resize",a,false);window.addEventListener("keydown",P.bind(undefined,n),false);window.addEventListener("keyup",N.bind(undefined,n),false);n.element.oncontextmenu=X.bind(undefined,n);n.element.addEventListener("mousedown",U.bind(undefined,n),false);n.element.addEventListener("mouseup",D.bind(undefined,n),false);n.element.addEventListener("mousemove",M.bind(undefined,n),false);n.element.addEventListener("mouseenter",F.bind(undefined,n),false);var l=B.bind(undefined,n);n.element.addEventListener("mouseleave",l,false);n.element.addEventListener("mouseout",l,false);window.addEventListener("mouseleave",l,false);window.addEventListener("mouseout",l,false);var u=H.bind(undefined,n);n.element.addEventListener("blur",u,false);n.element.addEventListener("focusout",u,false);n.element.addEventListener("focus",u,false);window.addEventListener("blur",u,false);window.addEventListener("focusout",u,false);window.addEventListener("focus",u,false);d(n.element,V.bind(undefined,n),false);var f=A.bind(undefined,n);document.addEventListener("fullscreenchange",f,false);document.addEventListener("mozfullscreenchange",f,false);document.addEventListener("webkitfullscreenchange",f,false);n.element.addEventListener("click",w.bind(undefined,n),false);var c=R.bind(undefined,n);document.addEventListener("pointerlockchange",c,false);document.addEventListener("mozpointerlockchange",c,false);document.addEventListener("webkitpointerlockchange",c,false);document.addEventListener("pointerlocklost",c,false);document.addEventListener("webkitpointerlocklost",c,false);document.addEventListener("mozpointerlocklost",c,false);n.fullscreen=t;n.pointerLock=r;n.bind("mouse-left","mouse-1");n.bind("mouse-right","mouse-3");n.bind("mouse-middle","mouse-2");n._lastTick=h();n.startTime=h();n.paused=false;n.emit("init")})},0);return n}t.exports=Y},{"./lib/hrtime-polyfill.js":52,"./lib/mousewheel-polyfill.js":53,"./lib/raf-polyfill.js":54,"binary-search-bounds":55,domready:56,events:24,"invert-hash":57,"iota-array":58,uniq:59,util:28,vkey:60}],62:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{dup:18}],63:[function(e,t,r){"use strict";var n=typeof WeakMap==="undefined"?e("weak-map"):WeakMap;var i=new n;function o(e){return e.replace(/^[A-Z]+_/,"")}function a(e){var t=i.get(e);if(t){return t}var r={};var n=e.getSupportedExtensions();for(var a=0;a<n.length;++a){var s=n[a];if(s.indexOf("MOZ_")===0){continue}var l=e.getExtension(n[a]);if(!l){continue}while(true){r[s]=l;var u=o(s);if(u===s){break}s=u}}i.set(e,r);return r}t.exports=a},{"weak-map":62}],64:[function(e,t,r){"use strict";var n=e("./lib/create-uniforms");var i=e("./lib/create-attributes");var o=e("./lib/reflect");var a=e("./lib/shader-cache");var s=e("./lib/runtime-reflect");function l(e){this.gl=e;this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var u=l.prototype;u.bind=function(){if(!this.program){this._relink()}this.gl.useProgram(this.program)};u.dispose=function(){if(this._fref){this._fref.dispose()}if(this._vref){this._vref.dispose()}this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function f(e,t){if(e.name<t.name){return-1}return 1}u.update=function(e,t,r,l){if(!t||arguments.length===1){var u=e;e=u.vertex;t=u.fragment;r=u.uniforms;l=u.attributes}var c=this;var d=c.gl;var h=c._vref;c._vref=a.shader(d,d.VERTEX_SHADER,e);if(h){h.dispose()}c.vertShader=c._vref.shader;var p=this._fref;c._fref=a.shader(d,d.FRAGMENT_SHADER,t);if(p){p.dispose()}c.fragShader=c._fref.shader;if(!r||!l){var g=d.createProgram();d.attachShader(g,c.fragShader);d.attachShader(g,c.vertShader);d.linkProgram(g);if(!d.getProgramParameter(g,d.LINK_STATUS)){var _=d.getProgramInfoLog(g);console.error("gl-shader: Error linking program:",_);throw new Error("gl-shader: Error linking program:"+_)}r=r||s.uniforms(d,g);l=l||s.attributes(d,g);d.deleteProgram(g)}l=l.slice();l.sort(f);var m=[];var v=[];var b=[];for(var y=0;y<l.length;++y){var E=l[y];if(E.type.indexOf("mat")>=0){var w=E.type.charAt(E.type.length-1)|0;var T=new Array(w);for(var A=0;A<w;++A){T[A]=b.length;v.push(E.name+"["+A+"]");if(typeof E.location==="number"){b.push(E.location+A)}else if(Array.isArray(E.location)&&E.location.length===w&&typeof E.location[A]==="number"){b.push(E.location[A]|0)}else{b.push(-1)}}m.push({name:E.name,type:E.type,locations:T})}else{m.push({name:E.name,type:E.type,locations:[b.length]});v.push(E.name);if(typeof E.location==="number"){b.push(E.location|0)}else{b.push(-1)}}}var x=0;for(var y=0;y<b.length;++y){if(b[y]<0){while(b.indexOf(x)>=0){x+=1}b[y]=x}}var R=new Array(r.length);function C(){c.program=a.program(d,c._vref,c._fref,v,b);for(var e=0;e<r.length;++e){R[e]=d.getUniformLocation(c.program,r[e].name)}}C();c._relink=C;c.types={uniforms:o(r),attributes:o(l)};c.attributes=i(d,c,m,b);Object.defineProperty(c,"uniforms",n(d,c,r,R))};function c(e,t,r,n,i){var o=new l(e);o.update(t,r,n,i);return o}t.exports=c},{"./lib/create-attributes":65,"./lib/create-uniforms":66,"./lib/reflect":67,"./lib/runtime-reflect":68,"./lib/shader-cache":69}],65:[function(e,t,r){"use strict";t.exports=s;function n(e,t,r,n,i,o){this._gl=e;this._wrapper=t;this._index=r;this._locations=n;this._dimension=i;this._constFunc=o}var i=n.prototype;i.pointer=function l(e,t,r,n){var i=this;var o=i._gl;var a=i._locations[i._index];o.vertexAttribPointer(a,i._dimension,e||o.FLOAT,!!t,r||0,n||0);o.enableVertexAttribArray(a)};i.set=function(e,t,r,n){return this._constFunc(this._locations[this._index],e,t,r,n)};Object.defineProperty(i,"location",{get:function(){return this._locations[this._index]},set:function(e){if(e!==this._locations[this._index]){this._locations[this._index]=e|0;this._wrapper.program=null}return e|0}});function o(e,t,r,i,o,a,s){var l=["gl","v"];var u=[];for(var f=0;f<o;++f){l.push("x"+f);u.push("x"+f)}l.push("if(x0.length===void 0){return gl.vertexAttrib"+o+"f(v,"+u.join()+")}else{return gl.vertexAttrib"+o+"fv(v,x0)}");var c=Function.apply(null,l);var d=new n(e,t,r,i,o,c);Object.defineProperty(a,s,{set:function(t){e.disableVertexAttribArray(i[r]);c(e,i[r],t);return t},get:function(){return d},enumerable:true})}function a(e,t,r,n,i,a,s){var l=new Array(i);var u=new Array(i);for(var f=0;f<i;++f){o(e,t,r[f],n,i,l,f);u[f]=l[f]}Object.defineProperty(l,"location",{set:function(e){if(Array.isArray(e)){for(var t=0;t<i;++t){u[t].location=e[t]}}else{for(var t=0;t<i;++t){u[t].location=e+t}}return e},get:function(){var e=new Array(i);for(var t=0;t<i;++t){e[t]=n[r[t]]}return e},enumerable:true});l.pointer=function(t,o,a,s){t=t||e.FLOAT;o=!!o;a=a||i*i;s=s||0;for(var l=0;l<i;++l){var u=n[r[l]];e.vertexAttribPointer(u,i,t,o,a,s+l*i);e.enableVertexAttribArray(u)}};var c=new Array(i);var d=e["vertexAttrib"+i+"fv"];Object.defineProperty(a,s,{set:function(t){for(var o=0;o<i;++o){var a=n[r[o]];e.disableVertexAttribArray(a);if(Array.isArray(t[0])){d.call(e,a,t[o])}else{for(var s=0;s<i;++s){c[s]=t[i*o+s]}d.call(e,a,c)}}return t},get:function(){return l},enumerable:true})}function s(e,t,r,n){var i={};for(var s=0,l=r.length;s<l;++s){var u=r[s];var f=u.name;var c=u.type;var d=u.locations;switch(c){case"bool":case"int":case"float":o(e,t,d[0],n,1,i,f);break;default:if(c.indexOf("vec")>=0){var h=c.charCodeAt(c.length-1)-48;if(h<2||h>4){throw new Error("gl-shader: Invalid data type for attribute "+f+": "+c)}o(e,t,d[0],n,h,i,f)}else if(c.indexOf("mat")>=0){var h=c.charCodeAt(c.length-1)-48;if(h<2||h>4){throw new Error("gl-shader: Invalid data type for attribute "+f+": "+c)}a(e,t,d,n,h,i,f)}else{throw new Error("gl-shader: Unknown data type for attribute "+f+": "+c)}break}}return i}},{}],66:[function(e,t,r){"use strict";var n=e("./reflect");t.exports=a;function i(e){var t=new Function("y","return function(){return y}");return t(e)}function o(e,t){var r=new Array(e);for(var n=0;n<e;++n){r[n]=t}return r}function a(e,t,r,a){function s(r){var n=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+r+"])}");return n(e,t,a)}function l(e,t,r){switch(r){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+e+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+e+")";default:var n=r.indexOf("vec");if(0<=n&&n<=1&&r.length===4+n){var i=r.charCodeAt(r.length-1)-48;if(i<2||i>4){throw new Error("gl-shader: Invalid data type")}switch(r.charAt(0)){case"b":case"i":return"gl.uniform"+i+"iv(locations["+t+"],obj"+e+")";case"v":return"gl.uniform"+i+"fv(locations["+t+"],obj"+e+")";default:throw new Error("gl-shader: Unrecognized data type for vector "+name+": "+r)}}else if(r.indexOf("mat")===0&&r.length===4){var i=r.charCodeAt(r.length-1)-48;if(i<2||i>4){
throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+r)}return"gl.uniformMatrix"+i+"fv(locations["+t+"],false,obj"+e+")"}else{throw new Error("gl-shader: Unknown uniform data type for "+name+": "+r)}break}}function u(e,t){if(typeof t!=="object"){return[[e,t]]}var r=[];for(var n in t){var i=t[n];var o=e;if(parseInt(n)+""===n){o+="["+n+"]"}else{o+="."+n}if(typeof i==="object"){r.push.apply(r,u(o,i))}else{r.push([o,i])}}return r}function f(t){var n=["return function updateProperty(obj){"];var i=u("",t);for(var o=0;o<i.length;++o){var s=i[o];var f=s[0];var c=s[1];if(a[c]){n.push(l(f,c,r[c].type))}}n.push("return obj}");var d=new Function("gl","locations",n.join("\n"));return d(e,a)}function c(e){switch(e){case"bool":return false;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(0<=t&&t<=1&&e.length===4+t){var r=e.charCodeAt(e.length-1)-48;if(r<2||r>4){throw new Error("gl-shader: Invalid data type")}if(e.charAt(0)==="b"){return o(r,false)}return o(r,0)}else if(e.indexOf("mat")===0&&e.length===4){var r=e.charCodeAt(e.length-1)-48;if(r<2||r>4){throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+e)}return o(r*r,0)}else{throw new Error("gl-shader: Unknown uniform data type for "+name+": "+e)}break}}function d(e,t,n){if(typeof n==="object"){var o=h(n);Object.defineProperty(e,t,{get:i(o),set:f(n),enumerable:true,configurable:false})}else{if(a[n]){Object.defineProperty(e,t,{get:s(n),set:f(n),enumerable:true,configurable:false})}else{e[t]=c(r[n].type)}}}function h(e){var t;if(Array.isArray(e)){t=new Array(e.length);for(var r=0;r<e.length;++r){d(t,r,e[r])}}else{t={};for(var n in e){d(t,n,e[n])}}return t}var p=n(r,true);return{get:i(h(p)),set:f(p),enumerable:true,configurable:true}}},{"./reflect":67}],67:[function(e,t,r){"use strict";t.exports=n;function n(e,t){var r={};for(var n=0;n<e.length;++n){var i=e[n].name;var o=i.split(".");var a=r;for(var s=0;s<o.length;++s){var l=o[s].split("[");if(l.length>1){if(!(l[0]in a)){a[l[0]]=[]}a=a[l[0]];for(var u=1;u<l.length;++u){var f=parseInt(l[u]);if(u<l.length-1||s<o.length-1){if(!(f in a)){if(u<l.length-1){a[f]=[]}else{a[f]={}}}a=a[f]}else{if(t){a[f]=n}else{a[f]=e[n].type}}}}else if(s<o.length-1){if(!(l[0]in a)){a[l[0]]={}}a=a[l[0]]}else{if(t){a[l[0]]=n}else{a[l[0]]=e[n].type}}}}return r}},{}],68:[function(e,t,r){"use strict";r.uniforms=a;r.attributes=s;var n={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"};var i=null;function o(e,t){if(!i){var r=Object.keys(n);i={};for(var o=0;o<r.length;++o){var a=r[o];i[e[a]]=n[a]}}return i[t]}function a(e,t){var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);var n=[];for(var i=0;i<r;++i){var a=e.getActiveUniform(t,i);if(a){var s=o(e,a.type);if(a.size>1){for(var l=0;l<a.size;++l){n.push({name:a.name.replace("[0]","["+l+"]"),type:s})}}else{n.push({name:a.name,type:s})}}}return n}function s(e,t){var r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);var n=[];for(var i=0;i<r;++i){var a=e.getActiveAttrib(t,i);if(a){n.push({name:a.name,type:o(e,a.type)})}}return n}},{}],69:[function(e,t,r){"use strict";r.shader=h;r.program=p;var n=e("gl-format-compiler-error");var i=typeof WeakMap==="undefined"?e("weakmap-shim"):WeakMap;var o=new i;var a=0;function s(e,t,r,n,i,o,a){this.id=e;this.src=t;this.type=r;this.shader=n;this.count=o;this.programs=[];this.cache=a}s.prototype.dispose=function(){if(--this.count===0){var e=this.cache;var t=e.gl;var r=this.programs;for(var n=0,i=r.length;n<i;++n){var o=e.programs[r[n]];if(o){delete e.programs[n];t.deleteProgram(o)}}t.deleteShader(this.shader);delete e.shaders[this.type===t.FRAGMENT_SHADER|0][this.src]}};function l(e){this.gl=e;this.shaders=[{},{}];this.programs={}}var u=l.prototype;function f(e,t,r){var i=e.createShader(t);e.shaderSource(i,r);e.compileShader(i);if(!e.getShaderParameter(i,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(i);try{var a=n(o,r,t)}catch(s){console.warn("Failed to format compiler error: "+s);throw new Error("gl-shader: Error compiling shader:\n"+o)}console.warn("gl-shader: "+a.long);throw new Error("gl-shader: "+a.short)}return i}u.getShaderReference=function(e,t){var r=this.gl;var n=this.shaders[e===r.FRAGMENT_SHADER|0];var i=n[t];if(!i||!r.isShader(i.shader)){var o=f(r,e,t);i=n[t]=new s(a++,t,e,o,[],1,this)}else{i.count+=1}return i};function c(e,t,r,n,i){var o=e.createProgram();e.attachShader(o,t);e.attachShader(o,r);for(var a=0;a<n.length;++a){e.bindAttribLocation(o,i[a],n[a])}e.linkProgram(o);if(!e.getProgramParameter(o,e.LINK_STATUS)){var s=e.getProgramInfoLog(o);console.error("gl-shader: Error linking program:",s);throw new Error("gl-shader: Error linking program:"+s)}return o}u.getProgram=function(e,t,r,n){var i=[e.id,t.id,r.join(":"),n.join(":")].join("@");var o=this.programs[i];if(!o||!this.gl.isProgram(o)){this.programs[i]=o=c(this.gl,e.shader,t.shader,r,n);e.programs.push(i);t.programs.push(i)}return o};function d(e){var t=o.get(e);if(!t){t=new l(e);o.set(e,t)}return t}function h(e,t,r){return d(e).getShaderReference(t,r)}function p(e,t,r,n,i){return d(e).getProgram(t,r,n,i)}},{"gl-format-compiler-error":70,"weakmap-shim":86}],70:[function(e,t,r){var n=e("sprintf-js").sprintf;var i=e("gl-constants/lookup");var o=e("glsl-shader-name");var a=e("add-line-numbers");t.exports=s;function s(e,t,r){"use strict";var s=o(t)||"of unknown name (see npm glsl-shader-name)";var l="unknown type";if(r!==undefined){l=r===i.FRAGMENT_SHADER?"fragment":"vertex"}var u=n("Error compiling %s shader %s:\n",l,s);var f=n("%s%s",u,e);var c=e.split("\n");var d={};for(var h=0;h<c.length;h++){var p=c[h];if(p==="")continue;var g=parseInt(p.split(":")[2]);if(isNaN(g)){throw new Error(n("Could not parse error: %s",p))}d[g]=p}var _=a(t).split("\n");for(var h=0;h<_.length;h++){if(!d[h+3]&&!d[h+2]&&!d[h+1])continue;var m=_[h];u+=m+"\n";if(d[h+1]){var v=d[h+1];v=v.substr(v.split(":",3).join(":").length+1).trim();u+=n("^^^ %s\n\n",v)}}return{"long":u.trim(),"short":f.trim()}}},{"add-line-numbers":71,"gl-constants/lookup":75,"glsl-shader-name":76,"sprintf-js":83}],71:[function(e,t,r){var n=e("pad-left");t.exports=i;function i(e,t,r){t=typeof t==="number"?t:1;r=r||": ";var i=e.split(/\r?\n/);var o=String(i.length+t-1).length;return i.map(function(e,i){var a=i+t;var s=String(a).length;var l=n(a,o-s);return l+r+e}).join("\n")}},{"pad-left":72}],72:[function(e,t,r){"use strict";var n=e("repeat-string");t.exports=function i(e,t,r){r=typeof r!=="undefined"?r+"":" ";return n(r,t)+e}},{"repeat-string":73}],73:[function(e,t,r){"use strict";t.exports=n;function n(e,t){if(typeof e!=="string"){throw new TypeError("repeat-string expects a string.")}if(t===1)return e;if(t===2)return e+e;var r=e.length*t;if(o!==e||typeof o==="undefined"){o=e;i=""}while(r>i.length&&t>0){if(t&1){i+=e}t>>=1;if(!t)break;e+=e}return i.substr(0,r)}var i="";var o},{}],74:[function(e,t,r){t.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],75:[function(e,t,r){var n=e("./1.0/numbers");t.exports=function i(e){return n[e]}},{"./1.0/numbers":74}],76:[function(e,t,r){var n=e("glsl-tokenizer");var i=e("atob-lite");t.exports=o;function o(e){var t=Array.isArray(e)?e:n(e);for(var r=0;r<t.length;r++){var o=t[r];if(o.type!=="preprocessor")continue;var a=o.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(!a)continue;if(!a[2])continue;var s=a[1];var l=a[2];return(s?i(l):l).trim()}}},{"atob-lite":77,"glsl-tokenizer":82}],77:[function(e,t,r){t.exports=function n(e){return atob(e)}},{}],78:[function(e,t,r){t.exports=E;var n=e("./lib/literals"),i=e("./lib/operators"),o=e("./lib/builtins");var a=999,s=9999,l=0,u=1,f=2,c=3,d=4,h=5,p=6,g=7,_=8,m=9,v=10,b=11;var y=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function E(){var e=0,t=0,r=a,E,w,T=[],A=[],x=0,R=0,C=1,S=0,k=0,I=false,L=false,N="",P;return function(e){A=[];if(e!==null)return j(e);return M()};function O(e){if(e.length){A.push({type:y[r],data:e,position:k,line:C,column:S})}}function j(n){e=0;N+=n;P=N.length;var i;while(E=N[e],e<P){i=e;switch(r){case l:e=V();break;case u:e=B();break;case f:e=F();break;case c:e=X();break;case d:e=z();break;case b:e=G();break;case h:e=Y();break;case s:e=q();break;case m:e=D();break;case a:e=U();break}if(i!==e){switch(N[i]){case"\n":S=0;++C;break;default:++S;break}}}t+=e;N=N.slice(e);return A}function M(e){if(T.length){O(T.join(""))}r=v;O("(eof)");return A}function U(){T=T.length?[]:T;if(w==="/"&&E==="*"){k=t+e-1;r=l;w=E;return e+1}if(w==="/"&&E==="/"){k=t+e-1;r=u;w=E;return e+1}if(E==="#"){r=f;k=t+e;return e}if(/\s/.test(E)){r=m;k=t+e;return e}I=/\d/.test(E);L=/[^\w_]/.test(E);k=t+e;r=I?d:L?c:s;return e}function D(){if(/[^\s]/g.test(E)){O(T.join(""));r=a;return e}T.push(E);w=E;return e+1}function F(){if(E==="\n"&&w!=="\\"){O(T.join(""));r=a;return e}T.push(E);w=E;return e+1}function B(){return F()}function V(){if(E==="/"&&w==="*"){T.push(E);O(T.join(""));r=a;return e+1}T.push(E);w=E;return e+1}function X(){if(w==="."&&/\d/.test(E)){r=h;return e}if(w==="/"&&E==="*"){r=l;return e}if(w==="/"&&E==="/"){r=u;return e}if(E==="."&&T.length){while(H(T));r=h;return e}if(E===";"||E===")"||E==="("){if(T.length)while(H(T));O(E);r=a;return e+1}var t=T.length===2&&E!=="=";if(/[\w_\d\s]/.test(E)||t){while(H(T));r=a;return e}T.push(E);w=E;return e+1}function H(e){var t=0,r,n;do{r=i.indexOf(e.slice(0,e.length+t).join(""));n=i[r];if(r===-1){if(t--+e.length>0)continue;n=e.slice(0,1).join("")}O(n);k+=n.length;T=T.slice(n.length);return T.length}while(1)}function G(){if(/[^a-fA-F0-9]/.test(E)){O(T.join(""));r=a;return e}T.push(E);w=E;return e+1}function z(){if(E==="."){T.push(E);r=h;w=E;return e+1}if(/[eE]/.test(E)){T.push(E);r=h;w=E;return e+1}if(E==="x"&&T.length===1&&T[0]==="0"){r=b;T.push(E);w=E;return e+1}if(/[^\d]/.test(E)){O(T.join(""));r=a;return e}T.push(E);w=E;return e+1}function Y(){if(E==="f"){T.push(E);w=E;e+=1}if(/[eE]/.test(E)){T.push(E);w=E;return e+1}if(/[^\d]/.test(E)){O(T.join(""));r=a;return e}T.push(E);w=E;return e+1}function q(){if(/[^\d\w_]/.test(E)){var t=T.join("");if(n.indexOf(t)>-1){r=_}else if(o.indexOf(t)>-1){r=g}else{r=p}O(T.join(""));r=a;return e}T.push(E);w=E;return e+1}}},{"./lib/builtins":79,"./lib/literals":80,"./lib/operators":81}],79:[function(e,t,r){t.exports=["gl_Position","gl_PointSize","gl_ClipVertex","gl_FragCoord","gl_FrontFacing","gl_FragColor","gl_FragData","gl_FragDepth","gl_Color","gl_SecondaryColor","gl_Normal","gl_Vertex","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_FogCoord","gl_MaxLights","gl_MaxClipPlanes","gl_MaxTextureUnits","gl_MaxTextureCoords","gl_MaxVertexAttribs","gl_MaxVertexUniformComponents","gl_MaxVaryingFloats","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformComponents","gl_MaxDrawBuffers","gl_ModelViewMatrix","gl_ProjectionMatrix","gl_ModelViewProjectionMatrix","gl_TextureMatrix","gl_NormalMatrix","gl_ModelViewMatrixInverse","gl_ProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverse","gl_TextureMatrixInverse","gl_ModelViewMatrixTranspose","gl_ProjectionMatrixTranspose","gl_ModelViewProjectionMatrixTranspose","gl_TextureMatrixTranspose","gl_ModelViewMatrixInverseTranspose","gl_ProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixInverseTranspose","gl_TextureMatrixInverseTranspose","gl_NormalScale","gl_DepthRangeParameters","gl_DepthRange","gl_ClipPlane","gl_PointParameters","gl_Point","gl_MaterialParameters","gl_FrontMaterial","gl_BackMaterial","gl_LightSourceParameters","gl_LightSource","gl_LightModelParameters","gl_LightModel","gl_LightModelProducts","gl_FrontLightModelProduct","gl_BackLightModelProduct","gl_LightProducts","gl_FrontLightProduct","gl_BackLightProduct","gl_FogParameters","gl_Fog","gl_TextureEnvColor","gl_EyePlaneS","gl_EyePlaneT","gl_EyePlaneR","gl_EyePlaneQ","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_ObjectPlaneR","gl_ObjectPlaneQ","gl_FrontColor","gl_BackColor","gl_FrontSecondaryColor","gl_BackSecondaryColor","gl_TexCoord","gl_FogFragCoord","gl_Color","gl_SecondaryColor","gl_TexCoord","gl_FogFragCoord","gl_PointCoord","radians","degrees","sin","cos","tan","asin","acos","atan","pow","exp","log","exp2","log2","sqrt","inversesqrt","abs","sign","floor","ceil","fract","mod","min","max","clamp","mix","step","smoothstep","length","distance","dot","cross","normalize","faceforward","reflect","refract","matrixCompMult","lessThan","lessThanEqual","greaterThan","greaterThanEqual","equal","notEqual","any","all","not","texture2D","texture2DProj","texture2DLod","texture2DProjLod","textureCube","textureCubeLod","dFdx","dFdy"]},{}],80:[function(e,t,r){t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],81:[function(e,t,r){t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],82:[function(e,t,r){var n=e("./index");t.exports=i;function i(e){var t=n();var r=[];r=r.concat(t(e));r=r.concat(t(null));return r}},{"./index":78}],83:[function(e,t,r){(function(e){var t={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function n(){var e=arguments[0],t=n.cache;if(!(t[e]&&t.hasOwnProperty(e))){t[e]=n.parse(e)}return n.format.call(null,t[e],arguments)}n.format=function(e,r){var i=1,s=e.length,l="",u,f=[],c,d,h,p,g,_,m=true,v="";for(c=0;c<s;c++){l=o(e[c]);if(l==="string"){f[f.length]=e[c]}else if(l==="array"){h=e[c];if(h[2]){u=r[i];for(d=0;d<h[2].length;d++){if(!u.hasOwnProperty(h[2][d])){throw new Error(n("[sprintf] property '%s' does not exist",h[2][d]))}u=u[h[2][d]]}}else if(h[1]){u=r[h[1]]}else{u=r[i++]}if(o(u)=="function"){u=u()}if(t.not_string.test(h[8])&&t.not_json.test(h[8])&&(o(u)!="number"&&isNaN(u))){throw new TypeError(n("[sprintf] expecting number but found %s",o(u)))}if(t.number.test(h[8])){m=u>=0}switch(h[8]){case"b":u=u.toString(2);break;case"c":u=String.fromCharCode(u);break;case"d":case"i":u=parseInt(u,10);break;case"j":u=JSON.stringify(u,null,h[6]?parseInt(h[6]):0);break;case"e":u=h[7]?u.toExponential(h[7]):u.toExponential();break;case"f":u=h[7]?parseFloat(u).toFixed(h[7]):parseFloat(u);break;case"g":u=h[7]?parseFloat(u).toPrecision(h[7]):parseFloat(u);break;case"o":u=u.toString(8);break;case"s":u=(u=String(u))&&h[7]?u.substring(0,h[7]):u;break;case"u":u=u>>>0;break;case"x":u=u.toString(16);break;case"X":u=u.toString(16).toUpperCase();break}if(t.json.test(h[8])){f[f.length]=u}else{if(t.number.test(h[8])&&(!m||h[3])){v=m?"+":"-";u=u.toString().replace(t.sign,"")}else{v=""}g=h[4]?h[4]==="0"?"0":h[4].charAt(1):" ";_=h[6]-(v+u).length;p=h[6]?_>0?a(g,_):"":"";f[f.length]=h[5]?v+u+p:g==="0"?v+p+u:p+v+u}}}return f.join("")};n.cache={};n.parse=function(e){var r=e,n=[],i=[],o=0;while(r){if((n=t.text.exec(r))!==null){i[i.length]=n[0]}else if((n=t.modulo.exec(r))!==null){i[i.length]="%"}else if((n=t.placeholder.exec(r))!==null){if(n[2]){o|=1;var a=[],s=n[2],l=[];if((l=t.key.exec(s))!==null){a[a.length]=l[1];while((s=s.substring(l[0].length))!==""){if((l=t.key_access.exec(s))!==null){a[a.length]=l[1]}else if((l=t.index_access.exec(s))!==null){a[a.length]=l[1]}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}}}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}n[2]=a}else{o|=2}if(o===3){throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")}i[i.length]=n}else{throw new SyntaxError("[sprintf] unexpected placeholder")}r=r.substring(n[0].length)}return i};var i=function(e,t,r){r=(t||[]).slice(0);r.splice(0,0,e);return n.apply(null,r)};function o(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function a(e,t){return Array(t+1).join(e)}if(typeof r!=="undefined"){r.sprintf=n;r.vsprintf=i}else{e.sprintf=n;e.vsprintf=i;if(typeof define==="function"&&define.amd){define(function(){return{sprintf:n,vsprintf:i}})}}})(typeof window==="undefined"?this:window)},{}],84:[function(e,t,r){var n=e("./hidden-store.js");t.exports=i;function i(){var e={};return function(t){if((typeof t!=="object"||t===null)&&typeof t!=="function"){throw new Error("Weakmap-shim: Key must be object")}var r=t.valueOf(e);return r&&r.identity===e?r:n(t,e)}}},{"./hidden-store.js":85}],85:[function(e,t,r){t.exports=n;function n(e,t){var r={identity:t};var n=e.valueOf;Object.defineProperty(e,"valueOf",{value:function(e){return e!==t?n.apply(this,arguments):r},writable:true});return r}},{}],86:[function(e,t,r){var n=e("./create-store.js");t.exports=i;function i(){var e=n();return{get:function(t,r){var n=e(t);return n.hasOwnProperty("value")?n.value:r},set:function(t,r){e(t).value=r},has:function(t){return"value"in e(t)},"delete":function(t){return delete e(t).value}}}},{"./create-store.js":84}],87:[function(e,t,r){arguments[4][3][0].apply(r,arguments)},{"cwise-compiler":88,dup:3}],88:[function(e,t,r){arguments[4][4][0].apply(r,arguments)},{"./lib/thunk.js":90,dup:4}],89:[function(e,t,r){arguments[4][5][0].apply(r,arguments)},{dup:5,uniq:91}],90:[function(e,t,r){arguments[4][6][0].apply(r,arguments)},{"./compile.js":89,dup:6}],91:[function(e,t,r){arguments[4][7][0].apply(r,arguments)},{dup:7}],92:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8,"iota-array":93,"is-buffer":94}],93:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{dup:9}],94:[function(e,t,r){arguments[4][10][0].apply(r,arguments)},{dup:10}],95:[function(e,t,r){arguments[4][11][0].apply(r,arguments)},{dup:11}],96:[function(e,t,r){arguments[4][12][0].apply(r,arguments)},{dup:12}],97:[function(e,t,r){arguments[4][13][0].apply(r,arguments)},{"bit-twiddle":95,buffer:20,dup:13}],98:[function(e,t,r){"use strict";var n=e("ndarray");var i=e("ndarray-ops");var o=e("typedarray-pool");t.exports=y;var a=null;var s=null;var l=null;function u(e){a=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST];s=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR];l=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}var f=function(e,t){i.muls(e,t,255)};function c(e,t,r){var n=e.gl;var i=n.getParameter(n.MAX_TEXTURE_SIZE);if(t<0||t>i||r<0||r>i){throw new Error("gl-texture2d: Invalid texture size")}e._shape=[t,r];e.bind();n.texImage2D(n.TEXTURE_2D,0,e.format,t,r,0,e.format,e.type,null);e._mipLevels=[0];return e}function d(e,t,r,n,i,o){this.gl=e;this.handle=t;this.format=i;this.type=o;this._shape=[r,n];this._mipLevels=[0];this._magFilter=e.NEAREST;this._minFilter=e.NEAREST;this._wrapS=e.CLAMP_TO_EDGE;this._wrapT=e.CLAMP_TO_EDGE;this._anisoSamples=1;var a=this;var s=[this._wrapS,this._wrapT];Object.defineProperties(s,[{get:function(){return a._wrapS},set:function(e){return a.wrapS=e}},{get:function(){return a._wrapT},set:function(e){return a.wrapT=e}}]);this._wrapVector=s;var l=[this._shape[0],this._shape[1]];Object.defineProperties(l,[{get:function(){return a._shape[0]},set:function(e){return a.width=e}},{get:function(){return a._shape[1]},set:function(e){return a.height=e}}]);this._shapeVector=l}var h=d.prototype;Object.defineProperties(h,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&a.indexOf(e)>=0){if(!t.getExtension("OES_texture_float_linear")){e=t.NEAREST}}if(s.indexOf(e)<0){throw new Error("gl-texture2d: Unknown filter mode "+e)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e);return this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&a.indexOf(e)>=0){if(!t.getExtension("OES_texture_float_linear")){e=t.NEAREST}}if(s.indexOf(e)<0){throw new Error("gl-texture2d: Unknown filter mode "+e)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e);return this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;this._anisoSamples=Math.max(e,1)|0;if(t!==this._anisoSamples){var r=gl.getExtension("EXT_texture_filter_anisotropic");if(r){this.gl.texParameterf(this.gl.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){this.bind();if(l.indexOf(e)<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e);return this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){this.bind();if(l.indexOf(e)<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e);return this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(!Array.isArray(e)){e=[e,e]}if(e.length!==2){throw new Error("gl-texture2d: Must specify wrap mode for rows and columns")}for(var t=0;t<2;++t){if(l.indexOf(e[t])<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}}this._wrapS=e[0];this._wrapT=e[1];var r=this.gl;this.bind();r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,this._wrapS);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,this._wrapT);return e}},shape:{get:function(){return this._shapeVector},set:function(e){if(!Array.isArray(e)){e=[e|0,e|0]}else{if(e.length!==2){throw new Error("gl-texture2d: Invalid texture shape")}}c(this,e[0]|0,e[1]|0);return[e[0]|0,e[1]|0]}},width:{get:function(){return this._shape[0]},set:function(e){e=e|0;c(this,e,this._shape[1]);return e}},height:{get:function(){return this._shape[1]},set:function(e){e=e|0;c(this,this._shape[0],e);return e}}});h.bind=function(e){var t=this.gl;if(e!==undefined){t.activeTexture(t.TEXTURE0+(e|0))}t.bindTexture(t.TEXTURE_2D,this.handle);if(e!==undefined){return e|0}return t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0};h.dispose=function(){this.gl.deleteTexture(this.handle)};h.generateMipmap=function(){this.bind();this.gl.generateMipmap(this.gl.TEXTURE_2D);var e=Math.min(this._shape[0],this._shape[1]);for(var t=0;e>0;++t,e>>>=1){if(this._mipLevels.indexOf(t)<0){this._mipLevels.push(t)}}};h.setPixels=function(e,t,r,n){var i=this.gl;this.bind();if(Array.isArray(t)){n=r;r=t[1]|0;t=t[0]|0}else{t=t||0;r=r||0}n=n||0;if(e instanceof HTMLCanvasElement||e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLVideoElement){var o=this._mipLevels.indexOf(n)<0;if(o){i.texImage2D(i.TEXTURE_2D,0,this.format,this.format,this.type,e);this._mipLevels.push(n)}else{i.texSubImage2D(i.TEXTURE_2D,n,t,r,this.format,this.type,e)}}else if(e.shape&&e.stride&&e.data){if(e.shape.length<2||t+e.shape[1]>this._shape[1]>>>n||r+e.shape[0]>this._shape[0]>>>n||t<0||r<0){throw new Error("gl-texture2d: Texture dimensions are out of bounds")}g(i,t,r,n,this.format,this.type,this._mipLevels,e)}else{throw new Error("gl-texture2d: Unsupported data type")}};function p(e,t){if(e.length===3){return t[2]===1&&t[1]===e[0]*e[2]&&t[0]===e[2]}return t[0]===1&&t[1]===e[0]}function g(e,t,r,a,s,l,u,c){var d=c.dtype;var h=c.shape.slice();if(h.length<2||h.length>3){throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d")}var g=0,_=0;var m=p(h,c.stride.slice());if(d==="float32"){g=e.FLOAT}else if(d==="float64"){g=e.FLOAT;m=false;d="float32"}else if(d==="uint8"){g=e.UNSIGNED_BYTE}else{g=e.UNSIGNED_BYTE;m=false;d="uint8"}var v=1;if(h.length===2){_=e.LUMINANCE;h=[h[0],h[1],1];c=n(c.data,h,[c.stride[0],c.stride[1],1],c.offset)}else if(h.length===3){if(h[2]===1){_=e.ALPHA}else if(h[2]===2){_=e.LUMINANCE_ALPHA}else if(h[2]===3){_=e.RGB}else if(h[2]===4){_=e.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}v=h[2]}else{throw new Error("gl-texture2d: Invalid shape for texture")}if((_===e.LUMINANCE||_===e.ALPHA)&&(s===e.LUMINANCE||s===e.ALPHA)){_=s}if(_!==s){throw new Error("gl-texture2d: Incompatible texture format for setPixels");
}var b=c.size;var y=u.indexOf(a)<0;if(y){u.push(a)}if(g===l&&m){if(c.offset===0&&c.data.length===b){if(y){e.texImage2D(e.TEXTURE_2D,a,s,h[0],h[1],0,s,l,c.data)}else{e.texSubImage2D(e.TEXTURE_2D,a,t,r,h[0],h[1],s,l,c.data)}}else{if(y){e.texImage2D(e.TEXTURE_2D,a,s,h[0],h[1],0,s,l,c.data.subarray(c.offset,c.offset+b))}else{e.texSubImage2D(e.TEXTURE_2D,a,t,r,h[0],h[1],s,l,c.data.subarray(c.offset,c.offset+b))}}}else{var E;if(l===e.FLOAT){E=o.mallocFloat32(b)}else{E=o.mallocUint8(b)}var w=n(E,h,[h[2],h[2]*h[0],1]);if(g===e.FLOAT&&l===e.UNSIGNED_BYTE){f(w,c)}else{i.assign(w,c)}if(y){e.texImage2D(e.TEXTURE_2D,a,s,h[0],h[1],0,s,l,E.subarray(0,b))}else{e.texSubImage2D(e.TEXTURE_2D,a,t,r,h[0],h[1],s,l,E.subarray(0,b))}if(l===e.FLOAT){o.freeFloat32(E)}else{o.freeUint8(E)}}}function _(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);return t}function m(e,t,r,n,i){var o=e.getParameter(e.MAX_TEXTURE_SIZE);if(t<0||t>o||r<0||r>o){throw new Error("gl-texture2d: Invalid texture shape")}if(i===e.FLOAT&&!e.getExtension("OES_texture_float")){throw new Error("gl-texture2d: Floating point textures not supported on this platform")}var a=_(e);e.texImage2D(e.TEXTURE_2D,0,n,t,r,0,n,i,null);return new d(e,a,t,r,n,i)}function v(e,t,r,n){var i=_(e);e.texImage2D(e.TEXTURE_2D,0,r,r,n,t);return new d(e,i,t.width|0,t.height|0,r,n)}function b(e,t){var r=t.dtype;var a=t.shape.slice();var s=e.getParameter(e.MAX_TEXTURE_SIZE);if(a[0]<0||a[0]>s||a[1]<0||a[1]>s){throw new Error("gl-texture2d: Invalid texture size")}var l=p(a,t.stride.slice());var u=0;if(r==="float32"){u=e.FLOAT}else if(r==="float64"){u=e.FLOAT;l=false;r="float32"}else if(r==="uint8"){u=e.UNSIGNED_BYTE}else{u=e.UNSIGNED_BYTE;l=false;r="uint8"}var c=0;if(a.length===2){c=e.LUMINANCE;a=[a[0],a[1],1];t=n(t.data,a,[t.stride[0],t.stride[1],1],t.offset)}else if(a.length===3){if(a[2]===1){c=e.ALPHA}else if(a[2]===2){c=e.LUMINANCE_ALPHA}else if(a[2]===3){c=e.RGB}else if(a[2]===4){c=e.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}}else{throw new Error("gl-texture2d: Invalid shape for texture")}if(u===e.FLOAT&&!e.getExtension("OES_texture_float")){u=e.UNSIGNED_BYTE;l=false}var h,g;var m=t.size;if(!l){var v=[a[2],a[2]*a[0],1];g=o.malloc(m,r);var b=n(g,a,v,0);if((r==="float32"||r==="float64")&&u===e.UNSIGNED_BYTE){f(b,t)}else{i.assign(b,t)}h=g.subarray(0,m)}else if(t.offset===0&&t.data.length===m){h=t.data}else{h=t.data.subarray(t.offset,t.offset+m)}var y=_(e);e.texImage2D(e.TEXTURE_2D,0,c,a[0],a[1],0,c,u,h);if(!l){o.free(g)}return new d(e,y,a[0],a[1],c,u)}function y(e){if(arguments.length<=1){throw new Error("gl-texture2d: Missing arguments for texture2d constructor")}if(!a){u(e)}if(typeof arguments[1]==="number"){return m(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE)}if(Array.isArray(arguments[1])){return m(e,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE)}if(typeof arguments[1]==="object"){var t=arguments[1];if(t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement||t instanceof ImageData){return v(e,t,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE)}else if(t.shape&&t.data&&t.stride){return b(e,t)}}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:92,"ndarray-ops":87,"typedarray-pool":97}],99:[function(e,t,r){e("es6-object-assign").polyfill();var n=e("getusermedia");function i(e,t,r){var i=document.createElement("video");var a=Object.assign(o(e,t),r);i.width=e;i.height=t;n(a,function(e,t){if(e){throw new Error(e)}i.src=window.URL.createObjectURL(t)});return i}function o(e,t){return{video:{width:{min:e,ideal:e},height:{min:t,ideal:t}}}}t.exports=i},{"es6-object-assign":100,getusermedia:101}],100:[function(e,t,r){"use strict";function n(e,t){if(e===undefined||e===null){throw new TypeError("Cannot convert first argument to object")}var r=Object(e);for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i===undefined||i===null){continue}var o=Object.keys(Object(i));for(var a=0,s=o.length;a<s;a++){var l=o[a];var u=Object.getOwnPropertyDescriptor(i,l);if(u!==undefined&&u.enumerable){r[l]=i[l]}}}return r}function i(){if(!Object.assign){Object.defineProperty(Object,"assign",{enumerable:false,configurable:true,writable:true,value:n})}}t.exports={assign:n,polyfill:i}},{}],101:[function(e,t,r){var n=e("webrtc-adapter-test");t.exports=function(e,t){var r,n;var i=arguments.length===2;var o={video:true,audio:true};var a="PermissionDeniedError";var s="PERMISSION_DENIED";var l="ConstraintNotSatisfiedError";if(!i){t=e;e=o}if(!navigator.getUserMedia){n=new Error("MediaStreamError");n.name="NotSupportedError";return window.setTimeout(function(){t(n)},0)}if(!e.audio&&!e.video){n=new Error("MediaStreamError");n.name="NoMediaRequestedError";return window.setTimeout(function(){t(n)},0)}if(localStorage&&localStorage.useFirefoxFakeDevice==="true"){e.fake=true}navigator.getUserMedia(e,function(e){t(null,e)},function(e){var r;if(typeof e==="string"){r=new Error("MediaStreamError");if(e===a||e===s){r.name=a}else{r.name=l}}else{r=e;if(!r.name){if(r[a]){e.name=a}else{e.name=l}}}t(r)})}},{"webrtc-adapter-test":102}],102:[function(e,t,r){"use strict";var n=null;var i=null;var o=null;var a=null;var s=null;var l=null;var u={log:function(){if(typeof t!=="undefined"||typeof e==="function"&&typeof define==="function"){return}console.log.apply(console,arguments)},extractVersion:function(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}};function f(e){if(e[e.length-1]==="\n"){e=e.substring(0,e.length-1)}if(window.performance){var t=(window.performance.now()/1e3).toFixed(3);u.log(t+": "+e)}else{u.log(e)}}if(typeof window==="object"){if(window.HTMLMediaElement&&!("srcObject"in window.HTMLMediaElement.prototype)){Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return"mozSrcObject"in this?this.mozSrcObject:this._srcObject},set:function(e){if("mozSrcObject"in this){this.mozSrcObject=e}else{this._srcObject=e;this.src=URL.createObjectURL(e)}}})}n=window.navigator&&window.navigator.getUserMedia}i=function(e,t){e.srcObject=t};o=function(e,t){e.srcObject=t.srcObject};if(typeof window==="undefined"||!window.navigator){u.log("This does not appear to be a browser");a="not a browser"}else if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){u.log("This appears to be Firefox");a="firefox";s=u.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1);l=31;window.RTCPeerConnection=function(e,t){if(s<38){if(e&&e.iceServers){var r=[];for(var n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];if(i.hasOwnProperty("urls")){for(var o=0;o<i.urls.length;o++){var a={url:i.urls[o]};if(i.urls[o].indexOf("turn")===0){a.username=i.username;a.credential=i.credential}r.push(a)}}else{r.push(e.iceServers[n])}}e.iceServers=r}}return new mozRTCPeerConnection(e,t)};if(mozRTCPeerConnection.generateCertificate){Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){if(arguments.length){return mozRTCPeerConnection.generateCertificate.apply(null,arguments)}else{return mozRTCPeerConnection.generateCertificate}}})}if(!window.RTCSessionDescription){window.RTCSessionDescription=mozRTCSessionDescription}if(!window.RTCIceCandidate){window.RTCIceCandidate=mozRTCIceCandidate}n=function(e,t,r){var n=function(e){if(typeof e!=="object"||e.require){return e}var t=[];Object.keys(e).forEach(function(r){if(r==="require"||r==="advanced"||r==="mediaSource"){return}var n=e[r]=typeof e[r]==="object"?e[r]:{ideal:e[r]};if(n.min!==undefined||n.max!==undefined||n.exact!==undefined){t.push(r)}if(n.exact!==undefined){if(typeof n.exact==="number"){n.min=n.max=n.exact}else{e[r]=n.exact}delete n.exact}if(n.ideal!==undefined){e.advanced=e.advanced||[];var i={};if(typeof n.ideal==="number"){i[r]={min:n.ideal,max:n.ideal}}else{i[r]=n.ideal}e.advanced.push(i);delete n.ideal;if(!Object.keys(n).length){delete e[r]}}});if(t.length){e.require=t}return e};if(s<38){u.log("spec: "+JSON.stringify(e));if(e.audio){e.audio=n(e.audio)}if(e.video){e.video=n(e.video)}u.log("ff37: "+JSON.stringify(e))}return navigator.mozGetUserMedia(e,t,r)};navigator.getUserMedia=n;if(!navigator.mediaDevices){navigator.mediaDevices={getUserMedia:m,addEventListener:function(){},removeEventListener:function(){}}}navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})};if(s<41){var c=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return c().then(undefined,function(e){if(e.name==="NotFoundError"){return[]}throw e})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){u.log("This appears to be Chrome");a="chrome";s=u.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2);l=38;window.RTCPeerConnection=function(e,t){if(e&&e.iceTransportPolicy){e.iceTransports=e.iceTransportPolicy}var r=new webkitRTCPeerConnection(e,t);var n=r.getStats.bind(r);r.getStats=function(e,t,r){var i=this;var o=arguments;if(arguments.length>0&&typeof e==="function"){return n(e,t)}var a=function(e){var t={};var r=e.result();r.forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){r[t]=e.stat(t)});t[r.id]=r});return t};if(arguments.length>=2){var s=function(e){o[1](a(e))};return n.apply(this,[s,arguments[0]])}return new Promise(function(t,r){if(o.length===1&&e===null){n.apply(i,[function(e){t.apply(null,[a(e)])},r])}else{n.apply(i,[t,r])}})};return r};if(webkitRTCPeerConnection.generateCertificate){Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){if(arguments.length){return webkitRTCPeerConnection.generateCertificate.apply(null,arguments)}else{return webkitRTCPeerConnection.generateCertificate}}})}["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||arguments.length===1&&typeof arguments[0]==="object"){var r=arguments.length===1?arguments[0]:undefined;return new Promise(function(n,i){t.apply(e,[n,i,r])})}else{return t.apply(this,arguments)}}});["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments;var r=this;return new Promise(function(n,i){t.apply(r,[e[0],function(){n();if(e.length>=2){e[1].apply(null,[])}},function(t){i(t);if(e.length>=3){e[2].apply(null,[t])}}])})}});var d=function(e){if(typeof e!=="object"||e.mandatory||e.optional){return e}var t={};Object.keys(e).forEach(function(r){if(r==="require"||r==="advanced"||r==="mediaSource"){return}var n=typeof e[r]==="object"?e[r]:{ideal:e[r]};if(n.exact!==undefined&&typeof n.exact==="number"){n.min=n.max=n.exact}var i=function(e,t){if(e){return e+t.charAt(0).toUpperCase()+t.slice(1)}return t==="deviceId"?"sourceId":t};if(n.ideal!==undefined){t.optional=t.optional||[];var o={};if(typeof n.ideal==="number"){o[i("min",r)]=n.ideal;t.optional.push(o);o={};o[i("max",r)]=n.ideal;t.optional.push(o)}else{o[i("",r)]=n.ideal;t.optional.push(o)}}if(n.exact!==undefined&&typeof n.exact!=="number"){t.mandatory=t.mandatory||{};t.mandatory[i("",r)]=n.exact}else{["min","max"].forEach(function(e){if(n[e]!==undefined){t.mandatory=t.mandatory||{};t.mandatory[i(e,r)]=n[e]}})}});if(e.advanced){t.optional=(t.optional||[]).concat(e.advanced)}return t};n=function(e,t,r){if(e.audio){e.audio=d(e.audio)}if(e.video){e.video=d(e.video)}u.log("chrome: "+JSON.stringify(e));return navigator.webkitGetUserMedia(e,t,r)};navigator.getUserMedia=n;if(!navigator.mediaDevices){navigator.mediaDevices={getUserMedia:m,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(r){e(r.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}}if(!navigator.mediaDevices.getUserMedia){navigator.mediaDevices.getUserMedia=function(e){return m(e)}}else{var h=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){u.log("spec:   "+JSON.stringify(e));e.audio=d(e.audio);e.video=d(e.video);u.log("chrome: "+JSON.stringify(e));return h(e)}}if(typeof navigator.mediaDevices.addEventListener==="undefined"){navigator.mediaDevices.addEventListener=function(){u.log("Dummy mediaDevices.addEventListener called.")}}if(typeof navigator.mediaDevices.removeEventListener==="undefined"){navigator.mediaDevices.removeEventListener=function(){u.log("Dummy mediaDevices.removeEventListener called.")}}i=function(e,t){if(s>=43){e.srcObject=t}else if(typeof e.src!=="undefined"){e.src=URL.createObjectURL(t)}else{u.log("Error attaching stream to element.")}};o=function(e,t){if(s>=43){e.srcObject=t.srcObject}else{e.src=t.src}}}else if(navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)){u.log("This appears to be Edge");a="edge";s=u.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2);l=10547;if(RTCIceGatherer){var p=function(){return Math.random().toString(36).substr(2,10)};var g=p();var _={};_.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})};_.splitSections=function(e){var t=e.split("\r\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})};_.matchPrefix=function(e,t){return _.splitLines(e).filter(function(e){return e.indexOf(t)===0})};_.parseCandidate=function(e){var t;if(e.indexOf("a=candidate:")===0){t=e.substring(12).split(" ")}else{t=e.substring(10).split(" ")}var r={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]};for(var n=8;n<t.length;n+=2){switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;default:break}}return r};_.writeCandidate=function(e){var t=[];t.push(e.foundation);t.push(e.component);t.push(e.protocol.toUpperCase());t.push(e.priority);t.push(e.ip);t.push(e.port);var r=e.type;t.push("typ");t.push(r);if(r!=="host"&&e.relatedAddress&&e.relatedPort){t.push("raddr");t.push(e.relatedAddress);t.push("rport");t.push(e.relatedPort)}if(e.tcpType&&e.protocol.toLowerCase()==="tcp"){t.push("tcptype");t.push(e.tcpType)}return"candidate:"+t.join(" ")};_.parseRtpMap=function(e){var t=e.substr(9).split(" ");var r={payloadType:parseInt(t.shift(),10)};t=t[0].split("/");r.name=t[0];r.clockRate=parseInt(t[1],10);r.numChannels=t.length===3?parseInt(t[2],10):1;return r};_.writeRtpMap=function(e){var t=e.payloadType;if(e.preferredPayloadType!==undefined){t=e.preferredPayloadType}return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(e.numChannels!==1?"/"+e.numChannels:"")+"\r\n"};_.parseFmtp=function(e){var t={};var r;var n=e.substr(e.indexOf(" ")+1).split(";");for(var i=0;i<n.length;i++){r=n[i].trim().split("=");t[r[0].trim()]=r[1]}return t};_.writeFtmp=function(e){var t="";var r=e.payloadType;if(e.preferredPayloadType!==undefined){r=e.preferredPayloadType}if(e.parameters&&e.parameters.length){var n=[];Object.keys(e.parameters).forEach(function(t){n.push(t+"="+e.parameters[t])});t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t};_.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}};_.writeRtcpFb=function(e){var t="";var r=e.payloadType;if(e.preferredPayloadType!==undefined){r=e.preferredPayloadType}if(e.rtcpFeedback&&e.rtcpFeedback.length){e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+" "+e.parameter+"\r\n"})}return t};_.parseSsrcMedia=function(e){var t=e.indexOf(" ");var r={ssrc:e.substr(7,t-7)};var n=e.indexOf(":",t);if(n>-1){r.attribute=e.substr(t+1,n-t-1);r.value=e.substr(n+1)}else{r.attribute=e.substr(t+1)}return r};_.getDtlsParameters=function(e,t){var r=_.splitLines(e);r=r.concat(_.splitLines(t));var n=r.filter(function(e){return e.indexOf("a=fingerprint:")===0})[0].substr(14);var i={role:"auto",fingerprints:[{algorithm:n.split(" ")[0],value:n.split(" ")[1]}]};return i};_.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"});return r};_.getIceParameters=function(e,t){var r=_.splitLines(e);r=r.concat(_.splitLines(t));var n={usernameFragment:r.filter(function(e){return e.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:r.filter(function(e){return e.indexOf("a=ice-pwd:")===0})[0].substr(10)};return n};_.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\n"+"a=ice-pwd:"+e.password+"\r\n"};_.parseRtpParameters=function(e){var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]};var r=_.splitLines(e);var n=r[0].split(" ");for(var i=3;i<n.length;i++){var o=n[i];var a=_.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=_.parseRtpMap(a);var l=_.matchPrefix(e,"a=fmtp:"+o+" ");s.parameters=l.length?_.parseFmtp(l[0]):{};s.rtcpFeedback=_.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(_.parseRtcpFb);t.codecs.push(s)}}return t};_.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ";r+=t.codecs.length>0?"9":"0";r+=" UDP/TLS/RTP/SAVPF ";r+=t.codecs.map(function(e){if(e.preferredPayloadType!==undefined){return e.preferredPayloadType}return e.payloadType}).join(" ")+"\r\n";r+="c=IN IP4 0.0.0.0\r\n";r+="a=rtcp:9 IN IP4 0.0.0.0\r\n";t.codecs.forEach(function(e){r+=_.writeRtpMap(e);r+=_.writeFtmp(e);r+=_.writeRtcpFb(e)});r+="a=rtcp-mux\r\n";return r};_.writeSessionBoilerplate=function(){return"v=0\r\n"+"o=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\n"+"s=-\r\n"+"t=0 0\r\n"};_.writeMediaSection=function(e,t,r,n){var i=_.writeRtpDescription(e.kind,t);i+=_.writeIceParameters(e.iceGatherer.getLocalParameters());i+=_.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),r==="offer"?"actpass":"active");i+="a=mid:"+e.mid+"\r\n";if(e.rtpSender&&e.rtpReceiver){i+="a=sendrecv\r\n"}else if(e.rtpSender){i+="a=sendonly\r\n"}else if(e.rtpReceiver){i+="a=recvonly\r\n"}else{i+="a=inactive\r\n"}if(e.rtpSender){var o="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+o;i+="a=ssrc:"+e.sendSsrc+" "+o}i+="a=ssrc:"+e.sendSsrc+" cname:"+g+"\r\n";return i};_.getDirection=function(e,t){var r=_.splitLines(e);for(var n=0;n<r.length;n++){switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2)}}if(t){return _.getDirection(t)}return"sendrecv"};if(!window.RTCIceCandidate){window.RTCIceCandidate=function(e){return e}}if(!window.RTCSessionDescription){window.RTCSessionDescription=function(e){return e}}window.RTCPeerConnection=function(e){var t=this;this.onicecandidate=null;this.onaddstream=null;this.onremovestream=null;this.onsignalingstatechange=null;this.oniceconnectionstatechange=null;this.onnegotiationneeded=null;this.ondatachannel=null;this.localStreams=[];this.remoteStreams=[];this.getLocalStreams=function(){return t.localStreams};this.getRemoteStreams=function(){return t.remoteStreams};this.localDescription=new w({type:"",sdp:""});this.remoteDescription=new w({type:"",sdp:""});this.signalingState="stable";this.iceConnectionState="new";this.iceOptions={gatherPolicy:"all",iceServers:[]};if(e&&e.iceTransportPolicy){switch(e.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=e.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}}if(e&&e.iceServers){e.iceServers.forEach(function(e){if(e.urls){var r;if(typeof e.urls==="string"){r=e.urls}else{r=e.urls[0]}if(r.indexOf("transport=udp")!==-1){t.iceServers.push({username:e.username,credential:e.credential,urls:r})}}})}this.transceivers=[];this._localIceCandidatesBuffer=[]};window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var e=this;this._localIceCandidatesBuffer.forEach(function(t){if(e.onicecandidate!==null){e.onicecandidate(t)}});this._localIceCandidatesBuffer=[]};window.RTCPeerConnection.prototype.addStream=function(e){this.localStreams.push(e.clone());this._maybeFireNegotiationNeeded()};window.RTCPeerConnection.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);if(t>-1){this.localStreams.splice(t,1);this._maybeFireNegotiationNeeded()}};window.RTCPeerConnection.prototype._getCommonCapabilities=function(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]};e.codecs.forEach(function(e){for(var n=0;n<t.codecs.length;n++){var i=t.codecs[n];if(e.name.toLowerCase()===i.name.toLowerCase()&&e.clockRate===i.clockRate&&e.numChannels===i.numChannels){r.codecs.push(i);break}}});e.headerExtensions.forEach(function(e){for(var n=0;n<t.headerExtensions.length;n++){var i=t.headerExtensions[n];if(e.uri===i.uri){r.headerExtensions.push(i);break}}});return r};window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(e,t){var r=this;var n=new RTCIceGatherer(r.iceOptions);var i=new RTCIceTransport(n);n.onlocalcandidate=function(o){var a={};a.candidate={sdpMid:e,sdpMLineIndex:t};var s=o.candidate;if(!s||Object.keys(s).length===0){if(n.state===undefined){n.state="completed"}a.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates"}else{s.component=i.component==="RTCP"?2:1;a.candidate.candidate=_.writeCandidate(s)}var l=r.transceivers.every(function(e){return e.iceGatherer&&e.iceGatherer.state==="completed"});if(r.onicecandidate!==null){if(r.localDescription&&r.localDescription.type===""){r._localIceCandidatesBuffer.push(a);if(l){r._localIceCandidatesBuffer.push({})}}else{r.onicecandidate(a);if(l){r.onicecandidate({})}}}};i.onicestatechange=function(){r._updateConnectionState()};var o=new RTCDtlsTransport(i);o.ondtlsstatechange=function(){r._updateConnectionState()};o.onerror=function(){o.state="failed";r._updateConnectionState()};return{iceGatherer:n,iceTransport:i,dtlsTransport:o}};window.RTCPeerConnection.prototype._transceive=function(e,t,r){var n=this._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);if(t&&e.rtpSender){n.encodings=[{ssrc:e.sendSsrc}];n.rtcp={cname:g,ssrc:e.recvSsrc};e.rtpSender.send(n)}if(r&&e.rtpReceiver){n.encodings=[{ssrc:e.recvSsrc}];n.rtcp={cname:e.cname,ssrc:e.sendSsrc};e.rtpReceiver.receive(n)}};window.RTCPeerConnection.prototype.setLocalDescription=function(e){var t=this;if(e.type==="offer"){if(!this._pendingOffer){}else{this.transceivers=this._pendingOffer;delete this._pendingOffer}}else if(e.type==="answer"){var r=_.splitSections(t.remoteDescription.sdp);var n=r.shift();r.forEach(function(e,r){var i=t.transceivers[r];var o=i.iceGatherer;var a=i.iceTransport;var s=i.dtlsTransport;var l=i.localCapabilities;var u=i.remoteCapabilities;var f=e.split("\n",1)[0].split(" ",2)[1]==="0";if(!f){var c=_.getIceParameters(e,n);a.start(o,c,"controlled");var d=_.getDtlsParameters(e,n);s.start(d);var h=t._getCommonCapabilities(l,u);t._transceive(i,h.codecs.length>0,false)}})}this.localDescription=e;switch(e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var i=arguments.length>1&&typeof arguments[1]==="function";if(i){var o=arguments[1];window.setTimeout(function(){o();t._emitBufferedCandidates()},0)}var a=Promise.resolve();a.then(function(){if(!i){window.setTimeout(t._emitBufferedCandidates.bind(t),0)}});return a};window.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t=this;var r=new MediaStream;var n=_.splitSections(e.sdp);var i=n.shift();n.forEach(function(n,o){var a=_.splitLines(n);var s=a[0].substr(2).split(" ");var l=s[0];var u=s[1]==="0";var f=_.getDirection(n,i);var c;var d;var h;var p;var g;var m;var v;var b;var y;var E=_.parseRtpParameters(n);var w;var T;if(!u){w=_.getIceParameters(n,i);T=_.getDtlsParameters(n,i)}var A=_.matchPrefix(n,"a=mid:")[0].substr(6);var x;var R=_.matchPrefix(n,"a=ssrc:").map(function(e){return _.parseSsrcMedia(e)}).filter(function(e){return e.attribute==="cname"})[0];if(R){b=parseInt(R.ssrc,10);x=R.value}if(e.type==="offer"){var C=t._createIceAndDtlsTransports(A,o);y=RTCRtpReceiver.getCapabilities(l);v=(2*o+2)*1001;m=new RTCRtpReceiver(C.dtlsTransport,l);r.addTrack(m.track);if(t.localStreams.length>0&&t.localStreams[0].getTracks().length>=o){var S=t.localStreams[0].getTracks()[o];g=new RTCRtpSender(S,C.dtlsTransport)}t.transceivers[o]={iceGatherer:C.iceGatherer,iceTransport:C.iceTransport,dtlsTransport:C.dtlsTransport,localCapabilities:y,remoteCapabilities:E,rtpSender:g,rtpReceiver:m,kind:l,mid:A,cname:x,sendSsrc:v,recvSsrc:b};t._transceive(t.transceivers[o],false,f==="sendrecv"||f==="sendonly")}else if(e.type==="answer"&&!u){c=t.transceivers[o];d=c.iceGatherer;h=c.iceTransport;p=c.dtlsTransport;g=c.rtpSender;m=c.rtpReceiver;v=c.sendSsrc;y=c.localCapabilities;t.transceivers[o].recvSsrc=b;t.transceivers[o].remoteCapabilities=E;t.transceivers[o].cname=x;h.start(d,w,"controlling");p.start(T);t._transceive(c,f==="sendrecv"||f==="recvonly",f==="sendrecv"||f==="sendonly");if(m&&(f==="sendrecv"||f==="sendonly")){r.addTrack(m.track)}else{delete c.rtpReceiver}}});this.remoteDescription=e;switch(e.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}window.setTimeout(function(){if(t.onaddstream!==null&&r.getTracks().length){t.remoteStreams.push(r);window.setTimeout(function(){t.onaddstream({stream:r})},0)}},0);if(arguments.length>1&&typeof arguments[1]==="function"){window.setTimeout(arguments[1],0)}return Promise.resolve()};window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(e){if(e.iceTransport){e.iceTransport.stop()}if(e.dtlsTransport){e.dtlsTransport.stop()}if(e.rtpSender){e.rtpSender.stop()}if(e.rtpReceiver){e.rtpReceiver.stop()}});this._updateSignalingState("closed")};window.RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e;if(this.onsignalingstatechange!==null){this.onsignalingstatechange()}};window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){if(this.onnegotiationneeded!==null){this.onnegotiationneeded()}};window.RTCPeerConnection.prototype._updateConnectionState=function(){var e=this;var t;var r={"new":0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};this.transceivers.forEach(function(e){r[e.iceTransport.state]++;r[e.dtlsTransport.state]++});r.connected+=r.completed;t="new";if(r.failed>0){t="failed"}else if(r.connecting>0||r.checking>0){t="connecting"}else if(r.disconnected>0){t="disconnected"}else if(r.new>0){t="new"}else if(r.connecting>0||r.completed>0){t="connected"}if(t!==e.iceConnectionState){e.iceConnectionState=t;if(this.oniceconnectionstatechange!==null){this.oniceconnectionstatechange()}}};window.RTCPeerConnection.prototype.createOffer=function(){var e=this;if(this._pendingOffer){throw new Error("createOffer called while there is a pending offer.")}var t;if(arguments.length===1&&typeof arguments[0]!=="function"){t=arguments[0]}else if(arguments.length===3){t=arguments[2]}var r=[];var n=0;var i=0;if(this.localStreams.length){n=this.localStreams[0].getAudioTracks().length;i=this.localStreams[0].getVideoTracks().length}if(t){if(t.mandatory||t.optional){throw new TypeError("Legacy mandatory/optional constraints not supported.")}if(t.offerToReceiveAudio!==undefined){n=t.offerToReceiveAudio}if(t.offerToReceiveVideo!==undefined){i=t.offerToReceiveVideo}}if(this.localStreams.length){this.localStreams[0].getTracks().forEach(function(e){r.push({kind:e.kind,track:e,wantReceive:e.kind==="audio"?n>0:i>0});if(e.kind==="audio"){n--}else if(e.kind==="video"){i--}})}while(n>0||i>0){if(n>0){r.push({kind:"audio",wantReceive:true});n--}if(i>0){r.push({kind:"video",wantReceive:true});i--}}var o=_.writeSessionBoilerplate();var a=[];r.forEach(function(t,r){var n=t.track;var i=t.kind;var s=p();var l=e._createIceAndDtlsTransports(s,r);var u=RTCRtpSender.getCapabilities(i);var f;var c;var d=(2*r+1)*1001;if(n){f=new RTCRtpSender(n,l.dtlsTransport)}if(t.wantReceive){c=new RTCRtpReceiver(l.dtlsTransport,i)}a[r]={iceGatherer:l.iceGatherer,iceTransport:l.iceTransport,dtlsTransport:l.dtlsTransport,localCapabilities:u,remoteCapabilities:null,rtpSender:f,rtpReceiver:c,kind:i,mid:s,sendSsrc:d,recvSsrc:null};var h=a[r];o+=_.writeMediaSection(h,h.localCapabilities,"offer",e.localStreams[0])});this._pendingOffer=a;var s=new w({type:"offer",sdp:o});if(arguments.length&&typeof arguments[0]==="function"){window.setTimeout(arguments[0],0,s)}return Promise.resolve(s)};window.RTCPeerConnection.prototype.createAnswer=function(){var e=this;var t;if(arguments.length===1&&typeof arguments[0]!=="function"){t=arguments[0]}else if(arguments.length===3){t=arguments[2]}var r=_.writeSessionBoilerplate();this.transceivers.forEach(function(t){var n=e._getCommonCapabilities(t.localCapabilities,t.remoteCapabilities);r+=_.writeMediaSection(t,n,"answer",e.localStreams[0])});var n=new w({type:"answer",sdp:r});if(arguments.length&&typeof arguments[0]==="function"){window.setTimeout(arguments[0],0,n)}return Promise.resolve(n)};window.RTCPeerConnection.prototype.addIceCandidate=function(e){var t=e.sdpMLineIndex;if(e.sdpMid){for(var r=0;r<this.transceivers.length;r++){if(this.transceivers[r].mid===e.sdpMid){t=r;break}}}var n=this.transceivers[t];if(n){var i=Object.keys(e.candidate).length>0?_.parseCandidate(e.candidate):{};if(i.protocol==="tcp"&&i.port===0){return}if(i.component!=="1"){return}if(i.type==="endOfCandidates"){i={}}n.iceTransport.addRemoteCandidate(i)}if(arguments.length>1&&typeof arguments[1]==="function"){window.setTimeout(arguments[1],0)}return Promise.resolve()};window.RTCPeerConnection.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(r){if(t[r]){e.push(t[r].getStats())}})});var t=arguments.length>1&&typeof arguments[1]==="function"&&arguments[1];return new Promise(function(r){var n={};Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){n[t]=e[t]})});if(t){window.setTimeout(t,0,n)}r(n)})})}}}else{u.log("Browser does not appear to be WebRTC-capable")}function m(e){return new Promise(function(t,r){n(e,t,r)})}var v={};try{Object.defineProperty(v,"version",{set:function(e){s=e}})}catch(b){}if(typeof t!=="undefined"){var y;var E;var w;if(typeof window!=="undefined"){y=window.RTCPeerConnection;E=window.RTCIceCandidate;w=window.RTCSessionDescription}t.exports={RTCPeerConnection:y,RTCIceCandidate:E,RTCSessionDescription:w,getUserMedia:n,attachMediaStream:i,reattachMediaStream:o,webrtcDetectedBrowser:a,webrtcDetectedVersion:s,webrtcMinimumVersion:l,webrtcTesting:v,webrtcUtils:u}}else if(typeof e==="function"&&typeof define==="function"){define([],function(){return{RTCPeerConnection:window.RTCPeerConnection,RTCIceCandidate:window.RTCIceCandidate,RTCSessionDescription:window.RTCSessionDescription,getUserMedia:n,attachMediaStream:i,reattachMediaStream:o,webrtcDetectedBrowser:a,webrtcDetectedVersion:s,webrtcMinimumVersion:l,webrtcTesting:v,webrtcUtils:u}})}},{}]},{},[1]);
